'use strict';var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined;}else{return get(parent,property,receiver);}}else if("value"in desc){return desc.value;}else{var getter=desc.get;if(getter===undefined){return undefined;}return getter.call(receiver);}};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}else{return Array.from(arr);}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var __awaiter=undefined&&undefined.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value));}catch(e){reject(e);}}function rejected(value){try{step(generator["throw"](value));}catch(e){reject(e);}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value);}).then(fulfilled,rejected);}step((generator=generator.apply(thisArg,_arguments||[])).next());});};var BlackCat;(function(BlackCat){var BC_scriptSrc=document.getElementsByTagName('script')[document.getElementsByTagName('script').length-1].src;var BC_scriptName=BC_scriptSrc.split('/')[BC_scriptSrc.split('/').length-1];var BC_path=BC_scriptSrc.replace(BC_scriptName,'');var Main=function(){function Main(){_classCallCheck(this,Main);Main.netMgr=new BlackCat.NetMgr();Main.user=new BlackCat.User();Main.wallet=new BlackCat.tools.wallet();Main.viewMgr=new BlackCat.ViewMgr();Main.langMgr=new BlackCat.LangMgr();Main.randNumber=parseInt((Math.random()*10000000).toString());Main.urlHead=Main.getUrlHead();Main.reset(0);Main.update_timeout_max=5000;Main.update_timeout_min=300;Main.isCreated=false;Neo.Cryptography.RandomNumberGenerator.startCollectors();}_createClass(Main,[{key:'init',value:function init(appid,appkey,callback,lang){Main.appid=appid;Main.appkey=appkey;Main.callback=callback;Main.langMgr.setType(lang);}},{key:'start',value:function start(){var callback=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee(){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:Main.loginFunctionCallback=callback;Main.viewMgr.mainView.createMask();if(!(Main.isCreated==false)){_context.next=5;break;}Main.netMgr.selectApi(function(){Main.netMgr.change(function(){Main.viewMgr.iconView.showSucc();Main.viewMgr.iconView.removeState();Main.viewMgr.mainView.changNetType();Main.update();Main.isCreated=true;Main.validateLogin();});});return _context.abrupt('return');case 5:Main.validateLogin();case 6:case'end':return _context.stop();}}},_callee,this);}));}},{key:'setLang',value:function setLang(type){if(Main.langMgr.setType(type)===true){Main.viewMgr.update();}}},{key:'setDefaultNetType',value:function setDefaultNetType(type){Main.netMgr.setDefault(type);}},{key:'showMain',value:function showMain(){if(Main.viewMgr.mainView.div.innerHTML==""){return;}if(Main.viewMgr.iconView){Main.viewMgr.iconView.hidden();}Main.viewMgr.mainView.show();}},{key:'showIcon',value:function showIcon(){if(Main.viewMgr.mainView.div.innerHTML==""){return;}Main.viewMgr.mainView.hidden();Main.viewMgr.change("IconView");}},{key:'getBalance',value:function getBalance(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee2(){var sgas,gas,balances,callback_data;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:sgas=0;gas=0;_context2.next=4;return BlackCat.tools.WWW.api_getBalance(Main.user.info.wallet);case 4:balances=_context2.sent;if(!balances){_context2.next=9;break;}balances.map(function(item){return item.names=BlackCat.tools.CoinTool.assetID2name[item.asset];});_context2.next=9;return balances.forEach(function(balance){if(balance.asset==BlackCat.tools.CoinTool.id_GAS){gas=balance.balance;}});case 9:_context2.next=11;return Main.getSgasBalanceByAddress(BlackCat.tools.CoinTool.id_SGAS,Main.user.info.wallet);case 11:sgas=_context2.sent;callback_data={sgas:sgas,gas:gas};Main.listenerCallback("getBalanceRes",callback_data);return _context2.abrupt('return',callback_data);case 15:case'end':return _context2.stop();}}},_callee2,this);}));}},{key:'getUserInfo',value:function getUserInfo(){Main.listenerCallback("getUserInfoRes",Main.user.info);return Main.user.info;}},{key:'getNetType',value:function getNetType(){var type=Main.netMgr.type;Main.listenerCallback("getNetTypeRes",type);return type;}},{key:'invokescript',value:function invokescript(params){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee3(){var res,callback_data;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return Main.wallet.invokescript(params);case 2:res=_context3.sent;callback_data={params:params,res:res};Main.listenerCallback("invokescriptRes",callback_data);return _context3.abrupt('return',res);case 6:case'end':return _context3.stop();}}},_callee3,this);}));}},{key:'makeRawTransaction',value:function makeRawTransaction(params,callback){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee6(){var _this=this;var unTrust,list;return regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(!Main.isWalletOpen()){_context6.next=27;break;}unTrust=Main.getUnTrustNnc(params);if(!(unTrust.length==0)){_context6.next=6;break;}console.log("[BlaCat]",'[main]','makeRawTransaction, trust nnc ...');this._makeRawTransaction(params,"0",callback);return _context6.abrupt('return');case 6:if(Main.viewMgr.mainView.isHidden()){Main.viewMgr.mainView.show();Main.viewMgr.iconView.hidden();}if(!Main.transCallback){_context6.next=10;break;}Main.showErrMsg("main_wait_for_last_tran");return _context6.abrupt('return');case 10:Main.transCallback=callback;list=new BlackCat.walletLists();list.params=JSON.stringify(params);list.wallet=Main.user.info.wallet;list.icon=Main.appicon;list.name=Main.appname;list.ctm=Math.round(new Date().getTime()/1000).toString();list.cnts="0";list.type="5";BlackCat.ViewTransConfirm.list=list;BlackCat.ViewTransConfirm.refer="";BlackCat.ViewTransConfirm.callback_params=params;BlackCat.ViewTransConfirm.callback=function(params,trust){return __awaiter(_this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee5(){var _this2=this;var net_fee;return regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:console.log("[BlaCat]",'[main]','makeRawTransaction交易确认..');Main.viewMgr.change("ViewLoading");net_fee="0";setTimeout(function(){return __awaiter(_this2,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee4(){return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return this._makeRawTransaction(params,trust,net_fee,Main.transCallback);case 3:_context4.next=8;break;case 5:_context4.prev=5;_context4.t0=_context4['catch'](0);console.log("[BlaCat]",'[main]','makeRawTransaction, _makeRawTransaction(params, trust) error, params => ',params,'trust =>',trust,'error => ',_context4.t0.toString());case 8:Main.viewMgr.viewLoading.remove();case 9:case'end':return _context4.stop();}}},_callee4,this,[[0,5]]);}));},300);case 4:case'end':return _context5.stop();}}},_callee5,this);}));};BlackCat.ViewTransConfirm.callback_cancel=function(){console.log("[BlaCat]",'[main]','makeRawTransaction交易取消..');var res=new BlackCat.Result();res.err=true;res.info='cancel';if(Main.transCallback)Main.transCallback(res);Main.transCallback=null;var callback_data={params:params,res:res};Main.listenerCallback("makeRawTransactionRes",callback_data);Main.transCallback=null;};Main.viewMgr.change("ViewTransConfirm");_context6.next=34;break;case 27:if(Main.viewMgr.mainView.isHidden()){Main.viewMgr.mainView.show();Main.viewMgr.iconView.hidden();}BlackCat.ViewWalletOpen.refer="";BlackCat.ViewWalletOpen.callback_params=params;BlackCat.ViewWalletOpen.callback_callback=callback;BlackCat.ViewWalletOpen.callback=function(params,callback){_this.makeRawTransaction(params,callback);};BlackCat.ViewWalletOpen.callback_cancel=function(params,callback){var res=new BlackCat.Result();res.err=true;res.info='cancel';var callback_data={params:params,res:res};Main.listenerCallback("makeRawTransactionRes",callback_data);callback(res);};Main.viewMgr.change("ViewWalletOpen");case 34:case'end':return _context6.stop();}}},_callee6,this);}));}},{key:'_makeRawTransaction',value:function _makeRawTransaction(params){var trust=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"0";var net_fee=arguments[2];var callback=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee7(){var res,callback_data;return regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:Main.setLiveTime();_context7.prev=1;_context7.next=4;return Main.wallet.makeRawTransaction(params,trust,net_fee);case 4:res=_context7.sent;_context7.next=13;break;case 7:_context7.prev=7;_context7.t0=_context7['catch'](1);res=new BlackCat.Result();res.err=true;res.info=_context7.t0.toString();console.log("[BlaCat]",'[main]','_makeRawTransaction, Main.wallet.makeRawTransaction(params, trust) error, params => ',params,'trust =>',trust,'e => ',_context7.t0.toString());case 13:if(callback)callback(res);Main.transCallback=null;callback_data={params:params,res:res};Main.listenerCallback("makeRawTransactionRes",callback_data);_context7.next=19;return Main.viewMgr.payView.doGetWalletLists(1);case 19:case'end':return _context7.stop();}}},_callee7,this,[[1,7]]);}));}},{key:'makeRecharge',value:function makeRecharge(params,callback){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee10(){var _this3=this;var res,callback_data,list;return regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:if(Main.viewMgr.mainView.isHidden()){Main.viewMgr.mainView.show();Main.viewMgr.iconView.hidden();}if(Main.app_recharge_addr){_context10.next=10;break;}Main.showErrMsg("main_no_app_wallet");res=new BlackCat.Result();res.err=true;res.info="app_wallet_not_config";callback(res);callback_data={params:params,res:res};Main.listenerCallback("makeRechargeRes",callback_data);return _context10.abrupt('return');case 10:if(!(Main.viewMgr.payView&&Main.viewMgr.payView.sgas<Number(params.count))){_context10.next=19;break;}Main.showErrMsg('pay_not_enough_money');res=new BlackCat.Result();res.err=true;res.info="not_enough_sgas";callback(res);callback_data={params:params,res:res};Main.listenerCallback("makeRechargeRes",callback_data);return _context10.abrupt('return');case 19:if(!Main.isWalletOpen()){_context10.next=49;break;}if(!Main.transCallback){_context10.next=29;break;}Main.showErrMsg("main_wait_for_last_tran");res=new BlackCat.Result();res.err=true;res.info="wait_for_last_tran";callback(res);callback_data={params:params,res:res};Main.listenerCallback("makeRechargeRes",callback_data);return _context10.abrupt('return');case 29:Main.transCallback=callback;list=new BlackCat.walletLists();if(!params.hasOwnProperty("nnc"))params['nnc']=BlackCat.tools.CoinTool.id_SGAS;if(!params.hasOwnProperty("sbParamJson"))params['sbParamJson']=["(address)"+Main.user.info.wallet,"(address)"+Main.app_recharge_addr,"(integer)"+params.count*100000000];if(!params.hasOwnProperty("sbPushString"))params['sbPushString']="transfer";list.params=JSON.stringify(params);list.wallet=Main.user.info.wallet;list.icon=Main.appicon;list.name=Main.appname;list.ctm=Math.round(new Date().getTime()/1000).toString();list.cnts=params.count.toString();list.type="3";BlackCat.ViewTransConfirm.list=list;BlackCat.ViewTransConfirm.refer="";BlackCat.ViewTransConfirm.callback_params=params;BlackCat.ViewTransConfirm.callback=function(params){return __awaiter(_this3,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee9(){var _this4=this;return regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:console.log("[BlaCat]",'[main]','makeRecharge交易确认..');Main.viewMgr.change("ViewLoading");setTimeout(function(){return __awaiter(_this4,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee8(){var res,callback_data;return regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.prev=0;_context8.next=3;return Main.wallet.makeRecharge(params);case 3:res=_context8.sent;_context8.next=12;break;case 6:_context8.prev=6;_context8.t0=_context8['catch'](0);res=new BlackCat.Result();res.err=true;res.info=_context8.t0.toString();console.log("[BlaCat]",'[main]','makeRecharge, Main.wallet.makeRecharge(params) error, params => ',params,'e => ',_context8.t0.toString());case 12:if(Main.transCallback)Main.transCallback(res);Main.transCallback=null;callback_data={params:params,res:res};Main.listenerCallback("makeRechargeRes",callback_data);_context8.next=18;return Main.viewMgr.payView.doGetWalletLists(1);case 18:Main.viewMgr.viewLoading.remove();case 19:case'end':return _context8.stop();}}},_callee8,this,[[0,6]]);}));},300);case 3:case'end':return _context9.stop();}}},_callee9,this);}));};BlackCat.ViewTransConfirm.callback_cancel=function(){console.log("[BlaCat]",'[main]','makeRecharge交易取消..');var res=new BlackCat.Result();res.err=true;res.info='cancel';if(Main.transCallback)Main.transCallback(res);Main.transCallback=null;var callback_data={params:params,res:res};Main.listenerCallback("makeRechargeRes",callback_data);Main.transCallback=null;};Main.viewMgr.change("ViewTransConfirm");_context10.next=55;break;case 49:BlackCat.ViewWalletOpen.refer="";BlackCat.ViewWalletOpen.callback_params=params;BlackCat.ViewWalletOpen.callback_callback=callback;BlackCat.ViewWalletOpen.callback=function(params,callback){_this3.makeRecharge(params,callback);};BlackCat.ViewWalletOpen.callback_cancel=function(params,callback){var res=new BlackCat.Result();res.err=true;res.info='cancel';var callback_data={params:params,res:res};Main.listenerCallback("makeRechargeRes",callback_data);callback(res);};Main.viewMgr.change("ViewWalletOpen");case 55:case'end':return _context10.stop();}}},_callee10,this);}));}},{key:'makeGasTransfer',value:function makeGasTransfer(params){var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee13(){var _this5=this;var res,callback_data,list;return regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:if(Main.viewMgr.mainView.isHidden()){Main.viewMgr.mainView.show();Main.viewMgr.iconView.hidden();}if(!(Main.viewMgr.payView&&Main.viewMgr.payView.gas<Number(params.count))){_context13.next=10;break;}Main.showErrMsg('pay_not_enough_money');res=new BlackCat.Result();res.err=true;res.info="not_enough_gas";callback(res);callback_data={params:params,res:res};Main.listenerCallback("makeGasTransferRes",callback_data);return _context13.abrupt('return');case 10:if(!Main.isWalletOpen()){_context13.next=37;break;}if(!Main.transGasCallback){_context13.next=20;break;}Main.showErrMsg("main_wait_for_last_tran");res=new BlackCat.Result();res.err=true;res.info="wait_for_last_tran";callback(res);callback_data={params:params,res:res};Main.listenerCallback("makeGasTransferRes",callback_data);return _context13.abrupt('return');case 20:Main.transGasCallback=callback;list=new BlackCat.walletLists();list.params=JSON.stringify(params);list.wallet=Main.user.info.wallet;list.icon=Main.appicon;list.name=Main.appname;list.ctm=Math.round(new Date().getTime()/1000).toString();list.cnts=params.count.toString();list.type="6";BlackCat.ViewTransConfirmGas.list=list;BlackCat.ViewTransConfirmGas.refer="";BlackCat.ViewTransConfirmGas.callback_params=params;BlackCat.ViewTransConfirmGas.callback=function(params){return __awaiter(_this5,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee12(){var _this6=this;var net_fee;return regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:console.log("[BlaCat]",'[main]','makeGasTransfer交易确认..');Main.viewMgr.change("ViewLoading");net_fee="0";setTimeout(function(){return __awaiter(_this6,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee11(){var res,logRes,callback_data;return regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.prev=0;_context11.next=3;return BlackCat.tools.CoinTool.rawTransaction(params.toaddr,BlackCat.tools.CoinTool.id_GAS,params.count,Neo.Fixed8.fromNumber(Number(net_fee)));case 3:res=_context11.sent;if(!(res.err==false)){_context11.next=12;break;}params.sbPushString="transfer";_context11.next=8;return BlackCat.ApiTool.addUserWalletLogs(Main.user.info.uid,Main.user.info.token,res.info,Main.appid,params.count.toString(),"6",JSON.stringify(params),Main.netMgr.type,"0",net_fee);case 8:logRes=_context11.sent;Main.appWalletLogId=logRes.data;_context11.next=12;return Main.viewMgr.payView.doGetWalletLists(1);case 12:_context11.next=21;break;case 14:_context11.prev=14;_context11.t0=_context11['catch'](0);res=new BlackCat.Result();res.err=true;res.info='make trans err';res['ext']=_context11.t0.toString();console.log("[BlaCat]",'[main]','makeGasTransfer, ViewTransConfirmGas.callback error, params => ',params,'e => ',_context11.t0.toString());case 21:if(Main.transGasCallback)Main.transGasCallback(res);Main.transGasCallback=null;callback_data={params:params,res:res};Main.listenerCallback("makeGasTransferRes",callback_data);Main.viewMgr.viewLoading.remove();case 26:case'end':return _context11.stop();}}},_callee11,this,[[0,14]]);}));},300);case 4:case'end':return _context12.stop();}}},_callee12,this);}));};BlackCat.ViewTransConfirmGas.callback_cancel=function(){console.log("[BlaCat]",'[main]','makeGasTransfer交易取消..');var res=new BlackCat.Result();res.err=true;res.info='cancel';if(Main.transGasCallback){Main.transGasCallback(res);Main.transGasCallback=null;}var callback_data={params:params,res:res};Main.listenerCallback("makeGasTransferRes",callback_data);};Main.viewMgr.change("ViewTransConfirmGas");_context13.next=43;break;case 37:BlackCat.ViewWalletOpen.refer="";BlackCat.ViewWalletOpen.callback_params=params;BlackCat.ViewWalletOpen.callback_callback=callback;BlackCat.ViewWalletOpen.callback=function(params,callback){_this5.makeGasTransfer(params,callback);};BlackCat.ViewWalletOpen.callback_cancel=function(params,callback){var res=new BlackCat.Result();res.err=true;res.info='cancel';var callback_data={params:params,res:res};Main.listenerCallback("makeGasTransferRes",callback_data);callback(res);};Main.viewMgr.change("ViewWalletOpen");case 43:case'end':return _context13.stop();}}},_callee13,this);}));}},{key:'makeGasTransferMulti',value:function makeGasTransferMulti(params){var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee16(){var _this7=this;var _count,i,res,callback_data,list;return regeneratorRuntime.wrap(function _callee16$(_context16){while(1){switch(_context16.prev=_context16.next){case 0:if(Main.viewMgr.mainView.isHidden()){Main.viewMgr.mainView.show();Main.viewMgr.iconView.hidden();}_count=0;for(i=0;i<params.length;i++){_count+=Number(params[i].count);}if(!(Main.viewMgr.payView&&Main.viewMgr.payView.gas<Number(_count))){_context16.next=12;break;}Main.showErrMsg('pay_not_enough_money');res=new BlackCat.Result();res.err=true;res.info="not_enough_gas";callback(res);callback_data={params:params,res:res};Main.listenerCallback("makeGasTransferMultiRes",callback_data);return _context16.abrupt('return');case 12:if(!Main.isWalletOpen()){_context16.next=33;break;}if(!Main.transGasMultiCallback){_context16.next=16;break;}Main.showErrMsg("main_wait_for_last_tran");return _context16.abrupt('return');case 16:Main.transGasMultiCallback=callback;list=new BlackCat.walletLists();list.params=JSON.stringify(params);list.wallet=Main.user.info.wallet;list.icon=Main.appicon;list.name=Main.appname;list.ctm=Math.round(new Date().getTime()/1000).toString();list.cnts=_count.toString();list.type="6";BlackCat.ViewTransConfirmGas.list=list;BlackCat.ViewTransConfirmGas.refer="";BlackCat.ViewTransConfirmGas.callback_params=params;BlackCat.ViewTransConfirmGas.callback=function(params){return __awaiter(_this7,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee15(){var _this8=this;var net_fee;return regeneratorRuntime.wrap(function _callee15$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:console.log("[BlaCat]",'[main]','makeGasTransferMulti交易确认..');Main.viewMgr.change("ViewLoading");net_fee="0";setTimeout(function(){return __awaiter(_this8,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee14(){var res,callback_data;return regeneratorRuntime.wrap(function _callee14$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.prev=0;_context14.next=3;return BlackCat.tools.CoinTool.rawTransactionMulti(params,BlackCat.tools.CoinTool.id_GAS,Neo.Fixed8.fromNumber(Number(net_fee)));case 3:res=_context14.sent;if(!(res.err==false)){_context14.next=10;break;}params.map(function(item){return item.sbPushString="transfer";});_context14.next=8;return BlackCat.ApiTool.addUserWalletLogs(Main.user.info.uid,Main.user.info.token,res.info,Main.appid,_count.toString(),"6",JSON.stringify(params),Main.netMgr.type,"0",net_fee);case 8:_context14.next=10;return Main.viewMgr.payView.doGetWalletLists(1);case 10:_context14.next=19;break;case 12:_context14.prev=12;_context14.t0=_context14['catch'](0);res=new BlackCat.Result();res.err=true;res.info='make trans err';res['ext']=_context14.t0.toString();console.log("[BlaCat]",'[main]','makeGasTransferMulti, ViewTransConfirmGas.callback error, params => ',params,'e => ',_context14.t0.toString());case 19:if(Main.transGasMultiCallback)Main.transGasMultiCallback(res);Main.transGasMultiCallback=null;callback_data={params:params,res:res};Main.listenerCallback("makeGasTransferMultiRes",callback_data);Main.viewMgr.viewLoading.remove();case 24:case'end':return _context14.stop();}}},_callee14,this,[[0,12]]);}));},300);case 4:case'end':return _context15.stop();}}},_callee15,this);}));};BlackCat.ViewTransConfirmGas.callback_cancel=function(){console.log("[BlaCat]",'[main]','makeGasTransfer交易取消..');var res=new BlackCat.Result();res.err=true;res.info='cancel';if(Main.transGasMultiCallback){Main.transGasMultiCallback(res);Main.transGasMultiCallback=null;}var callback_data={params:params,res:res};Main.listenerCallback("makeRechargeRes",callback_data);};Main.viewMgr.change("ViewTransConfirmGas");_context16.next=39;break;case 33:BlackCat.ViewWalletOpen.refer="";BlackCat.ViewWalletOpen.callback_params=params;BlackCat.ViewWalletOpen.callback_callback=callback;BlackCat.ViewWalletOpen.callback=function(params,callback){_this7.makeGasTransferMulti(params,callback);};BlackCat.ViewWalletOpen.callback_cancel=function(params,callback){var res=new BlackCat.Result();res.err=true;res.info='cancel';var callback_data={params:params,res:res};Main.listenerCallback("makeGasTransferMultiRes",callback_data);callback(res);};Main.viewMgr.change("ViewWalletOpen");case 39:case'end':return _context16.stop();}}},_callee16,this);}));}},{key:'confirmAppNotify',value:function confirmAppNotify(params){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee17(){var data_res,res,callback_data;return regeneratorRuntime.wrap(function _callee17$(_context17){while(1){switch(_context17.prev=_context17.next){case 0:_context17.next=2;return BlackCat.ApiTool.walletNotify(Main.user.info.uid,Main.user.info.token,params.txid,Main.netMgr.type);case 2:data_res=_context17.sent;res=new BlackCat.Result();if(data_res.r){res.err=false;res.info=data_res.data;callback_data={params:params,res:res};Main.listenerCallback("confirmAppNotifyRes",callback_data);delete Main.appNotifyTxids[params.txid];}else{res.err=true;res.info=data_res.errCode;callback_data={params:params,res:res};Main.listenerCallback("confirmAppNotifyRes",callback_data);}return _context17.abrupt('return',res);case 6:case'end':return _context17.stop();}}},_callee17,this);}));}},{key:'isLogined',value:function isLogined(){return Main.isLoginCallback;}}],[{key:'reset',value:function reset(){var type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;Main.appWalletLogId=0;Main.appWalletNotifyId=0;Main.appNotifyTxids={};Main.platWalletLogId=0;Main.platWalletNotifyId=0;Main.platNotifyTxids={};Main.clearTimeout();if(type==0){Main.needGetAppNotifys=false;Main.needGetPlatNotifys=false;}else{Main.needGetAppNotifys=true;Main.needGetPlatNotifys=true;}}},{key:'clearTimeout',value:function(_clearTimeout){function clearTimeout(){return _clearTimeout.apply(this,arguments);}clearTimeout.toString=function(){return _clearTimeout.toString();};return clearTimeout;}(function(){if(Main.s_update){clearTimeout(Main.s_update);Main.update();}})},{key:'getSgasBalanceByAddress',value:function getSgasBalanceByAddress(id_SGAS,address){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee18(){var params,res,data,balances,balance;return regeneratorRuntime.wrap(function _callee18$(_context18){while(1){switch(_context18.prev=_context18.next){case 0:params={sbParamJson:["(addr)"+address],sbPushString:"balanceOf",nnc:id_SGAS};_context18.prev=1;_context18.next=4;return Main.wallet.invokescript(params);case 4:res=_context18.sent;if(!(res.err==false)){_context18.next=11;break;}data=res.info;if(!(data["stack"]&&data["stack"].length>0)){_context18.next=11;break;}balances=data["stack"][0];balance=new Neo.BigInteger(balances.value.hexToBytes()).toString();return _context18.abrupt('return',Number(balance)/100000000);case 11:_context18.next=16;break;case 13:_context18.prev=13;_context18.t0=_context18['catch'](1);console.log("[BlaCat]",'[main]','getSgasBalanceByAddress =>',_context18.t0);case 16:return _context18.abrupt('return',0);case 17:case'end':return _context18.stop();}}},_callee18,this,[[1,13]]);}));}},{key:'loginCallback',value:function loginCallback(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee19(){var res,res_nncs;return regeneratorRuntime.wrap(function _callee19$(_context19){while(1){switch(_context19.prev=_context19.next){case 0:if(Main.isLoginCallback){_context19.next=20;break;}_context19.next=3;return BlackCat.ApiTool.getEnterParams(Main.user.info.uid,Main.user.info.token,Main.appid);case 3:res=_context19.sent;if(!res.r){_context19.next=19;break;}Main.setGameInfo(res.data.gameParam);Main.setTsOffset(res.data.loginParam);_context19.next=9;return BlackCat.ApiTool.getTrustNncs(Main.user.info.uid,Main.user.info.token,Main.appid);case 9:res_nncs=_context19.sent;if(res_nncs.r){Main.app_trust=res_nncs.data;}else{Main.app_trust=[];}Main.listenerCallback("loginRes",res.data.loginParam);if(Main.loginFunctionCallback)Main.loginFunctionCallback(res.data.loginParam);Main.isLoginCallback=true;Main.needGetAppNotifys=true;Main.needGetPlatNotifys=true;console.log("[BlaCat]",'[main]','loginCallback，轮询平台notify和应用notify');_context19.next=20;break;case 19:Main.showErrCode(res.errCode);case 20:case'end':return _context19.stop();}}},_callee19,this);}));}},{key:'setGameInfo',value:function setGameInfo(param){Main.appname=param.name;Main.appicon=param.icon;Main.app_recharge_addr=param.recharge_addr;}},{key:'logoutCallback',value:function logoutCallback(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee20(){return regeneratorRuntime.wrap(function _callee20$(_context20){while(1){switch(_context20.prev=_context20.next){case 0:Main.isLoginCallback=false;Main.listenerCallback("logoutRes",null);Main.reset();if(Main.platLoginType===1){window.history.back();}case 4:case'end':return _context20.stop();}}},_callee20,this);}));}},{key:'listenerCallback',value:function listenerCallback(cmd,data){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee21(){var callback_data;return regeneratorRuntime.wrap(function _callee21$(_context21){while(1){switch(_context21.prev=_context21.next){case 0:callback_data={cmd:cmd,data:data};Main.callback(JSON.stringify(callback_data));case 2:case'end':return _context21.stop();}}},_callee21,this);}));}},{key:'update',value:function update(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee22(){var _this9=this;var cur_ts,timeout;return regeneratorRuntime.wrap(function _callee22$(_context22){while(1){switch(_context22.prev=_context22.next){case 0:_context22.prev=0;_context22.next=3;return Main.getAppNotifys();case 3:_context22.next=8;break;case 5:_context22.prev=5;_context22.t0=_context22['catch'](0);console.log("[BlaCat]",'[main]','update, Main.getAppNotifys() error => ',_context22.t0.toString());case 8:_context22.prev=8;_context22.next=11;return Main.getPlatNotifys();case 11:_context22.next=16;break;case 13:_context22.prev=13;_context22.t1=_context22['catch'](8);console.log("[BlaCat]",'[main]','update, Main.getPlatNotifys() error => ',_context22.t1.toString());case 16:if(Main.viewMgr.payView&&Main.viewMgr.payView.isCreated&&!Main.viewMgr.payView.isHidden()){try{Main.viewMgr.payView.flushListCtm();}catch(e){console.log("[BlaCat]",'[main]','update, Main.viewMgr.payView.flushListCtm() error => ',e.toString());}}if(Main.liveTime&&Main.liveTime>0&&Main.liveTimeMax!=0){if(Main.isWalletOpen()==true){cur_ts=new Date().getTime();if(cur_ts-Main.liveTime>Main.liveTimeMax){Main.wallet.closeWallet();}}}timeout=Main.update_timeout_min;if(Main.isLoginCallback){timeout=Main.update_timeout_max;}Main.s_update=setTimeout(function(){_this9.update();},timeout);case 21:case'end':return _context22.stop();}}},_callee22,this,[[0,5],[8,13]]);}));}},{key:'getAppNotifys',value:function getAppNotifys(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee23(){var res,new_app_notifys;return regeneratorRuntime.wrap(function _callee23$(_context23){while(1){switch(_context23.prev=_context23.next){case 0:if(!(Main.needGetAppNotifys==true||Main.appWalletLogId&&Main.appWalletLogId>Main.appWalletNotifyId)){_context23.next=20;break;}console.log("[BlaCat]",'[main]','getAppNotifys, 执行前，是否获取: '+Main.needGetAppNotifys+", 最近记录ID: "+Main.appWalletLogId+", 最近通知ID: "+Main.appWalletNotifyId);_context23.next=4;return BlackCat.ApiTool.getAppWalletNotifys(Main.user.info.uid,Main.user.info.token,Main.appid,Main.netMgr.type);case 4:res=_context23.sent;if(!res.r){_context23.next=18;break;}if(!(res.data.pending.length>0)){_context23.next=11;break;}_context23.next=9;return res.data.pending.forEach(function(list){var list_id=parseInt(list.id);if(Main.appWalletLogId<list_id){Main.appWalletLogId=list_id;}});case 9:_context23.next=13;break;case 11:console.log("[BlaCat]",'[main]','getAppNotifys, 没有等待确认的数据，关闭轮询');Main.needGetAppNotifys=false;case 13:if(!(res.data.complete.length>0)){_context23.next=18;break;}new_app_notifys=new Array();_context23.next=17;return res.data.complete.forEach(function(list){var list_id=parseInt(list.id);if(!Main.appNotifyTxids.hasOwnProperty(list.txid)){new_app_notifys.push(list);}if(Main.appWalletNotifyId<list_id)Main.appWalletNotifyId=list_id;if(Main.appWalletLogId<list_id)Main.appWalletLogId=list_id;Main.appNotifyTxids[list.txid]=1;});case 17:if(new_app_notifys.length>0){console.log("[BlaCat]",'[main]','getAppNotifys, 需要回调数据 => ',new_app_notifys);Main.listenerCallback("getAppNotifysRes",new_app_notifys);}case 18:console.log("[BlaCat]",'[main]','getAppNotifys，执行后，是否获取: '+Main.needGetAppNotifys+", 最近记录ID: "+Main.appWalletLogId+", 最近通知ID: "+Main.appWalletNotifyId);return _context23.abrupt('return',true);case 20:return _context23.abrupt('return',false);case 21:case'end':return _context23.stop();}}},_callee23,this);}));}},{key:'doPlatNotify',value:function doPlatNotify(params){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee24(){var _this10=this;var openTask,k;return regeneratorRuntime.wrap(function _callee24$(_context24){while(1){switch(_context24.prev=_context24.next){case 0:console.log("[BlaCat]",'[main]','doPlatNotify, params => ',params);openTask=null;_context24.t0=regeneratorRuntime.keys(params);case 3:if((_context24.t1=_context24.t0()).done){_context24.next=25;break;}k=_context24.t1.value;_context24.t2=params[k].type;_context24.next=_context24.t2==="2"?8:23;break;case 8:if(!(params[k].state=="1")){_context24.next=21;break;}if(!params[k].ext){_context24.next=13;break;}Main.doPlatNotifyRefundRes(params[k],params[k].ext);_context24.next=19;break;case 13:if(Main.isWalletOpen()){_context24.next=18;break;}console.log("[BlaCat]",'[main]','***getPlatNotifys，钱包未打开，收集数据');if(!openTask){openTask=new Array();}openTask.push(params[k]);return _context24.abrupt('break',23);case 18:Main.doPlatNotiyRefund(params[k]);case 19:_context24.next=22;break;case 21:this.confirmPlatNotify(params[k]);case 22:return _context24.abrupt('break',23);case 23:_context24.next=3;break;case 25:if(openTask){BlackCat.ViewConfirm.callback_params=openTask;BlackCat.ViewConfirm.callback=function(params){BlackCat.ViewWalletOpen.callback_params=params;BlackCat.ViewWalletOpen.callback=function(params){_this10.doPlatNotify(params);};BlackCat.ViewWalletOpen.callback_cancel=function(params){BlackCat.ViewWalletOpen.addTask("getPlatNotifys",params);};Main.viewMgr.change("ViewWalletOpen");};BlackCat.ViewConfirm.callback_cancel=function(params){BlackCat.ViewWalletOpen.addTask("getPlatNotifys",params);};Main.showConFirm("main_need_open_wallet_confirm");}case 26:case'end':return _context24.stop();}}},_callee24,this);}));}},{key:'continueRefund',value:function continueRefund(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee25(){return regeneratorRuntime.wrap(function _callee25$(_context25){while(1){switch(_context25.prev=_context25.next){case 0:BlackCat.ViewConfirm.callback=function(){BlackCat.ViewWalletOpen.refer=null;Main.viewMgr.change("ViewWalletOpen");};Main.showConFirm("main_need_open_wallet_confirm");case 2:case'end':return _context25.stop();}}},_callee25,this);}));}},{key:'doPlatNotiyRefund',value:function doPlatNotiyRefund(params){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee26(){var utxo,utxos_assets,makeTranRes,tran,oldarr,id_SGAS,params_decode,r,sgasScript,sb,txid,trandata,res,height;return regeneratorRuntime.wrap(function _callee26$(_context26){while(1){switch(_context26.prev=_context26.next){case 0:utxo=new BlackCat.tools.UTXO();utxo.addr=Main.user.info.wallet;utxo.txid=params.txid;utxo.asset=BlackCat.tools.CoinTool.id_GAS;utxo.count=Neo.Fixed8.parse(params.cnts.toString());utxo.n=0;utxos_assets={};utxos_assets[BlackCat.tools.CoinTool.id_GAS]=[];utxos_assets[BlackCat.tools.CoinTool.id_GAS].push(utxo);console.log("[BlaCat]",'[main]','doPlatNotiyRefund, utxos_assets => ',utxos_assets);_context26.prev=10;makeTranRes=BlackCat.tools.CoinTool.makeTran(utxos_assets,Main.user.info.wallet,BlackCat.tools.CoinTool.id_GAS,Neo.Fixed8.fromNumber(Number(params.cnts)));_context26.next=18;break;case 14:_context26.prev=14;_context26.t0=_context26['catch'](10);Main.showErrMsg("main_refund_second_fail");return _context26.abrupt('return');case 18:tran=makeTranRes.info.tran;oldarr=makeTranRes.info.oldarr;tran.type=ThinNeo.TransactionType.ContractTransaction;tran.version=0;id_SGAS=BlackCat.tools.CoinTool.id_SGAS;try{params_decode=JSON.parse(params.params);if(params_decode&&params_decode.hasOwnProperty("nnc")){id_SGAS=params_decode.nnc;}}catch(e){}_context26.next=26;return BlackCat.tools.WWW.api_getcontractstate(id_SGAS);case 26:r=_context26.sent;if(!(r&&r["script"])){_context26.next=61;break;}sgasScript=r["script"].hexToBytes();sb=new ThinNeo.ScriptBuilder();sb.EmitPushNumber(new Neo.BigInteger(0));sb.EmitPushNumber(new Neo.BigInteger(0));tran.AddWitnessScript(sgasScript,sb.ToArray());txid=tran.GetHash().clone().reverse().toHexString();trandata=tran.GetRawData();_context26.next=37;return BlackCat.tools.WWW.api_postRawTransaction(trandata);case 37:r=_context26.sent;if(!r){_context26.next=58;break;}console.log("[BlaCat]",'[main]','doPlatNotiyRefund, api_postRawTransaction.r => ',r);if(!(r["txid"]||r['sendrawtransactionresult'])){_context26.next=55;break;}if(!r["txid"]||r["txid"]==""){r["txid"]=txid;}console.log("[BlaCat]",'[main]','doPlatNotiyRefund, txid => ',r.txid);_context26.next=45;return Main.confirmPlatNotifyExt(params,r.txid);case 45:res=_context26.sent;this.doPlatNotifyRefundRes(params,r.txid);_context26.next=49;return BlackCat.tools.WWW.api_getHeight_nodes();case 49:height=_context26.sent;oldarr.map(function(old){return old.height=height;});BlackCat.tools.OldUTXO.oldutxosPush(oldarr);Main.viewMgr.payView.doGetWalletLists(1);_context26.next=56;break;case 55:Main.showErrMsg("main_refund_doFail");case 56:_context26.next=59;break;case 58:Main.showErrMsg("main_refund_sendRequest_err");case 59:_context26.next=62;break;case 61:Main.showErrMsg("main_refund_getScript_err");case 62:case'end':return _context26.stop();}}},_callee26,this,[[10,14]]);}));}},{key:'doPlatNotifyRefundRes',value:function doPlatNotifyRefundRes(params,txid){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee27(){var _this11=this;var r;return regeneratorRuntime.wrap(function _callee27$(_context27){while(1){switch(_context27.prev=_context27.next){case 0:_context27.next=2;return BlackCat.tools.WWW.getrawtransaction(txid);case 2:r=_context27.sent;if(!r){_context27.next=10;break;}console.log("[BlaCat]",'[main]','doPlatNotifyRefundRes, txid: '+txid+", r => ",r);_context27.next=7;return Main.confirmPlatNotify(params);case 7:Main.viewMgr.payView.doGetWalletLists();_context27.next=11;break;case 10:setTimeout(function(){_this11.doPlatNotifyRefundRes(params,txid);},10000);case 11:case'end':return _context27.stop();}}},_callee27,this);}));}},{key:'confirmPlatNotify',value:function confirmPlatNotify(params){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee28(){var res;return regeneratorRuntime.wrap(function _callee28$(_context28){while(1){switch(_context28.prev=_context28.next){case 0:_context28.next=2;return BlackCat.ApiTool.walletNotify(Main.user.info.uid,Main.user.info.token,params.txid,Main.netMgr.type);case 2:res=_context28.sent;delete Main.platNotifyTxids[params.txid];return _context28.abrupt('return',res);case 5:case'end':return _context28.stop();}}},_callee28,this);}));}},{key:'confirmPlatNotifyExt',value:function confirmPlatNotifyExt(params,ext){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee29(){var res;return regeneratorRuntime.wrap(function _callee29$(_context29){while(1){switch(_context29.prev=_context29.next){case 0:_context29.next=2;return BlackCat.ApiTool.walletNotifyExt(Main.user.info.uid,Main.user.info.token,params.txid,ext,Main.netMgr.type);case 2:res=_context29.sent;return _context29.abrupt('return',res);case 4:case'end':return _context29.stop();}}},_callee29,this);}));}},{key:'getPlatNotifys',value:function getPlatNotifys(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee30(){var res,new_plat_notifys;return regeneratorRuntime.wrap(function _callee30$(_context30){while(1){switch(_context30.prev=_context30.next){case 0:if(!(Main.needGetPlatNotifys==true||Main.platWalletLogId&&Main.platWalletLogId>Main.platWalletNotifyId)){_context30.next=20;break;}console.log("[BlaCat]",'[main]','***getPlatNotifys, 执行前，是否获取: '+Main.needGetPlatNotifys+', 最近记录ID: '+Main.platWalletLogId+', 最近处理ID: '+Main.platWalletNotifyId);_context30.next=4;return BlackCat.ApiTool.getPlatWalletNotifys(Main.user.info.uid,Main.user.info.token,Main.netMgr.type);case 4:res=_context30.sent;if(!res.r){_context30.next=18;break;}if(!(res.data.pending.length>0)){_context30.next=11;break;}_context30.next=9;return res.data.pending.forEach(function(list){var list_id=parseInt(list.id);if(Main.platWalletLogId<list_id){Main.platWalletLogId=list_id;}});case 9:_context30.next=13;break;case 11:console.log("[BlaCat]",'[main]','getPlatNotifys, 没有等待确认的数据，关闭轮询');Main.needGetPlatNotifys=false;case 13:if(!(res.data.complete.length>0)){_context30.next=18;break;}new_plat_notifys=new Array();_context30.next=17;return res.data.complete.forEach(function(list){var list_id=parseInt(list.id);if(!Main.platNotifyTxids.hasOwnProperty(list.txid)){new_plat_notifys.push(list);}if(Main.platWalletNotifyId<=parseInt(list.id))Main.platWalletNotifyId=parseInt(list.id);if(Main.platWalletLogId<list_id)Main.platWalletLogId=list_id;Main.platNotifyTxids[list.txid]=1;});case 17:if(new_plat_notifys.length>0){console.log("[BlaCat]",'[main]','***getPlatNotifys, 有新数据 => ',new_plat_notifys);Main.doPlatNotify(new_plat_notifys);}case 18:console.log("[BlaCat]",'[main]','***getPlatNotifys, 执行后，是否获取: '+Main.needGetPlatNotifys+', 最近记录ID: '+Main.platWalletLogId+', 最近处理ID: '+Main.platWalletNotifyId);return _context30.abrupt('return',true);case 20:return _context30.abrupt('return',false);case 21:case'end':return _context30.stop();}}},_callee30,this);}));}},{key:'changeNetType',value:function changeNetType(type){Main.netMgr.change(function(){Main.listenerCallback('changeNetTypeRes',type);Main.viewMgr.mainView.changNetType();Main.viewMgr.update();Main.reset(1);},type);}},{key:'getUrlParam',value:function getUrlParam(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)");var r=window.location.search.substr(1).match(reg);if(r!=null){return unescape(r[2]);}return null;}},{key:'validateLogin',value:function validateLogin(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee31(){var uid,token,res_isLogined,new_wallet_file,res;return regeneratorRuntime.wrap(function _callee31$(_context31){while(1){switch(_context31.prev=_context31.next){case 0:uid=Main.getUrlParam('uid');token=Main.getUrlParam('token');if(!(uid&&token)){_context31.next=14;break;}_context31.next=5;return BlackCat.ApiTool.isLogined(uid,token);case 5:res_isLogined=_context31.sent;if(!res_isLogined.r){_context31.next=14;break;}localStorage.setItem(this.user.cacheKey,JSON.stringify(res_isLogined.data));this.user.getInfo();Main.platLoginType=1;_context31.next=12;return this.user.getWalletFile();case 12:new_wallet_file=_context31.sent;if(new_wallet_file!=null){localStorage.setItem(this.user.info.wallet,new_wallet_file);}case 14:_context31.next=16;return Main.user.validateLogin();case 16:res=_context31.sent;_context31.t0=res;_context31.next=_context31.t0===0?20:_context31.t0===1?23:_context31.t0===-1?26:29;break;case 20:console.log("[BlaCat]",'[main]','未登录 ...');Main.viewMgr.change("LoginView");return _context31.abrupt('break',29);case 23:console.log("[BlaCat]",'[main]','已登录，已绑定钱包 ...');Main.viewMgr.change("PayView");return _context31.abrupt('break',29);case 26:console.log("[BlaCat]",'[main]','已登录，未绑定钱包 ...');Main.viewMgr.change("WalletView");return _context31.abrupt('break',29);case 29:case'end':return _context31.stop();}}},_callee31,this);}));}},{key:'showErrCode',value:function showErrCode(errCode){var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee32(){var msgId,msg;return regeneratorRuntime.wrap(function _callee32$(_context32){while(1){switch(_context32.prev=_context32.next){case 0:msgId="errCode_"+errCode.toString();msg=Main.langMgr.get(msgId);if(!(msg=="")){_context32.next=7;break;}msgId="errCode_default";msg=Main.langMgr.get("errCode_default")+errCode;this.showErrMsg(msgId,callback,{errCode:errCode});return _context32.abrupt('return');case 7:if(!(errCode==100701)){_context32.next=12;break;}this.showErrMsg(msgId,function(){Main.viewMgr.removeAll();Main.viewMgr.change("LoginView");});Main.user.logout();Main.logoutCallback();return _context32.abrupt('return');case 12:this.showErrMsg(msgId,callback);case 13:case'end':return _context32.stop();}}},_callee32,this);}));}},{key:'showErrMsg',value:function showErrMsg(errMsgKey){var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var content_ext=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee33(){return regeneratorRuntime.wrap(function _callee33$(_context33){while(1){switch(_context33.prev=_context33.next){case 0:BlackCat.ViewAlert.content=errMsgKey;BlackCat.ViewAlert.content_ext=content_ext;BlackCat.ViewAlert.callback=callback;Main.viewMgr.change("ViewAlert");case 4:case'end':return _context33.stop();}}},_callee33,this);}));}},{key:'showToast',value:function showToast(msgKey){var showTime=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1500;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee34(){return regeneratorRuntime.wrap(function _callee34$(_context34){while(1){switch(_context34.prev=_context34.next){case 0:BlackCat.ViewToast.content=msgKey;BlackCat.ViewToast.showTime=showTime;Main.viewMgr.change("ViewToast");case 3:case'end':return _context34.stop();}}},_callee34,this);}));}},{key:'showInfo',value:function showInfo(msgKey){var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var content_ext=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee35(){return regeneratorRuntime.wrap(function _callee35$(_context35){while(1){switch(_context35.prev=_context35.next){case 0:BlackCat.ViewAlert.content=msgKey;BlackCat.ViewAlert.content_ext=content_ext;BlackCat.ViewAlert.callback=callback;Main.viewMgr.change("ViewAlert");case 4:case'end':return _context35.stop();}}},_callee35,this);}));}},{key:'showConFirm',value:function showConFirm(msgKey){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee36(){return regeneratorRuntime.wrap(function _callee36$(_context36){while(1){switch(_context36.prev=_context36.next){case 0:BlackCat.ViewConfirm.content=msgKey;Main.viewMgr.change("ViewConfirm");case 2:case'end':return _context36.stop();}}},_callee36,this);}));}},{key:'showLoading',value:function showLoading(msgKey){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee37(){return regeneratorRuntime.wrap(function _callee37$(_context37){while(1){switch(_context37.prev=_context37.next){case 0:BlackCat.ViewLoading.content=msgKey;Main.viewMgr.change("ViewLoading");case 2:case'end':return _context37.stop();}}},_callee37,this);}));}},{key:'isWalletOpen',value:function isWalletOpen(){if(Main.wallet.isOpen()&&Main.user.info.wallet==Main.wallet.wallet_addr){return true;}return false;}},{key:'isLoginInit',value:function isLoginInit(){if(BlackCat.tools.WWW.api_nodes){return false;}return true;}},{key:'validateFormat',value:function validateFormat(type,inputElement){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee38(){var regex,isAddress,isDomain,addr;return regeneratorRuntime.wrap(function _callee38$(_context38){while(1){switch(_context38.prev=_context38.next){case 0:_context38.t0=type;_context38.next=_context38.t0==="user"?3:_context38.t0==="email"?5:_context38.t0==="phone"?7:_context38.t0==="vcode"?9:_context38.t0==="walletaddr"?11:36;break;case 3:regex=/^[a-zA-Z0-9_]{4,16}$/;return _context38.abrupt('break',36);case 5:regex=/^([0-9A-Za-z\-_\.]+)@([0-9A-Za-z]+\.[a-zA-Z]{2,3}(\.[a-zA-Z]{2})?)$/g;return _context38.abrupt('break',36);case 7:regex=/^\d{4,}$/;return _context38.abrupt('break',36);case 9:regex=/^\d{6}$/;return _context38.abrupt('break',36);case 11:isAddress=BlackCat.tools.NNSTool.verifyAddr(inputElement.value);if(!isAddress){_context38.next=22;break;}_context38.prev=13;if(!BlackCat.tools.neotools.verifyPublicKey(inputElement.value)){_context38.next=16;break;}return _context38.abrupt('return',true);case 16:_context38.next=20;break;case 18:_context38.prev=18;_context38.t1=_context38['catch'](13);case 20:_context38.next=35;break;case 22:isDomain=BlackCat.tools.NNSTool.verifyDomain(inputElement.value);if(!isDomain){_context38.next=35;break;}_context38.prev=24;inputElement.value=inputElement.value.toLowerCase();_context38.next=28;return BlackCat.tools.NNSTool.resolveData(inputElement.value);case 28:addr=_context38.sent;if(!addr){_context38.next=31;break;}return _context38.abrupt('return',addr);case 31:_context38.next=35;break;case 33:_context38.prev=33;_context38.t2=_context38['catch'](24);case 35:return _context38.abrupt('break',36);case 36:if(!regex){_context38.next=39;break;}if(!regex.test(inputElement.value)){_context38.next=39;break;}return _context38.abrupt('return',true);case 39:Main.showErrMsg('main_'+type+'_format_err',function(){inputElement.focus();});return _context38.abrupt('return',false);case 41:case'end':return _context38.stop();}}},_callee38,this,[[13,18],[24,33]]);}));}},{key:'getPhone',value:function getPhone(selectArea,phone){var area=BlackCat.AreaView.getByCodeName(selectArea);if(!area)return null;var phoneMerge=phone+'@'+area.areacode;return phoneMerge;}},{key:'getDate',value:function getDate(timeString){if(timeString!="0"&&timeString!=""){var date=new Date(parseInt(timeString)*1000);var fmt="yyyy-MM-dd hh:mm:ss";var o={"M+":date.getMonth()+1,"d+":date.getDate(),"h+":date.getHours(),"m+":date.getMinutes(),"s+":date.getSeconds(),"q+":Math.floor((date.getMonth()+3)/3),S:date.getMilliseconds()};if(/(y+)/.test(fmt))fmt=fmt.replace(RegExp.$1,(date.getFullYear()+"").substr(4-RegExp.$1.length));for(var k in o){if(new RegExp("("+k+")").test(fmt))fmt=fmt.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length));}return fmt;}return"";}},{key:'getObjectClass',value:function getObjectClass(obj){if(obj&&obj.constructor&&obj.constructor.toString()){if(obj.constructor.name){return obj.constructor.name;}var str=obj.constructor.toString();if(str.charAt(0)=='['){var arr=str.match(/\[\w+\s*(\w+)\]/);}else{var arr=str.match(/function\s*(\w+)/);}if(arr&&arr.length==2){return arr[1];}}return undefined;}},{key:'getUnTrustNnc',value:function getUnTrustNnc(params){var result=[];if(params.hasOwnProperty('nnc')){params=[params];}if(params instanceof Array){for(var i=0;i<params.length;i++){if(params[i].hasOwnProperty('nnc')){var nnc=params[i]['nnc'];if(Main.app_trust.length==0){result.push(nnc);}else{var isTrust=false;for(var m=0;m<Main.app_trust.length;m++){if(Main.app_trust[m]&&nnc==Main.app_trust[m]['nnc']){isTrust=true;break;}}if(isTrust==false){result.push(nnc);}}}}}return result;}},{key:'updateTrustNnc',value:function updateTrustNnc(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee39(){var res_nncs;return regeneratorRuntime.wrap(function _callee39$(_context39){while(1){switch(_context39.prev=_context39.next){case 0:_context39.prev=0;_context39.next=3;return BlackCat.ApiTool.getTrustNncs(Main.user.info.uid,Main.user.info.token,Main.appid);case 3:res_nncs=_context39.sent;if(res_nncs.r){Main.app_trust=res_nncs.data;if(Main.viewMgr.trustContractView&&!Main.viewMgr.trustContractView.isHidden()){Main.viewMgr.trustContractView.remove();}}else{Main.app_trust=[];}_context39.next=10;break;case 7:_context39.prev=7;_context39.t0=_context39['catch'](0);console.log("[BlaCat]",'[main]','updateTrustNnc, ApiTool.getTrustNncs error => ',_context39.t0.toString());case 10:case'end':return _context39.stop();}}},_callee39,this,[[0,7]]);}));}},{key:'removeTrustNnc',value:function removeTrustNnc(nnc){if(Main.app_trust.length>0){for(var k=0;k<Main.app_trust.length;k++){if(Main.app_trust[k]&&Main.app_trust[k]['nnc']==nnc){delete Main.app_trust[k];break;}}}}},{key:'setLiveTime',value:function setLiveTime(){Main.liveTime=new Date().getTime();}},{key:'setLiveTimeMax',value:function setLiveTimeMax(minutes){Main.liveTimeMax=minutes*60*1000;}},{key:'getLiveTimeMax',value:function getLiveTimeMax(){return Main.liveTimeMax;}},{key:'getStringNumber',value:function getStringNumber(num){var num_str=num.toString();if(num_str.indexOf('-')>=0){num_str='0'+(num+1).toString().substr(1);}return num_str;}},{key:'setTsOffset',value:function setTsOffset(loginParam){var curr_ts=Math.round(new Date().getTime()/1000);Main.tsOffset=(curr_ts-loginParam.time)*1000;console.log('[BlaCat]','[Main]','setTsOffset, tsOffset => ',Main.tsOffset);}},{key:'getUrlHead',value:function getUrlHead(){if(Main.urlHead===undefined){if(window.location.protocol=="file:"){Main.urlHead="http:";}else{Main.urlHead="";}}return Main.urlHead;}},{key:'randomSort',value:function randomSort(arr,newArr){if(arr.length==1){newArr.push(arr[0]);return newArr;}var random=Math.ceil(Math.random()*arr.length)-1;newArr.push(arr[random]);arr.splice(random,1);return Main.randomSort(arr,newArr);}}]);return Main;}();Main.platName="BlaCat";Main.platLoginType=0;Main.resHost=BC_path+"../";Main.liveTimeMax=60*60*1000;BlackCat.Main=Main;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ComponentBase=function(){function ComponentBase(){_classCallCheck(this,ComponentBase);}_createClass(ComponentBase,[{key:'objCreate',value:function objCreate(tag){var addElement=document.createElement(tag);return addElement;}},{key:'ObjAppend',value:function ObjAppend(o,tag){o.appendChild(tag);}},{key:'objRemove',value:function objRemove(o,tag){o.removeChild(tag);}},{key:'parentAdd',value:function parentAdd(tag){this.ObjAppend(BlackCat.Main.viewMgr.mainView.div,tag);}},{key:'parentRemove',value:function parentRemove(tag){this.objRemove(BlackCat.Main.viewMgr.mainView.div,tag);}},{key:'bodyAppend',value:function bodyAppend(tag){document.body.appendChild(tag);}},{key:'bodyRemove',value:function bodyRemove(tag){document.body.removeChild(tag);}}]);return ComponentBase;}();BlackCat.ComponentBase=ComponentBase;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var NetFeeComponent=function(_BlackCat$ComponentBa){_inherits(NetFeeComponent,_BlackCat$ComponentBa);function NetFeeComponent(parentDiv,callback){var net_fees=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];_classCallCheck(this,NetFeeComponent);var _this12=_possibleConstructorReturn(this,(NetFeeComponent.__proto__||Object.getPrototypeOf(NetFeeComponent)).call(this));_this12.parentDiv=parentDiv;_this12.callback=callback;if(net_fees.length>0){_this12.net_fees=net_fees;}else{_this12.net_fees=["0.0001","0.0002","0.0004","0.0006","0.0008","0.001"];}_this12.net_fee="0";return _this12;}_createClass(NetFeeComponent,[{key:'setFeeDefault',value:function setFeeDefault(){var net_fee=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"0";this.net_fee=this.net_fees[0];for(var i=0;i<this.net_fees.length;i++){if(this.net_fees[i]==net_fee){this.net_fee=net_fee;break;}}}},{key:'createDiv',value:function createDiv(){var _this13=this;this.mainDiv=this.objCreate("div");this.mainDiv.classList.add("pc_speed");this.ObjAppend(this.parentDiv,this.mainDiv);this.mainDiv_text=this.objCreate("div");this.ObjAppend(this.mainDiv,this.mainDiv_text);var divSpeedSelect=this.objCreate("div");divSpeedSelect.textContent=BlackCat.Main.langMgr.get("pay_transCount_speed");this.ObjAppend(this.mainDiv,divSpeedSelect);this.inputFree=this.objCreate("input");this.inputFree.classList.add("iconfont","icon-shandian");this.inputFree.type="radio";this.inputFree.onclick=function(){_this13.dofree();};this.ObjAppend(divSpeedSelect,this.inputFree);var divEllipsis=this.objCreate("div");divEllipsis.classList.add("pc_ellipsis");for(var i=0;i<this.net_fees.length;i++){divEllipsis.innerHTML+="<label></label>";}this.ObjAppend(divSpeedSelect,divEllipsis);this.inputcharge=this.objCreate("input");this.inputcharge.type="range";this.inputcharge.value='0';this.inputcharge.max=(this.net_fees.length-1).toString();this.inputcharge.oninput=function(){_this13.dospeed();};this.inputcharge.onclick=function(){_this13.dospeed();};this.ObjAppend(divSpeedSelect,this.inputcharge);var divSpeedtips=this.objCreate("ul");divSpeedtips.innerHTML="<li>"+BlackCat.Main.langMgr.get('pay_transCountTips_free')+"</li><li>"+BlackCat.Main.langMgr.get('pay_transCountTips_slow')+"</li><li>"+BlackCat.Main.langMgr.get('pay_transCountTips_fast')+"</li>";this.ObjAppend(this.mainDiv,divSpeedtips);this.ObjAppend(this.parentDiv,this.mainDiv);if(this.net_fee=="0"){this.dofree();}else{this.dospeed();}}},{key:'hidden',value:function hidden(){this.mainDiv.style.display="none";this.callback(0);}},{key:'show',value:function show(){this.mainDiv.style.display="block";this.callback(this.net_fee);}},{key:'dofree',value:function dofree(){this.net_fee="0";this.inputFree.checked=true;this.inputcharge.classList.remove("pc_active");this.mainDiv_text.textContent=BlackCat.Main.langMgr.get("pay_transCount_cost")+this.net_fee+" ("+BlackCat.Main.langMgr.get("gas")+")";this.callback(this.net_fee);}},{key:'dospeed',value:function dospeed(){var idx=parseInt(this.inputcharge.value);if(this.net_fees[idx]){this.net_fee=this.net_fees[idx];}else{this.net_fee=this.net_fees[0];}this.inputcharge.classList.add("pc_active");this.inputFree.checked=false;this.mainDiv_text.textContent=BlackCat.Main.langMgr.get("pay_transCount_cost")+this.net_fee+" ("+BlackCat.Main.langMgr.get("gas")+")";this.callback(this.net_fee);}}]);return NetFeeComponent;}(BlackCat.ComponentBase);BlackCat.NetFeeComponent=NetFeeComponent;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var LangBase=function(){function LangBase(){_classCallCheck(this,LangBase);}_createClass(LangBase,[{key:'get',value:function get(key){if(this.lang.hasOwnProperty(key)){return this.lang[key];}return"";}}]);return LangBase;}();BlackCat.LangBase=LangBase;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var LangCN=function(_BlackCat$LangBase){_inherits(LangCN,_BlackCat$LangBase);function LangCN(){_classCallCheck(this,LangCN);var _this14=_possibleConstructorReturn(this,(LangCN.__proto__||Object.getPrototypeOf(LangCN)).apply(this,arguments));_this14.lang={return:"返回",copy:"复制",ok:"确定",cancel:"取消",more:"更多",info:"提示",content:"内容",retry:"重试",sgas:"SGAS",gas:"GAS",area_code_CN:"中国",area_code_AD:'安道尔',area_code_AE:'阿拉伯联合酋长国',area_code_AF:'阿富汗',area_code_AG:'安提瓜和巴布达',area_code_AI:'安圭拉',area_code_AL:'阿尔巴尼亚',area_code_AM:'亚美尼亚',area_code_AO:'安哥拉',area_code_AR:'阿根廷',area_code_AS:'美属萨摩亚',area_code_AT:'奥地利',area_code_AU:'澳大利亚',area_code_AW:'阿鲁巴',area_code_AZ:'阿塞拜疆',area_code_BA:'波斯尼亚和黑塞哥维那',area_code_BB:'巴巴多斯',area_code_BD:'孟加拉国',area_code_BE:'比利时',area_code_BF:'布基纳法索',area_code_BG:'保加利亚',area_code_BH:'巴林',area_code_BI:'布隆迪',area_code_BJ:'贝宁',area_code_BM:'百慕大群岛',area_code_BN:'文莱',area_code_BO:'玻利维亚',area_code_BQ:'荷兰加勒比',area_code_BR:'巴西',area_code_BS:'巴哈马',area_code_BT:'不丹',area_code_BW:'博茨瓦纳',area_code_BY:'白俄罗斯',area_code_BZ:'伯利兹',area_code_CA:'加拿大',area_code_CD:'刚果民主共和国',area_code_CF:'中非共和国',area_code_CG:'刚果共和国',area_code_CH:'瑞士',area_code_CI:'象牙海岸',area_code_CK:'库克群岛',area_code_CL:'智利',area_code_CM:'喀麦隆',area_code_CO:'哥伦比亚',area_code_CR:'哥斯达黎加',area_code_CU:'古巴',area_code_CV:'开普',area_code_CW:'库拉索',area_code_CY:'塞浦路斯',area_code_CZ:'捷克',area_code_DE:'德国',area_code_DJ:'吉布提',area_code_DK:'丹麦',area_code_DM:'多米尼加',area_code_DO:'多米尼加共和国',area_code_DZ:'阿尔及利亚',area_code_EC:'厄瓜多尔',area_code_EE:'爱沙尼亚',area_code_EG:'埃及',area_code_ER:'厄立特里亚',area_code_ES:'西班牙',area_code_ET:'埃塞俄比亚',area_code_FI:'芬兰',area_code_FJ:'斐济',area_code_FM:'密克罗尼西亚',area_code_FO:'法罗群岛',area_code_FR:'法国',area_code_GA:'加蓬',area_code_GB:'英国',area_code_GD:'格林纳达',area_code_GE:'格鲁吉亚',area_code_GF:'法属圭亚那',area_code_GH:'加纳',area_code_GI:'直布罗陀',area_code_GL:'格陵兰岛',area_code_GM:'冈比亚',area_code_GN:'几内亚',area_code_GP:'瓜德罗普岛',area_code_GQ:'赤道几内亚',area_code_GR:'希腊',area_code_GT:'瓜地马拉',area_code_GU:'关岛',area_code_GW:'几内亚比绍共和国',area_code_GY:'圭亚那',area_code_HK:'中国香港',area_code_HN:'洪都拉斯',area_code_HR:'克罗地亚',area_code_HT:'海地',area_code_HU:'匈牙利',area_code_ID:'印度尼西亚',area_code_IE:'爱尔兰',area_code_IL:'以色列',area_code_IN:'印度',area_code_IQ:'伊拉克',area_code_IR:'伊朗',area_code_IS:'冰岛',area_code_IT:'意大利',area_code_JM:'牙买加',area_code_JO:'约旦',area_code_JP:'日本',area_code_KE:'肯尼亚',area_code_KG:'吉尔吉斯斯坦',area_code_KH:'柬埔寨',area_code_KI:'基里巴斯',area_code_KM:'科摩罗',area_code_KN:'圣基茨和尼维斯',area_code_KP:'朝鲜',area_code_KR:'韩国',area_code_KW:'科威特',area_code_KY:'开曼群岛',area_code_KZ:'哈萨克斯坦',area_code_LA:'老挝',area_code_LB:'黎巴嫩',area_code_LC:'圣露西亚',area_code_LI:'列支敦士登',area_code_LK:'斯里兰卡',area_code_LR:'利比里亚',area_code_LS:'莱索托',area_code_LT:'立陶宛',area_code_LU:'卢森堡',area_code_LV:'拉脱维亚',area_code_LY:'利比亚',area_code_MA:'摩洛哥',area_code_MC:'摩纳哥',area_code_MD:'摩尔多瓦',area_code_ME:'黑山',area_code_MG:'马达加斯加',area_code_MH:'马绍尔群岛',area_code_MK:'马其顿',area_code_ML:'马里',area_code_MM:'缅甸',area_code_MN:'蒙古',area_code_MO:'中国澳门',area_code_MR:'毛里塔尼亚',area_code_MS:'蒙特塞拉特岛',area_code_MT:'马耳他',area_code_MU:'毛里求斯',area_code_MV:'马尔代夫',area_code_MW:'马拉维',area_code_MX:'墨西哥',area_code_MY:'马来西亚',area_code_MZ:'莫桑比克',area_code_NA:'纳米比亚',area_code_NC:'新喀里多尼亚',area_code_NE:'尼日尔',area_code_NG:'尼日利亚',area_code_NI:'尼加拉瓜',area_code_NL:'荷兰',area_code_NO:'挪威',area_code_NP:'尼泊尔',area_code_NR:'拿鲁岛',area_code_NZ:'新西兰',area_code_OM:'阿曼',area_code_PA:'巴拿马',area_code_PE:'秘鲁',area_code_PF:'法属波利尼西亚',area_code_PG:'巴布亚新几内亚',area_code_PH:'菲律宾',area_code_PK:'巴基斯坦',area_code_PL:'波兰',area_code_PM:'圣彼埃尔和密克隆岛',area_code_PR:'波多黎各',area_code_PT:'葡萄牙',area_code_PW:'帕劳',area_code_PY:'巴拉圭',area_code_QA:'卡塔尔',area_code_RE:'留尼汪',area_code_RO:'罗马尼亚',area_code_RS:'塞尔维亚',area_code_RU:'俄罗斯',area_code_RW:'卢旺达',area_code_SA:'沙特阿拉伯',area_code_SB:'所罗门群岛',area_code_SC:'塞舌尔',area_code_SD:'苏丹',area_code_SE:'瑞典',area_code_SG:'新加坡',area_code_SI:'斯洛文尼亚',area_code_SK:'斯洛伐克',area_code_SL:'塞拉利昂',area_code_SM:'圣马力诺',area_code_SN:'塞内加尔',area_code_SO:'索马里',area_code_SR:'苏里南',area_code_ST:'圣多美和普林西比',area_code_SV:'萨尔瓦多',area_code_SY:'叙利亚',area_code_SZ:'斯威士兰',area_code_TC:'特克斯和凯科斯群岛',area_code_TD:'乍得',area_code_TG:'多哥',area_code_TH:'泰国',area_code_TJ:'塔吉克斯坦',area_code_TL:'东帝汶',area_code_TM:'土库曼斯坦',area_code_TN:'突尼斯',area_code_TO:'汤加',area_code_TR:'土耳其',area_code_TT:'特立尼达和多巴哥',area_code_TW:'中国台湾',area_code_TZ:'坦桑尼亚',area_code_UA:'乌克兰',area_code_UG:'乌干达',area_code_US:'美国',area_code_UY:'乌拉圭',area_code_UZ:'乌兹别克斯坦',area_code_VC:'圣文森特和格林纳丁斯',area_code_VE:'委内瑞拉',area_code_VG:'英属处女群岛',area_code_VN:'越南',area_code_VU:'瓦努阿图',area_code_WS:'萨摩亚',area_code_YE:'也门',area_code_YT:'马约特',area_code_ZA:'南非',area_code_ZM:'赞比亚',area_code_ZW:'津巴布韦',main_user_format_err:"用户名格式不正确！只能使用4-16位英文字母、数字、下划线！",main_email_format_err:"邮件地址格式不正确！",main_phone_format_err:"手机号码格式不正确！",main_vcode_format_err:"验证码格式不正确！",main_walletaddr_format_err:"钱包地址格式不正确！",main_phone:"手机",main_email:"邮箱",main_user:"用户名",register_title:"注册",register_inputphone:"请输入手机号码",register_inputphone_err:"请输入手机号码",register_inputemail:"请输入邮箱",register_inputemail_err:"请输入邮箱",register_inputUid:"请输入用户名",register_inputUid_err:"请输入用户名",register_inputCode:"请输入验证码",register_inputCode_err:"请输入验证码",register_inputPass:"请输入密码",register_inputPass_err:"请输入密码",register_inputVpass:"再次输入密码",register_inputVpass_err:"请再次输入密码",register_inputVpass_inputPass_err:"密码输入不一致！",register_getCodeSucc:"验证码已成功发送",register_getCode:"获取验证码",register_getCodecount:"重新获取(60)",register_getCodecountRetry:"重新获取",register_exceed:"设置密码不能超过32个字符",register_doLogin:"<<返回登录",register_doRegister:"立即注册",login_inputuser:"请输入用户名",login_inputuser_err:"请输入用户名",login_inputphone:"请输入手机号码",login_inputphone_err:"请输入手机号码",login_inputemail:"请输入邮箱",login_inputemail_err:"请输入邮箱",login_inputPass:"请输入密码",login_inputPass_err:"请输入密码",login_textForgetpass:"忘记密码？",login_doLogin:"登录",login_doRegister:"注册",login_walletDownloadFail:"钱包文件下载失败，请重新登录!",login_loginFail:"登录失败",forgetpass_title:"找回密码",forgetpass_inputphone:"请输入手机号码",forgetpass_inputphone_err:"请输入手机号码",forgetpass_inputemail:"请输入邮箱",forgetpass_inputemail_err:"请输入邮箱",forgetpass_inputUid:"请输入用户名",forgetpass_inputUid_err:"请输入用户名",forgetpass_inputUid_validate_err:"无效的用户名",forgetpass_inputAccount:"请输入手机号码/邮箱",forgetpass_inputAccount_err:"请输入手机号码/邮箱",forgetpass_inputAccount_err_type:"手机号码/邮箱格式不正确，请检查",forgetpass_inputAccount_validate_err:"无效的手机号码/邮箱",forgetpass_inputphone_notexist:"手机未注册，请先注册！",forgetpass_inputemail_notexist:"邮箱未注册，请先注册！",forgetpass_inputCode:"请输入验证码",forgetpass_inputCode_err:"请输入验证码",forgetpass_inputPass:"请输入新密码",forgetpass_inputPass_err:"请输入新密码",forgetpass_inputVpass:"再次输入新密码",forgetpass_inputVpass_err:"请再次输入新密码",forgetpass_inputVpass_inputPass_err:"密码输入不一致！",forgetpass_getCodeSucc:"验证码已成功发送",forgetpass_getCode:"获取验证码",forgetpass_getCodecount:"重新获取(60)",forgetpass_getCodecountRetry:"重新获取",forgetpass_exceed:"设置密码不能超过32个字符",forgetpass_doLogin:"<<返回登录",forgetpass_do:"确定",forgetpass_do_ok:"重置成功，请重新登录！",myInfo:"我的信息",myinfo_headImg:"头像",myinfo_nickname:"昵称",myinfo_sex:"性别",myinfo_sex_0:"请选择",myinfo_sex_1:"男",myinfo_sex_2:"女",myinfo_uid:"账号",myinfo_area:"地区",modifyArea_empty:"请选择",myinfo_security:"安全中心",myinfo_set:"设置",myinfo_logout:"退出账号",myinfo_logoutConfirm:"确定要退出登录么",modifyImg:"头像",modifyImg_succ:"头像修改成功",modifyImg_select:"选择本地图片",modifyImg_select_err:"请选择本地图片",modifyImg_selectSize_err:"选择的图片，大小不要超过100kb",modifyImg_selectType_err:"图片的格式不对，请使用jpg、jpeg或png图片",modifyName:"昵称",modifyName_input:"请输入昵称",modifyName_succ:"昵称修改成功！",modifySex:"性别",modifySex_succ:"性别修改成功",modifyArea:"地区",modifyArea_succ:"地区修改成功",modifyNet:"网络线路",modifyNet_succ:"网络线路修改成功",modifyNet_node_err:"该网络线路不可用，请选择其他线路！",security_title:"安全中心",security_trust:" 信任合约",security_trust_admin:"管理",security_walletOut:"自动登出钱包",security_walletOut_admin:"永不",security_walletOut_admin_m:"%minutes% 分钟",security_walletOut_admin_h:"%hours% 小时",security_walletOut_toast:"当超过一定时间未操作钱包，将会自动登出，需要重新输入密码",trust_title:"信任合约",trust_relieve_succ:"解除合约成功",paylist_txid:"交易单号：",paylist_wallet:"我的钱包：",paylist_nnc:"合约地址：",paylist_sbParamJson:"合约参数：",paylist_sbPushString:"合约方法：",paylist_sbPushString_none:"无",paylist_ctm_year:"%year%年前",paylist_ctm_month:"%month%月前",paylist_ctm_day:"%day%天前",paylist_ctm_hour:"%hour%小时前",paylist_ctm_minute:"%minute%分钟前",paylist_ctm_recent:"刚刚",paylist_noMore:"没有记录了",paylist_getMore:"点击加载更多记录",paylist_noRecord:"没有记录信息",pay_received:"收款",pc_receivables_download:"下载二维码",pc_receivables_address:"钱包地址",pc_receivables_copy:"复制成功",pay_transfer:"提款",pay_transferType:"代币：GAS",pay_transferBalance:"余额：",pay_transferToAddr:"提款地址",pay_transferCount:"提款金额",pay_transferToAddrError:"提款地址错误",pay_transferCountError:"提款金额错误",pay_transferDoSucc:"提款操作成功",pay_transferDoFail:"提款失败",pay_transferGasNotEnough:"GAS余额不足！",pay_wallet:"我的钱包",pay_refresh:"刷新",pay_wallet_detail:"详情",pay_coin_name:"代币",pay_coin_old:"SGAS(old)兑换",pay_gas:"GAS",pay_gas_desc:"GAS是NEO链上的数字货币，可以通过交易所获取",pay_sgas:"SGAS",pay_sgas_desc:"SGAS是Bla Cat提供给玩家消费用的通用筹码",pay_send:"提款",pay_purchase:"购买",pay_purchase_testnet_cant_buy:"请切换到主网购买GAS！",pay_makeMint:"兑换",pay_recentLists:"近期记录",pay_makeMintGasNotEnough:"GAS余额不足",pay_makeMintDoFail:"充值SGAS失败！\r\n充值合约执行失败！\r\n请等待上次充值确认后再操作！",pay_makeMintDoFail2:"充值SGAS失败！\r\n发送充值请求失败！请检查网络，稍候重试！",pay_makeRefundSgasNotEnoughUtxo:"SGAS兑换繁忙，请稍后重试！",pay_makeRefundSgasNotEnough:"SGAS余额不足",pay_makeRefundGasFeeNotEnough:"GAS余额不足，无法支付手续费！",pay_makeRefundDoFail:"提取合约执行失败！请等待上个提现或兑换交易完成再操作！",pay_makeRefundDoFail2:"发送提取交易失败！请检查网络，稍候重试！",pay_makeRefundGetScriptFail:"获取提取合约失败！",pay_makeRefundSgasOldNotEnough:"SGAS(old)余额不足",pay_not_enough_money:"余额不足",pay_not_enough_utxo:"请等待上次交易完成再执行！",pay_nettype_1:"主网",pay_nettype_2:"测试网",pay_walletDetail:"钱包详情",pay_walletDetail_addr:"地址：",pay_walletDetail_key:"公钥：",pay_walletDetail_hex:"密钥HEX：",pay_walletDetail_wif:"密钥WIF：",pay_walletDetail_notice:"为避免财产损失，展开密钥时请防止泄露。",pay_walletDetail_export:"导出钱包",pay_makerawtrans_err:"交易发起失败",addressbook_title:"通讯录",addressbook_search:"搜索",addressbook_det_title:"通讯录",addressbook_det_transfer:"转账",addressbook_det_address:"钱包地址",addressbook_det_download:"下载二维码",addressbook_det_describe:"描述",addressbook_det_empty:"空",addressbook_det_del:"删除联系人",addressbook_det_del_title:"删除",addressbook_det_del_tips:"您确认删除联系人？",addressbook_det_del_succ:"删除成功",addressbook_op_button:"完成",addressbook_op_name:"联系人",addressbook_op_inputName:"输入联系人",addressbook_op_inputName_err:"请输入联系人",addressbook_op_address:"钱包地址",addressbook_op_inputAddress:"输入钱包地址",addressbook_op_inputAddress_err:"请输入钱包地址",addressbook_op_describe:"描述",addressbook_op_inputDescribe:"输入描述",addressbook_op_inputDescribe_err:"请输入描述",addressbook_op_addSucc:"联系人添加成功",addressbook_op_updateSucc:"联系人修改成功",pay_exchange_gas:"购买GAS",pay_exchange_purchase:"购买",pay_exchange_price:"最新价",pay_exchange_range:"24H涨跌",pay_makeRecharge:"充值",pay_trust_tips:"信任合约",pay_trust_Vice_tips:"（本合约交易不再弹出此窗口）",pay_transferGas_toaddr:"转账地址",pay_transferGas_count:"转账金额",pay_transCount_count:"兑换",pay_transCount_inputCount:"请输入需要兑换的金额",pay_transCount_err:"请输入正确的金额",pay_transCountSGAS2GAS:"GAS",pay_transCountGAS2SGAS:"SGAS",pay_transCountSGASOLD2OLD:"SGAS(old)",pay_transCountTips_free:"免费",pay_transCountTips_slow:"慢",pay_transCountTips_fast:"快",pay_transCount_speed:"交易速度",pay_transCount_cost:"手续费：",pay_transCount_tips:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;选择您要兑换的代币",pay_transCount_tips_err:"选择您要兑换的代币",pay_walletOpen_password:"密码",pay_walletOpen_inputPassword:"请输入钱包密码",pay_walletOpen_inputPassword_err:"请输入钱包密码",pay_walletOpen_file_error:"钱包文件解析异常，请重新登录",pay_walletOpen_openFail:"打开钱包失败！请确认密码后重试！",walletCreate_create:"创建钱包",walletCreate_password:"输入密码",walletCreate_vpass:"确认密码",walletCreate_password_notice:"*密码若丢失将无法找回，请谨慎保管",walletCreate_doCreate:"创建",walletCreate_check_pass:"请检查输入密码",walletCreate_check_vpass:"请检查确认密码",walletCreate_check_exceed:"设置密码不能超过32个字符",walletImport_invalid_file:"请选择有效的钱包文件",walletImport_select_file:"请选择钱包文件",walletImport_import:"导入钱包",walletImport_password:"请输入密码",walletImport_doImport:"绑定钱包",walletImport_bind_succ:"绑定钱包成功！",walletView_info:"做不一样，但好玩的游戏！",walletView_create:"创建钱包",walletView_import:"导入钱包",main_wait_for_last_tran:"请先确认或者取消上个交易请求再执行",main_no_app_wallet:"应用没有配置收款钱包地址，无法充值",main_need_open_wallet_confirm:"提现操作需要打开钱包，是否立即打开？",main_refund_second_fail:"生成转换请求（utxo->gas）失败",main_refund_getScript_err:"获取转换合约失败！",main_refund_sendRequest_err:"发送转换请求失败！",main_refund_doFail:"转换合约执行失败！",errCode_1101:"请求接口参数错误",errCode_1005:"您访问太频繁了，请休息一下！",errCode_100601:"获取短信验证码失败！请检查地区与手机号码！",errCode_100602:"短信验证码错误！",errCode_100605:"手机已注册！",errCode_100606:"手机未注册，请先注册",errCode_100607:"用户名或手机错误！",errCode_100608:"手机或密码错误！",errCode_100700:"账号或密码错误！",errCode_100701:"登录失效，请重新登录",errCode_100702:"账号或密码错误，请重试",errCode_100707:"用户名已存在！",errCode_100708:"用户名格式不正确！",errCode_100709:"地区代码错误！",errCode_100801:"获取邮箱验证码失败！",errcode_100802:"邮箱验证码错误！",errCode_100805:"邮箱已注册！",errCode_100806:"邮箱未注册，请先注册",errCode_100807:"用户名或邮箱错误！",errCode_100808:"邮箱或密码错误！",errCode_8100000:"已经绑定过钱包了，不需要再次绑定！",errCode_8100001:"上传绑定的钱包格式错误，请检查钱包文件！",errCode_8100002:"系统错误，钱包绑定失败！",errCode_8100003:"该钱包已经被其他用户绑定了！",errCode_8100004:"头像文件格式不支持！",errcode_8100005:"头像文件上传失败！",errcode_8100006:"头像文件大小不能超过100kb！",errCode_8100007:"联系人已存在！",errCode_default:"未知错误！错误码： %errCode%",wallet_open_check:"请核对钱包文件或密码！",wallet_open_check_otcgo:"请核对蓝鲸淘钱包文件！",wallet_open_check_otcgo_pwd:"请核对蓝鲸淘钱包密码！",netmgr_select_api_slow:"与服务器连接异常或缓慢，请检查网络后重试！",netmgr_select_node_slow:"与链上节点通讯异常或缓慢，请检查网络后重试！",netmgr_select_cli_slow:"与链上节点通讯异常，请检查网络后重试！",netmgr_connecting:"连接中，请稍候...",netmgr_connecting_fail:"连接失败，请检查网络后重试。"};return _this14;}return LangCN;}(BlackCat.LangBase);BlackCat.LangCN=LangCN;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var LangEN=function(_BlackCat$LangBase2){_inherits(LangEN,_BlackCat$LangBase2);function LangEN(){_classCallCheck(this,LangEN);var _this15=_possibleConstructorReturn(this,(LangEN.__proto__||Object.getPrototypeOf(LangEN)).apply(this,arguments));_this15.lang={return:"Back",copy:"Copy",ok:"OK",cancel:"Cancel",more:"More",info:"Information",content:"Content",retry:"Retry",sgas:"SGAS",gas:"GAS",area_code_CN:'China',area_code_AD:'Andorra',area_code_AE:'United Arab Emirates',area_code_AF:'Afghanistan',area_code_AG:'Antigua and Barbuda',area_code_AI:'Anguilla',area_code_AL:'Albania',area_code_AM:'Armenia',area_code_AO:'Angola',area_code_AR:'Argentina',area_code_AS:'American Samoa',area_code_AT:'Austria',area_code_AU:'Australia',area_code_AW:'Aruba',area_code_AZ:'Azerbaijan',area_code_BA:'Bosniaand Herzegovina',area_code_BB:'Barbados',area_code_BD:'Bangladesh',area_code_BE:'Belgium',area_code_BF:'Burkina Faso',area_code_BG:'Bulgaria',area_code_BH:'Bahrain',area_code_BI:'Burundi',area_code_BJ:'Benin',area_code_BM:'Bermuda',area_code_BN:'Brunei',area_code_BO:'Bolivia',area_code_BQ:'Caribisch Nederland',area_code_BR:'Brazil',area_code_BS:'Bahamas',area_code_BT:'Bhutan',area_code_BW:'Botswana',area_code_BY:'Belarus',area_code_BZ:'Belize',area_code_CA:'Canada',area_code_CD:'Democratic Republic of theCongo',area_code_CF:'Central African Republic',area_code_CG:'Republic Of The Congo',area_code_CH:'Switzerland',area_code_CI:'Ivory Coast',area_code_CK:'Cook Islands',area_code_CL:'Chile',area_code_CM:'Cameroon',area_code_CO:'Colombia',area_code_CR:'CostaRica',area_code_CU:'Cuba',area_code_CV:'Cape Verde',area_code_CW:'Curacao',area_code_CY:'Cyprus',area_code_CZ:'Czech',area_code_DE:'Germany',area_code_DJ:'Djibouti',area_code_DK:'Denmark',area_code_DM:'Dominica',area_code_DO:'dominican republic',area_code_DZ:'Algeria',area_code_EC:'Ecuador',area_code_EE:'Estonia',area_code_EG:'Egypt',area_code_ER:'Eritrea',area_code_ES:'Spain',area_code_ET:'Ethiopia',area_code_FI:'Finland',area_code_FJ:'Fiji',area_code_FM:'Micronesia',area_code_FO:'Faroe Islands',area_code_FR:'France',area_code_GA:'Gabon',area_code_GB:'United Kingdom',area_code_GD:'Grenada',area_code_GE:'Georgia',area_code_GF:'French Guiana',area_code_GH:'Ghana',area_code_GI:'Gibraltar',area_code_GL:'Greenland',area_code_GM:'Gambia',area_code_GN:'Guinea',area_code_GP:'Guadeloupe',area_code_GQ:'Equatorial Guinea',area_code_GR:'Greece',area_code_GT:'Guatemala',area_code_GU:'Guam',area_code_GW:'Guinea-Bissau',area_code_GY:'Guyana',area_code_HK:'Hong Kong',area_code_HN:'Honduras',area_code_HR:'Croatia',area_code_HT:'Haiti',area_code_HU:'Hungary',area_code_ID:'Indonesia',area_code_IE:'Ireland',area_code_IL:'Israel',area_code_IN:'India',area_code_IQ:'Iraq',area_code_IR:'Iran',area_code_IS:'Iceland',area_code_IT:'Italy',area_code_JM:'Jamaica',area_code_JO:'Jordan',area_code_JP:'Japan',area_code_KE:'Kenya',area_code_KG:'Kyrgyzstan',area_code_KH:'Cambodia',area_code_KI:'Kiribati',area_code_KM:'Comoros',area_code_KN:'Saint Kitts and Nevis',area_code_KP:'Korea Democratic Rep.',area_code_KR:'South Korea',area_code_KW:'Kuwait',area_code_KY:'Cayman Islands',area_code_KZ:'Kazakhstan',area_code_LA:'Laos',area_code_LB:'Lebanon',area_code_LC:'Saint Lucia',area_code_LI:'Liechtenstein',area_code_LK:'Sri Lanka',area_code_LR:'Liberia',area_code_LS:'Lesotho',area_code_LT:'Lithuania',area_code_LU:'Luxembourg',area_code_LV:'Latvia',area_code_LY:'Libya',area_code_MA:'Morocco',area_code_MC:'Monaco',area_code_MD:'Moldova',area_code_ME:'Montenegro',area_code_MG:'Madagascar',area_code_MH:'Marshall Islands',area_code_MK:'Macedonia',area_code_ML:'Mali',area_code_MM:'Myanmar',area_code_MN:'Mongolia',area_code_MO:'Macau',area_code_MR:'Mauritania',area_code_MS:'Montserrat',area_code_MT:'Malta',area_code_MU:'Mauritius',area_code_MV:'Maldives',area_code_MW:'Malawi',area_code_MX:'Mexico',area_code_MY:'Malaysia',area_code_MZ:'Mozambique',area_code_NA:'Namibia',area_code_NC:'New Caledonia',area_code_NE:'Niger',area_code_NG:'Nigeria',area_code_NI:'Nicaragua',area_code_NL:'Netherlands',area_code_NO:'Norway',area_code_NP:'Nepal',area_code_NR:'Nauru',area_code_NZ:'New Zealand',area_code_OM:'Oman',area_code_PA:'Panama',area_code_PE:'Peru',area_code_PF:'French Polynesia',area_code_PG:'Papua New Guinea',area_code_PH:'Philippines',area_code_PK:'Pakistan',area_code_PL:'Poland',area_code_PM:'Saint Pierreand Miquelon',area_code_PR:'Puerto Rico',area_code_PT:'Portugal',area_code_PW:'Palau',area_code_PY:'Paraguay',area_code_QA:'Qatar',area_code_RE:'Réunion Island',area_code_RO:'Romania',area_code_RS:'Serbia',area_code_RU:'Russia',area_code_RW:'Rwanda',area_code_SA:'Saudi Arabia',area_code_SB:'Solomon Islands',area_code_SC:'Seychelles',area_code_SD:'Sudan',area_code_SE:'Sweden',area_code_SG:'Singapore',area_code_SI:'Slovenia',area_code_SK:'Slovakia',area_code_SL:'Sierra Leone',area_code_SM:'San Marino',area_code_SN:'Senegal',area_code_SO:'Somalia',area_code_SR:'Suriname',area_code_ST:'Sao Tome and Principe',area_code_SV:'ElSalvador',area_code_SY:'Syria',area_code_SZ:'Swaziland',area_code_TC:'Turksand Caicos Islands',area_code_TD:'Chad',area_code_TG:'Togo',area_code_TH:'Thailand',area_code_TJ:'Tajikistan',area_code_TL:'East Timor',area_code_TM:'Turkmenistan',area_code_TN:'Tunisia',area_code_TO:'Tonga',area_code_TR:'Turkey',area_code_TT:'Trinidadand Tobago',area_code_TW:'Taiwan',area_code_TZ:'Tanzania',area_code_UA:'Ukraine',area_code_UG:'Uganda',area_code_US:'United States',area_code_UY:'Uruguay',area_code_UZ:'Uzbekistan',area_code_VC:'Saint Vincent and The Grenadines',area_code_VE:'Venezuela',area_code_VG:'VirginIslands,British',area_code_VN:'Vietnam',area_code_VU:'Vanuatu',area_code_WS:'Samoa',area_code_YE:'Yemen',area_code_YT:'Mayotte',area_code_ZA:'South Africa',area_code_ZM:'Zambia',area_code_ZW:'Zimbabwe',main_user_format_err:"Username format is incorrect! Only use 4-16 digits of English letters, numbers, underscores!",main_email_format_err:"Email address format is incorrect!",main_phone_format_err:"Phone number format is incorrect!",main_vcode_format_err:"Verification code format is incorrect!",main_walletaddr_format_err:"Wallet address format is incorrect!",main_phone:"Phone",main_email:"Email",main_user:"UserName",register_title:"Register",register_inputphone:"Please input phone number",register_inputphone_err:"Please input phone number",register_inputemail:"Please input email address",register_inputemail_err:"Please input email address",register_inputUid:"Username",register_inputUid_err:"Please input username",register_inputCode:"Verification code",register_inputCode_err:"Please input verification code!",register_inputPass:"Password",register_inputPass_err:"Please input password",register_inputVpass:"Password again",register_inputVpass_err:"Please input password again",register_inputVpass_inputPass_err:"Inconsistent password!",register_getCodeSucc:"Verification code was successfully sent",register_getCode:"Get Code",register_getCodecount:"Retry(60)",register_getCodecountRetry:"Retry",register_exceed:"Please set your password within 32 letters",register_doLogin:"<<back",register_doRegister:"sign up",login_inputuser:"Username",login_inputuser_err:"Please input username",login_inputphone:"Phone number",login_inputphone_err:"Please input phone number",login_inputemail:"Email address",login_inputemail_err:"Please input email address",login_inputPass:"Password",login_inputPass_err:"Please input password",login_textForgetpass:"Forget Password?",login_doLogin:"Login",login_doRegister:"Register",login_walletDownloadFail:"Download failed , please log in again!",login_loginFail:"Login failed",forgetpass_title:"Find Password",forgetpass_inputphone:"Please input phone number",forgetpass_inputphone_err:"Please input phone number",forgetpass_inputemail:"Please input email address",forgetpass_inputemail_err:"Please input email address",forgetpass_inputUid:"Username",forgetpass_inputUid_err:"Please input username",forgetpass_inputUid_validate_err:"Invalid username",forgetpass_inputAccount:"Phone number / email",forgetpass_inputAccount_err:"Please input phone number / email address",forgetpass_inputAccount_err_type:"Incorrect phone number / email address,please try it again",forgetpass_inputAccount_validate_err:"Invalid phone number or email address",forgetpass_inputphone_notexist:"Please register first!",forgetpass_inputemail_notexist:"Please register first!",forgetpass_inputCode:"Verification code",forgetpass_inputCode_err:"Please input verification code!",forgetpass_inputPass:"New Password",forgetpass_inputPass_err:"New Please input password",forgetpass_inputVpass:"New Password again",forgetpass_inputVpass_err:"New Please input password again",forgetpass_inputVpass_inputPass_err:"Inconsistent password!",forgetpass_getCodeSucc:"Verification code was successfully sent",forgetpass_getCode:"Get Code",forgetpass_getCodecount:"Retry(60)",forgetpass_getCodecountRetry:"Retry",forgetpass_exceed:"Please set your password within 32 letters",forgetpass_doLogin:"<<back",forgetpass_do:"OK",forgetpass_do_ok:"Modified successfully, please login again",myInfo:"my information",myinfo_headImg:"Avatar",myinfo_nickname:"Nickname",myinfo_sex:"Gender",myinfo_sex_0:"Please choose",myinfo_sex_1:"Male",myinfo_sex_2:"Female",myinfo_uid:"Account",myinfo_area:"Area",modifyArea_empty:"Please choose",myinfo_security:"Security Center",myinfo_set:"Set",myinfo_logout:"Logout",myinfo_logoutConfirm:"Are you sure to log out?",modifyImg:"Head portrait",modifyImg_succ:"Head portrait modified successfully!",modifyImg_select:"Please choose local image",modifyImg_select_err:"Please choose local image",modifyImg_selectSize_err:"Image size must be less than 100Kb",modifyImg_selectType_err:"Image format must be jpg., jpge. or png",modifyName:"Nickname",modifyName_input:"Please input nickname",modifyName_succ:"Nickname modified successfully!",modifySex:"Gender",modifySex_succ:"Gender modified successfully!",modifyArea:"Area",modifyArea_succ:"Area modified successfully!",modifyNet:"Network line",modifyNet_succ:"Network line modified successfully!",modifyNet_node_err:"This network line is not available, please choose another line!",security_title:"Security Center",security_trust:" Trust contract",security_trust_admin:"Administration",security_walletOut:"Automatically log out",security_walletOut_admin:"Never",security_walletOut_admin_m:"%minutes% minute(s)",security_walletOut_admin_h:"%hours% hour(s)",security_walletOut_toast:"When the wallet is not operated for more than a certain period of time, it will be automatically logged out and the password needs to be re-inputted",trust_title:"Trust contract",trust_relieve_succ:"Successful contracts cancellation",paylist_txid:"Trading order number:",paylist_wallet:"My wallet:",paylist_nnc:"Contract address:",paylist_sbParamJson:"Contract parameters:",paylist_sbPushString:"Contract method:",paylist_sbPushString_none:"None",paylist_ctm_year:"%year% year(s) ago",paylist_ctm_month:"%month% month(s) ago",paylist_ctm_day:"%day% day(s) ago",paylist_ctm_hour:"%hour% hour(s) ago",paylist_ctm_minute:"%minute% minute(s) ago",paylist_ctm_recent:"Just now",paylist_noMore:"No more records",paylist_getMore:"Click to load more records",paylist_noRecord:"No record",pay_received:"Receive",pc_receivables_download:"Download QR Code",pc_receivables_address:"Wallet address",pc_receivables_copy:"Copy success",pay_transfer:"SEND",pay_transferType:"Token：GAS",pay_transferBalance:"Balance:",pay_transferToAddr:"Address",pay_transferCount:"Amounts",pay_transferToAddrError:"The SEND address is incorrect!",pay_transferCountError:"The number of SEND is incorrect!",pay_transferDoSucc:"SEND success",pay_transferDoFail:"SEND failed!",pay_transferGasNotEnough:"GAS balance is insufficient!",pay_wallet:"My Wallet",pay_refresh:"Refresh",pay_wallet_detail:"Details",pay_coin_name:"Token",pay_coin_old:"SGAS(old)Exchange",pay_gas:"GAS",pay_gas_desc:"GAS is a digital currency on NEO chain that can be obtained through exchanges",pay_sgas:"SGAS",pay_sgas_desc:"SGAS is a universal chip that Bla Cat offers to players.",pay_send:"SEND",pay_purchase:"Purchase",pay_purchase_testnet_cant_buy:"Please switch Mainnet to buy GAS!",pay_makeMint:"Exchange",pay_recentLists:"Recent records",pay_makeMintGasNotEnough:"GAS balance is insufficient",pay_makeMintDoFail:"Recharge SGAS failed!\r\n Recharge contract execution failed!\r\nPlease wait for the last recharge confirmation before proceeding!",pay_makeMintDoFail2:"Recharge SGAS failed! \r\nFailed to send recharge request! Please check network and try again later!",pay_makeRefundSgasNotEnoughUtxo:"SGAS兑换繁忙，请稍后重试！",pay_makeRefundSgasNotEnough:"SGAS balance is insufficient",pay_makeRefundGasFeeNotEnough:"GAS余额不足，无法支付手续费！",pay_makeRefundDoFail:"The extraction contract execution failed! Please wait for the last withdrawal or redemption transaction to complete!",pay_makeRefundDoFail2:"Sending an extraction transaction failed! Please check network and try again later!",pay_makeRefundGetScriptFail:"Getting extraction contract failed!",pay_makeRefundSgasOldNotEnough:"SGAS(old) balance is insufficient",pay_not_enough_money:"Insufficient balance",pay_not_enough_utxo:"Please wait for the last transaction to complete before executing!",pay_nettype_1:"Mainnet",pay_nettype_2:"Testnet",pay_walletDetail:"Wallet details",pay_walletDetail_addr:"Address:",pay_walletDetail_key:"Public Key:",pay_walletDetail_hex:"KEY HEX:",pay_walletDetail_wif:"KEY WIF:",pay_walletDetail_notice:"To avoid property damage, please prevent leakage when you open the key.",pay_walletDetail_export:"Export wallet",pay_makerawtrans_err:"Transaction failed!",addressbook_title:"Mail list",addressbook_search:"Search",addressbook_det_title:"Mail list",addressbook_det_transfer:"Transfer",addressbook_det_address:"Wallet address",addressbook_det_download:"Download QR Code",addressbook_det_describe:"Describe",addressbook_det_empty:"Empty",addressbook_det_del:"Delete Contact",addressbook_det_del_title:"Delete",addressbook_det_del_tips:"Confirm to delete this contact?",addressbook_det_del_succ:"Delete success",addressbook_op_button:"Complete",addressbook_op_name:"Contacts",addressbook_op_inputName:"Please input Contacts",addressbook_op_inputName_err:"Please input Contacts",addressbook_op_address:"Wallet address",addressbook_op_inputAddress:"Please input wallet address",addressbook_op_inputAddress_err:"Please input wallet address",addressbook_op_describe:"Describe",addressbook_op_inputDescribe:"Please input Describe",addressbook_op_inputDescribe_err:"Please input Describe",addressbook_op_addSucc:"Contact added success",addressbook_op_updateSucc:"Contact modify success",pay_exchange_gas:"Exchange GAS",pay_exchange_purchase:"Purchase",pay_exchange_price:"Latest price",pay_exchange_range:"24H Range",pay_makeRecharge:"Recharge",pay_trust_tips:"Trust contracts",pay_trust_Vice_tips:"(no longer pops out)",pay_transferGas_toaddr:"transfer address",pay_transferGas_count:"Transfer amounts",pay_transCount_count:"Exchange",pay_transCount_inputCount:"Please input amount",pay_transCount_err:"Please input correct sums of amounts",pay_transCountSGAS2GAS:"GAS",pay_transCountGAS2SGAS:"SGAS",pay_transCountSGASOLD2OLD:"SGAS(old)",pay_transCountTips_free:"Free",pay_transCountTips_slow:"Slow",pay_transCountTips_fast:"Fast",pay_transCount_speed:"Trade SPD",pay_transCount_cost:"Fee：",pay_transCount_tips:"Choose the token you want to exchange",pay_transCount_tips_err:"Choose the token you want to exchange",pay_walletOpen_password:"password",pay_walletOpen_inputPassword:"wallet password",pay_walletOpen_inputPassword_err:"Please enter the wallet password",pay_walletOpen_file_error:"Wallet file parsing is abnormal, please log in again",pay_walletOpen_openFail:"Fail to open wallet!Please try it again!",walletCreate_create:"Create a wallet",walletCreate_password:"enter password",walletCreate_vpass:"confirm password",walletCreate_password_notice:"*Password can not be retrieved. Please keep it carefully.",walletCreate_doCreate:"Create",walletCreate_check_pass:"Please check the input password",walletCreate_check_vpass:"Please check the confirmation password",walletCreate_check_exceed:"Please set your password within 32 letters",walletImport_invalid_file:"Please select a valid wallet file",walletImport_select_file:"Please select the wallet file",walletImport_import:"Import wallet",walletImport_password:"Please enter the password",walletImport_doImport:"Bind wallet",walletImport_bind_succ:"Bind the wallet successfully!",walletView_info:"Do a game different and fun!",walletView_create:"Create Wallet",walletView_import:"Import Wallet",main_wait_for_last_tran:"Please confirm or cancel the previous transaction request and then execute",main_no_app_wallet:"The app does not have a billing wallet address configured and cannot be recharged.",main_need_open_wallet_confirm:"The withdrawal operation needs to open the wallet, is it open immediately? ",main_refund_second_fail:"Generate conversion request (utxo->gas) failed",main_refund_getScript_err:"Failed to get conversion contract!",main_refund_sendRequest_err:"Sending a conversion request failed!",main_refund_doFail:"Conversion contract execution failed!",errCode_1101:"Request interface parameter error",errCode_1005:"You visit too often, please take a break!",errCode_100601:"Failed to get SMS verification code! Please check your country and mobile number!",errCode_100602:"Incorrect verification code!",errCode_100605:"This phone number has been registered!",errCode_100606:"Please register first",errCode_100607:"Wrong username or telephone number!",errCode_100608:"Wrong phone number or password!",errCode_100700:"Incorrect account or password!",errCode_100701:"Login is invalid, please log in again",errCode_100702:"Incorrect account or password,please try it again",errCode_100707:"Username already existed!",errCode_100708:"Username format is incorrect!",errCode_100709:"Area code is incorrect!",errCode_100801:"Failed to get email verification code!",errcode_100802:"Incorrect verification code!",errCode_100805:"This email address has been registered!",errCode_100806:"Please register first",errCode_100807:"Wrong username or email address!",errCode_100808:"Wrong email address or password!",errCode_8100000:"Your have already bundled my wallet and don't need to bind again!",errCode_8100001:"The format of the uploaded wallet is incorrect. Please check the wallet file!",errCode_8100002:"System error, wallet binding failed!",errCode_8100003:"The wallet has been bound by other users!",errCode_8100004:"Incorrect format!",errcode_8100005:"Upload failed!",errcode_8100006:"Image size must be less than 100Kb.",errCode_8100007:"The contact already exists!",errCode_default:"Unknown error! Error code: %errCode%",wallet_open_check:"Please check your wallet file or password!",wallet_open_check_otcgo:"Please check the Otcgo wallet file!",wallet_open_check_otcgo_pwd:"Please check the Otcgo wallet password!",netmgr_select_api_slow:"Connection to the server is abnormal or slow, please check the network and try it again!",netmgr_select_node_slow:"Communication with the nodes on the chain is abnormal or slow, please check the network and try it later!",netmgr_select_cli_slow:"Communication with the nodes on the chain is abnormal, please check the network and try it later!",netmgr_connecting:"Connecting ...",netmgr_connecting_fail:"Connection failed. Please check the network and try it again!"};return _this15;}return LangEN;}(BlackCat.LangBase);BlackCat.LangEN=LangEN;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var LangMgr=function(){function LangMgr(){var type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";_classCallCheck(this,LangMgr);}_createClass(LangMgr,[{key:'setType',value:function setType(type){console.log("[BlaCat]",'[LangMgr]','setType, type => ',type,', this.type => ',this.type);if(this.type==type){return false;}switch(type){case"en":this.lang=new BlackCat.LangEN();this.type=type;break;default:this.lang=new BlackCat.LangCN();this.type="cn";break;}return true;}},{key:'get',value:function get(key){var ext=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var src=this.lang.get(key);if(ext){for(var k in ext){var rk='%'+k+'%';src=src.replace(rk,ext[k]);}}return src;}}]);return LangMgr;}();BlackCat.LangMgr=LangMgr;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var Connector=function(){function Connector(hosts,check_params){var check_type=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";_classCallCheck(this,Connector);this.hosts=hosts;this.check_params=check_params;this.check_type=check_type;this.fetch_error=[];}_createClass(Connector,[{key:'getOne',value:function getOne(callback){var _this16=this;try{this.hosts.forEach(function(host){var url_head=host.substr(0,2)==="//"?BlackCat.Main.urlHead:"";var url=url_head+host+_this16.check_params;fetch(url).then(function(response){return __awaiter(_this16,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee40(){var json,res;return regeneratorRuntime.wrap(function _callee40$(_context40){while(1){switch(_context40.prev=_context40.next){case 0:if(!response.ok){_context40.next=26;break;}_context40.t0=this.check_type;_context40.next=_context40.t0==="node"?4:_context40.t0==="cli"?4:_context40.t0==="api"?19:19;break;case 4:_context40.prev=4;_context40.next=7;return response.json();case 7:json=_context40.sent;if(!json["result"][0]["blockcount"]){_context40.next=13;break;}if(this.first_host){_context40.next=13;break;}this.first_host=url_head+host;callback(this.first_host,json);return _context40.abrupt('return');case 13:_context40.next=17;break;case 15:_context40.prev=15;_context40.t1=_context40['catch'](4);case 17:this.fetch_error.push(host);return _context40.abrupt('return');case 19:_context40.next=21;return response.text();case 21:res=_context40.sent;if(!this.first_host){this.first_host=url_head+host;callback(this.first_host,res);}return _context40.abrupt('return');case 24:_context40.next=27;break;case 26:this.fetch_error.push(host);case 27:case'end':return _context40.stop();}}},_callee40,this,[[4,15]]);}));},function(error){_this16.fetch_error.push(host);console.log("[BlaCat]",'[Connector]','getOne, fetch err => ',error);});});}catch(e){console.log("[BlaCat]",'[Connector]','getOne, error => ',e.toString());}this.check_results(callback);}},{key:'check_results',value:function check_results(callback){var _this17=this;console.log("[BlaCat]",'[Connector]','do check_results ...');setTimeout(function(){if(!_this17.first_host){if(_this17.fetch_error.length==_this17.hosts.length){console.log("[BlaCat]",'[Connector]','check_results, all fetch_error => ',_this17.fetch_error);callback(false,null);}else{_this17.check_results(callback);}}},500);}}]);return Connector;}();BlackCat.Connector=Connector;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var NetMgr=function(){function NetMgr(){_classCallCheck(this,NetMgr);this.types=[1,2];this.apis=[["CN","https://api00.9191wyx.com/apic_v2/"]];this.nodes={};this.nodes[1]=[["CN","https://api.nel.group/api/mainnet","_1"],["CN","https://nelnode01.9191wyx.com/api/mainnet","_2"],["HK","https://nelnode01.blacat.org/api/mainnet"]];this.nodes[2]=[["CN","https://api.nel.group/api/testnet","_1"],["CN","https://nelnode00.9191wyx.com/api/testnet","_2"],["HK","https://nelnode00.blacat.org/api/testnet"]];this.clis={};this.clis[1]=[["CN",'https://clip01.9191wyx.com/api/mainnet'],["HK",'https://neocli01.blacat.org/api/mainnet']];this.clis[2]=[];this.nodes_server={};this.default_type=1;this.clis_server={};}_createClass(NetMgr,[{key:'selectApi',value:function selectApi(callback){var _this18=this;if(this.apis_server){BlackCat.ApiTool.base_url=this.apis_server;callback();return;}BlackCat.Main.viewMgr.change("ViewConnecting");BlackCat.ViewConnecting.callback_retry=function(){_this18._selectApi(callback);};this._selectApi(callback);}},{key:'_selectApi',value:function _selectApi(callback){var _this19=this;BlackCat.Main.viewMgr.viewConnecting.showConnecting();BlackCat.Main.viewMgr.iconView.showState();var conn=new BlackCat.Connector(this.getHosts(this.apis),"apic_test.php",'api');conn.getOne(function(res,response){if(res===false){BlackCat.ViewConnecting.content="netmgr_select_api_slow";BlackCat.Main.viewMgr.viewConnecting.showRetry(false);BlackCat.Main.viewMgr.iconView.hiddenState();if(BlackCat.Main.isLoginInit()===true)BlackCat.Main.viewMgr.iconView.showFail();return;}console.log("[BlaCat]",'[NetMgr]','api => ',res);console.log("[BlaCat]",'[NetMgr]','api response => ',response);_this19.apis_server=res+"apic_user.php";BlackCat.ApiTool.base_url=_this19.apis_server;callback();});}},{key:'selectNode',value:function selectNode(callback,type){var _this20=this;var force=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;if(force==0&&this.nodes_server&&this.nodes_server.hasOwnProperty(type)&&this.nodes_server[type]){this.node_change_tmp=this.nodes_server[type];this.selectCli(callback,type,force);return;}BlackCat.Main.viewMgr.change("ViewConnecting");BlackCat.ViewConnecting.callback_retry=function(){_this20._selectNode(callback,type,force);};this._selectNode(callback,type,force);}},{key:'_selectNode',value:function _selectNode(callback,type,force){var _this21=this;BlackCat.Main.viewMgr.viewConnecting.showConnecting();BlackCat.Main.viewMgr.iconView.showState();var conn=new BlackCat.Connector(this.getHosts(this.nodes[type]),"?jsonrpc=2.0&id=1&method=getblockcount&params=[]",'node');conn.getOne(function(res,response){if(res===false){BlackCat.ViewConnecting.content="netmgr_select_node_slow";var showReturn=!BlackCat.Main.isLoginInit();BlackCat.Main.viewMgr.viewConnecting.showRetry(showReturn);BlackCat.Main.viewMgr.iconView.hiddenState();if(BlackCat.Main.isLoginInit()===true)BlackCat.Main.viewMgr.iconView.showFail();return;}console.log("[BlaCat]",'[NetMgr]','node => ',res);console.log("[BlaCat]",'[NetMgr]','node response => ',response);_this21.node_change_tmp=res;_this21.selectCli(callback,type,force);});}},{key:'selectCli',value:function selectCli(callback,type){var _this22=this;var force=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;if(!this.clis||!this.clis[type]||this.clis[type].length==0){this.nodes_server[type]=this.node_change_tmp;BlackCat.tools.WWW.api_nodes=this.nodes_server[type];this.clis_server[type]=null;BlackCat.tools.WWW.api_clis=null;callback();if(BlackCat.Main.viewMgr.viewConnecting.isCreated)BlackCat.Main.viewMgr.viewConnecting.remove();BlackCat.Main.viewMgr.iconView.hiddenState();BlackCat.Main.viewMgr.iconView.showSucc();return;}if(force==0&&this.clis_server&&this.clis_server.hasOwnProperty(type)&&this.clis_server[type]){this.nodes_server[type]=this.node_change_tmp;BlackCat.tools.WWW.api_nodes=this.nodes_server[type];BlackCat.tools.WWW.api_clis=this.clis_server[type];callback();if(BlackCat.Main.viewMgr.viewConnecting.isCreated)BlackCat.Main.viewMgr.viewConnecting.remove();BlackCat.Main.viewMgr.iconView.hiddenState();BlackCat.Main.viewMgr.iconView.showSucc();return;}BlackCat.Main.viewMgr.change("ViewConnecting");BlackCat.ViewConnecting.callback_retry=function(){_this22._selectCli(callback,type);};this._selectCli(callback,type);}},{key:'_selectCli',value:function _selectCli(callback,type){var _this23=this;BlackCat.Main.viewMgr.viewConnecting.showConnecting();BlackCat.Main.viewMgr.iconView.showState();var conn=new BlackCat.Connector(this.getHosts(this.clis[type]),"?jsonrpc=2.0&id=1&method=getblockcount&params=[]&uid="+BlackCat.Main.randNumber,'cli');conn.getOne(function(res,response){if(res===false){BlackCat.ViewConnecting.content="netmgr_select_cli_slow";var showReturn=!BlackCat.Main.isLoginInit();BlackCat.Main.viewMgr.viewConnecting.showRetry(showReturn);BlackCat.Main.viewMgr.iconView.hiddenState();if(BlackCat.Main.isLoginInit()===true)BlackCat.Main.viewMgr.iconView.showFail();return;}console.log("[BlaCat]",'[NetMgr]','cli => ',res);console.log("[BlaCat]",'[NetMgr]','cli response => ',response);_this23.nodes_server[type]=_this23.node_change_tmp;BlackCat.tools.WWW.api_nodes=_this23.nodes_server[type];_this23.clis_server[type]=res;BlackCat.tools.WWW.api_clis=_this23.clis_server[type];callback();if(BlackCat.Main.viewMgr.viewConnecting.isCreated)BlackCat.Main.viewMgr.viewConnecting.remove();BlackCat.Main.viewMgr.iconView.hiddenState();BlackCat.Main.viewMgr.iconView.showSucc();});}},{key:'change',value:function change(callback){var type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!type){type=this.default_type;}if(this.type!=type){console.log("[BlaCat]",'[NetType]',' change to type => ',type);switch(type){case 1:this.change2Main(callback);break;case 2:this.change2test(callback);break;}}}},{key:'setDefault',value:function setDefault(type){console.log("[BlaCat]",'[NetType]',' default type => ',type);this.default_type=type;}},{key:'change2test',value:function change2test(callback){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee41(){var _this24=this;return regeneratorRuntime.wrap(function _callee41$(_context41){while(1){switch(_context41.prev=_context41.next){case 0:this.selectNode(function(){_this24.type=2;BlackCat.tools.CoinTool.id_SGAS="0x3ced6d32ed9ebcc634af5bf94f2435ea9fe13640";BlackCat.tools.CoinTool.id_SGAS_OLD=["0x961e628cc93d61bf636dc0443cf0548947a50dbe"];callback();},2);case 1:case'end':return _context41.stop();}}},_callee41,this);}));}},{key:'change2Main',value:function change2Main(callback){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee42(){var _this25=this;return regeneratorRuntime.wrap(function _callee42$(_context42){while(1){switch(_context42.prev=_context42.next){case 0:this.selectNode(function(){_this25.type=1;BlackCat.tools.CoinTool.id_SGAS="0x961e628cc93d61bf636dc0443cf0548947a50dbe";BlackCat.tools.CoinTool.id_SGAS_OLD=[];callback();},1);case 1:case'end':return _context42.stop();}}},_callee42,this);}));}},{key:'getOtherTypes',value:function getOtherTypes(){var res=new Array();for(var k=0;k<this.types.length;k++){if(this.types[k]!==this.type){res.push(this.types[k]);}}return res;}},{key:'getHosts',value:function getHosts(hosts){var res=[];hosts.forEach(function(host){res.push(host[1]);});return res;}},{key:'getCurrNodeInfo',value:function getCurrNodeInfo(type){var info=null;if(this[type][this.type].length>0){for(var i=0;i<this[type][this.type].length;i++){if(this[type][this.type][i][1]==this[type+"_server"][this.type]){return this[type][this.type][i];}}}return info;}},{key:'getNodeLists',value:function getNodeLists(type){var lists=[];if(this[type]&&this[type][this.type]){return this[type][this.type];}return lists;}},{key:'setNode',value:function setNode(type,url){this[type+"_server"][this.type]=url;BlackCat.tools.WWW["api_"+type]=url;}}]);return NetMgr;}();BlackCat.NetMgr=NetMgr;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ViewBase=function(){function ViewBase(){_classCallCheck(this,ViewBase);this.isCreated=false;this.reset();}_createClass(ViewBase,[{key:'create',value:function create(){}},{key:'toRefer',value:function toRefer(){}},{key:'reset',value:function reset(){{}}},{key:'start',value:function start(){if(this.isCreated===false){this.create();this.isCreated=true;this.parentAdd(this.div);}this.show();}},{key:'remove',value:function remove(){var _this26=this;var timeout=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var fadeClass=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"pc_fadeindown";if(this.s_timeout_remove){return;}if(timeout){if(fadeClass)this.div.classList.add("pc_fadeindown");this.s_timeout_remove=setTimeout(function(){_this26._remove();},timeout);}else{this._remove();}}},{key:'_remove',value:function _remove(){this.s_timeout_remove=null;this.parentRemove(this.div);this.isCreated=false;this.reset();}},{key:'return',value:function _return(){var timeout=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;this.remove(timeout);this.toRefer();}},{key:'hidden',value:function hidden(){this.div.style.display="none";}},{key:'show',value:function show(){this.div.style.display="";}},{key:'isHidden',value:function isHidden(){if(this.div&&this.div.style.display=="none"){return true;}return false;}},{key:'update',value:function update(){this.parentRemove(this.div);this.create();this.parentAdd(this.div);}},{key:'objCreate',value:function objCreate(tag){var addElement=document.createElement(tag);return addElement;}},{key:'ObjAppend',value:function ObjAppend(o,tag){o.appendChild(tag);}},{key:'objRemove',value:function objRemove(o,tag){o.removeChild(tag);}},{key:'parentAdd',value:function parentAdd(tag){this.ObjAppend(BlackCat.Main.viewMgr.mainView.div,tag);}},{key:'parentRemove',value:function parentRemove(tag){this.objRemove(BlackCat.Main.viewMgr.mainView.div,tag);}},{key:'bodyAppend',value:function bodyAppend(tag){document.body.appendChild(tag);}},{key:'bodyRemove',value:function bodyRemove(tag){document.body.removeChild(tag);}}]);return ViewBase;}();BlackCat.ViewBase=ViewBase;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var AddressbookDetailsView=function(_BlackCat$ViewBase){_inherits(AddressbookDetailsView,_BlackCat$ViewBase);function AddressbookDetailsView(){_classCallCheck(this,AddressbookDetailsView);var _this27=_possibleConstructorReturn(this,(AddressbookDetailsView.__proto__||Object.getPrototypeOf(AddressbookDetailsView)).call(this));if(!AddressbookDetailsView.contact){AddressbookDetailsView.contact=new BlackCat.contact();}return _this27;}_createClass(AddressbookDetailsView,[{key:'create',value:function create(){var _this28=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_maillist_details");var header=this.objCreate("div");header.classList.add("pc_header");this.ObjAppend(this.div,header);var headerReturn=this.objCreate("a");headerReturn.classList.add("iconfont","icon-fanhui");headerReturn.textContent=BlackCat.Main.langMgr.get("return");headerReturn.onclick=function(){_this28.return();};this.ObjAppend(header,headerReturn);var headerTitle=this.objCreate("h1");headerTitle.textContent=BlackCat.Main.langMgr.get("addressbook_det_title");this.ObjAppend(header,headerTitle);var iHeader=this.objCreate("i");iHeader.classList.add("pc_returngame","iconfont","icon-qianbi");iHeader.onclick=function(){_this28.hidden();BlackCat.AddressbookOpView.refer="AddressbookDetailsView";BlackCat.AddressbookOpView.contact=AddressbookDetailsView.contact;BlackCat.AddressbookOpView.opType="update";BlackCat.Main.viewMgr.change("AddressbookOpView");};this.ObjAppend(header,iHeader);var divObj=this.objCreate("div");divObj.classList.add("pc_addressbookdet");this.ObjAppend(this.div,divObj);var divName=this.objCreate("div");divName.classList.add("pc_addressbookname");divName.textContent=AddressbookDetailsView.contact.address_name;this.ObjAppend(divObj,divName);var divAddressTitle=this.objCreate("div");divAddressTitle.classList.add("pc_addresstitle");this.ObjAppend(divObj,divAddressTitle);var labelAddressTitle=this.objCreate("label");labelAddressTitle.textContent=BlackCat.Main.langMgr.get("addressbook_det_address");this.ObjAppend(divAddressTitle,labelAddressTitle);var butCopy=this.objCreate("button");butCopy.textContent=BlackCat.Main.langMgr.get("copy");butCopy.onclick=function(){var inputCooy=_this28.objCreate("input");inputCooy.value=_this28.divAddress.innerText;_this28.ObjAppend(divObj,inputCooy);inputCooy.select();document.execCommand("Copy");inputCooy.remove();BlackCat.Main.showToast("pc_receivables_copy",1500);};this.ObjAppend(divAddressTitle,butCopy);var butMakeTransfer=this.objCreate("button");butMakeTransfer.textContent=BlackCat.Main.langMgr.get("addressbook_det_transfer");butMakeTransfer.onclick=function(){_this28.doMakeTransfer();};this.ObjAppend(divAddressTitle,butMakeTransfer);this.divAddress=this.objCreate("div");this.divAddress.classList.add("pc_receivables");this.divAddress.textContent=AddressbookDetailsView.contact.address_wallet;this.ObjAppend(divObj,this.divAddress);var divQRCode=this.objCreate("div");divQRCode.classList.add("pc_qrcode");this.ObjAppend(divObj,divQRCode);var qrObj=this.objCreate("img");QrCodeWithLogo.toImage({image:qrObj,content:AddressbookDetailsView.contact.address_wallet}).then(function(){var url=URL.createObjectURL(_this28.base64ToBlob(qrObj.src));qr_download.setAttribute('href',url);qr_download.setAttribute("download",AddressbookDetailsView.contact.address_wallet+".png");});this.ObjAppend(divQRCode,qrObj);var qr_download=this.objCreate("a");qr_download.classList.add("iconfont","icon-xiazai");qr_download.textContent=BlackCat.Main.langMgr.get("addressbook_det_download");this.ObjAppend(divQRCode,qr_download);var divDescribeTitle=this.objCreate("div");divDescribeTitle.classList.add("pc_addresstitle");divDescribeTitle.textContent=BlackCat.Main.langMgr.get("addressbook_det_describe");this.ObjAppend(divObj,divDescribeTitle);var divDescribeText=this.objCreate("div");divDescribeText.classList.add("pc_describetext");divDescribeText.textContent=AddressbookDetailsView.contact.address_desc?AddressbookDetailsView.contact.address_desc:BlackCat.Main.langMgr.get("addressbook_det_empty");this.ObjAppend(divObj,divDescribeText);var btnDel=this.objCreate("button");btnDel.classList.add("pc_addressbookdel");btnDel.textContent=BlackCat.Main.langMgr.get("addressbook_det_del");btnDel.onclick=function(){_this28.dodel();};this.ObjAppend(divObj,btnDel);}},{key:'toRefer',value:function toRefer(){if(AddressbookDetailsView.refer){BlackCat.Main.viewMgr.change(AddressbookDetailsView.refer);AddressbookDetailsView.refer=null;}}},{key:'dodel',value:function dodel(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee43(){var _this29=this;return regeneratorRuntime.wrap(function _callee43$(_context43){while(1){switch(_context43.prev=_context43.next){case 0:BlackCat.ViewConfirm.callback=function(){_this29.makedel();};BlackCat.Main.showConFirm("addressbook_det_del_tips");case 2:case'end':return _context43.stop();}}},_callee43,this);}));}},{key:'makedel',value:function makedel(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee44(){var res;return regeneratorRuntime.wrap(function _callee44$(_context44){while(1){switch(_context44.prev=_context44.next){case 0:_context44.next=2;return BlackCat.ApiTool.delAddrbook(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,AddressbookDetailsView.contact.id);case 2:res=_context44.sent;if(res.r){BlackCat.Main.showToast("addressbook_det_del_succ");this.return();BlackCat.Main.viewMgr.addressbookView.getAddressbook();}else{BlackCat.Main.showErrCode(res.errCode);}case 4:case'end':return _context44.stop();}}},_callee44,this);}));}},{key:'doMakeTransfer',value:function doMakeTransfer(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee45(){var _this30=this;return regeneratorRuntime.wrap(function _callee45$(_context45){while(1){switch(_context45.prev=_context45.next){case 0:if(BlackCat.Main.isWalletOpen()){BlackCat.PayTransferView.callback=function(){BlackCat.Main.viewMgr.payView.doGetWalletLists(1);};BlackCat.PayTransferView.address=AddressbookDetailsView.contact.address_wallet;BlackCat.Main.viewMgr.change("PayTransferView");}else{BlackCat.ViewWalletOpen.callback=function(){_this30.doMakeTransfer();};BlackCat.Main.viewMgr.change("ViewWalletOpen");}case 1:case'end':return _context45.stop();}}},_callee45,this);}));}},{key:'base64ToBlob',value:function base64ToBlob(code){var parts=code.split(';base64,');var contentType=parts[0].split(':')[1];var raw=window.atob(parts[1]);var rawLength=raw.length;var uInt8Array=new Uint8Array(rawLength);for(var i=0;i<rawLength;++i){uInt8Array[i]=raw.charCodeAt(i);}return new Blob([uInt8Array],{type:contentType});}}]);return AddressbookDetailsView;}(BlackCat.ViewBase);BlackCat.AddressbookDetailsView=AddressbookDetailsView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var AddressbookOpView=function(_BlackCat$ViewBase2){_inherits(AddressbookOpView,_BlackCat$ViewBase2);function AddressbookOpView(){_classCallCheck(this,AddressbookOpView);var _this31=_possibleConstructorReturn(this,(AddressbookOpView.__proto__||Object.getPrototypeOf(AddressbookOpView)).call(this));if(!AddressbookOpView.contact){AddressbookOpView.contact=new BlackCat.contact();}return _this31;}_createClass(AddressbookOpView,[{key:'start',value:function start(){_get(AddressbookOpView.prototype.__proto__||Object.getPrototypeOf(AddressbookOpView.prototype),'start',this).call(this);this.inputName.focus();if(AddressbookOpView.opType=="add"){this.inputName.value="";this.textAddress.value="";this.textDescribe.value="";}}},{key:'create',value:function create(){var _this32=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_maillist_op");var header=this.objCreate("div");header.classList.add("pc_header");this.ObjAppend(this.div,header);var headerReturn=this.objCreate("a");headerReturn.classList.add("iconfont","icon-fanhui");headerReturn.textContent=BlackCat.Main.langMgr.get("return");headerReturn.onclick=function(){_this32.return();};this.ObjAppend(header,headerReturn);var butHeader=this.objCreate("button");butHeader.classList.add("pc_returngame");butHeader.textContent=BlackCat.Main.langMgr.get("addressbook_op_button");butHeader.onclick=function(){_this32.doFinished();};this.ObjAppend(header,butHeader);var divform=this.objCreate("div");divform.classList.add("pc_addressbookop");this.ObjAppend(this.div,divform);var divNameBox=this.objCreate("div");this.ObjAppend(divform,divNameBox);var labelName=this.objCreate("label");labelName.textContent=BlackCat.Main.langMgr.get("addressbook_op_name");this.ObjAppend(divNameBox,labelName);this.inputName=this.objCreate("input");this.inputName.placeholder=BlackCat.Main.langMgr.get("addressbook_op_inputName");this.inputName.value=AddressbookOpView.contact.address_name;this.ObjAppend(divNameBox,this.inputName);var divAddressBox=this.objCreate("div");this.ObjAppend(divform,divAddressBox);var labelAddress=this.objCreate("label");labelAddress.textContent=BlackCat.Main.langMgr.get("addressbook_op_address");this.ObjAppend(divAddressBox,labelAddress);this.textAddress=this.objCreate("textarea");this.textAddress.placeholder=BlackCat.Main.langMgr.get("addressbook_op_inputAddress");this.textAddress.value=AddressbookOpView.contact.address_wallet;this.ObjAppend(divAddressBox,this.textAddress);var iAddress=this.objCreate("i");iAddress.classList.add("iconfont","icon-saomiao");this.ObjAppend(divAddressBox,iAddress);var divDescribeBox=this.objCreate("div");this.ObjAppend(divform,divDescribeBox);var labelDescribe=this.objCreate("label");labelDescribe.textContent=BlackCat.Main.langMgr.get("addressbook_op_describe");this.ObjAppend(divDescribeBox,labelDescribe);this.textDescribe=this.objCreate("textarea");this.textDescribe.placeholder=BlackCat.Main.langMgr.get("addressbook_op_inputDescribe");this.textDescribe.value=AddressbookOpView.contact.address_desc;this.ObjAppend(divDescribeBox,this.textDescribe);}},{key:'toRefer',value:function toRefer(){if(AddressbookOpView.refer){BlackCat.Main.viewMgr.change(AddressbookOpView.refer);AddressbookOpView.refer=null;}}},{key:'doFinished',value:function doFinished(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee46(){var _this33=this;var wallet_res,res;return regeneratorRuntime.wrap(function _callee46$(_context46){while(1){switch(_context46.prev=_context46.next){case 0:if(this.inputName.value){_context46.next=3;break;}BlackCat.Main.showErrMsg("addressbook_op_inputName_err",function(){_this33.inputName.focus();});return _context46.abrupt('return');case 3:if(this.textAddress.value){_context46.next=6;break;}BlackCat.Main.showErrMsg("addressbook_op_inputAddress_err",function(){_this33.textAddress.focus();});return _context46.abrupt('return');case 6:_context46.next=8;return BlackCat.Main.validateFormat("walletaddr",this.textAddress);case 8:wallet_res=_context46.sent;if(!(wallet_res===false)){_context46.next=11;break;}return _context46.abrupt('return');case 11:if(!(AddressbookOpView.opType=="add")){_context46.next=18;break;}_context46.next=14;return BlackCat.ApiTool.addAddrbook(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,this.inputName.value,this.textAddress.value,this.textDescribe.value);case 14:res=_context46.sent;if(res.r){this.return();BlackCat.Main.showToast("addressbook_op_addSucc");BlackCat.Main.viewMgr.addressbookView.getAddressbook();}else{BlackCat.Main.showErrCode(res.errCode);}_context46.next=23;break;case 18:if(!(AddressbookOpView.opType=="update")){_context46.next=23;break;}_context46.next=21;return BlackCat.ApiTool.updateAddrbook(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,this.inputName.value,this.textAddress.value,this.textDescribe.value,AddressbookOpView.contact.id);case 21:res=_context46.sent;if(res.r){AddressbookOpView.contact.address_name=this.inputName.value;AddressbookOpView.contact.address_wallet=this.textAddress.value;AddressbookOpView.contact.address_desc=this.textDescribe.value;BlackCat.AddressbookDetailsView.contact=AddressbookOpView.contact;BlackCat.Main.showToast("addressbook_op_updateSucc");BlackCat.Main.viewMgr.addressbookDetailsView.update();this.return();BlackCat.Main.viewMgr.addressbookView.getAddressbook();}else{BlackCat.Main.showErrCode(res.errCode);}case 23:case'end':return _context46.stop();}}},_callee46,this);}));}}]);return AddressbookOpView;}(BlackCat.ViewBase);BlackCat.AddressbookOpView=AddressbookOpView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var AddressbookView=function(_BlackCat$ViewBase3){_inherits(AddressbookView,_BlackCat$ViewBase3);function AddressbookView(){_classCallCheck(this,AddressbookView);return _possibleConstructorReturn(this,(AddressbookView.__proto__||Object.getPrototypeOf(AddressbookView)).apply(this,arguments));}_createClass(AddressbookView,[{key:'reset',value:function reset(){this.addressbook={};}},{key:'create',value:function create(){var _this35=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj");var header=this.objCreate("div");header.classList.add("pc_header");this.ObjAppend(this.div,header);var headerReturn=this.objCreate("a");headerReturn.classList.add("iconfont","icon-fanhui");headerReturn.textContent=BlackCat.Main.langMgr.get("return");headerReturn.onclick=function(){if(AddressbookView.select){_this35.remove();BlackCat.Main.viewMgr.payView.show();BlackCat.Main.viewMgr.payTransferView.show();}else{_this35.return();}};this.ObjAppend(header,headerReturn);var headerTitle=this.objCreate("h1");headerTitle.textContent=BlackCat.Main.langMgr.get("addressbook_title");this.ObjAppend(header,headerTitle);var iHeader=this.objCreate("i");iHeader.classList.add("pc_returngame","iconfont","icon-jiahao");iHeader.onclick=function(){_this35.hidden();BlackCat.AddressbookOpView.refer="AddressbookView";BlackCat.AddressbookOpView.opType="add";BlackCat.Main.viewMgr.change("AddressbookOpView");};this.ObjAppend(headerTitle,iHeader);var divSearch=this.objCreate("div");divSearch.classList.add("pc_search");this.ObjAppend(this.div,divSearch);var iSearch=this.objCreate("i");iSearch.classList.add("iconfont","icon-sousuo");this.ObjAppend(divSearch,iSearch);this.inputSearch=this.objCreate("input");this.inputSearch.placeholder=BlackCat.Main.langMgr.get("addressbook_search");this.inputSearch.onkeyup=function(){_this35.searchAddressbook();};this.ObjAppend(divSearch,this.inputSearch);this.ulAddressbook=this.objCreate("ul");this.ulAddressbook.classList.add("pc_addressbooklist");this.ObjAppend(this.div,this.ulAddressbook);this.getAddressbook();}},{key:'toRefer',value:function toRefer(){if(AddressbookView.refer){BlackCat.Main.viewMgr.change(AddressbookView.refer);AddressbookView.refer=null;}}},{key:'getAddressbook',value:function getAddressbook(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee47(){var res,undata,k;return regeneratorRuntime.wrap(function _callee47$(_context47){while(1){switch(_context47.prev=_context47.next){case 0:_context47.next=2;return BlackCat.ApiTool.getAddrbook(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token);case 2:res=_context47.sent;console.log("[BlaCat]",'[AddressbookView]','getAddressbook, res =>',res);if(res.r){this.addressbook=res.data;if(this.addressbook.hasOwnProperty("")){undata=this.addressbook[""];delete this.addressbook[""];this.addressbook["#"]=undata;}this.ulAddressbook.innerHTML="";for(k in this.addressbook){this.getAddressElement(k,this.addressbook[k]);}}else{BlackCat.Main.showErrCode(res.errCode);}case 5:case'end':return _context47.stop();}}},_callee47,this);}));}},{key:'searchAddressbook',value:function searchAddressbook(){var search_str=this.inputSearch.value;var search_data={};for(var k in this.addressbook){for(var i=0;i<this.addressbook[k].length;i++){var name=this.addressbook[k][i]['address_name'];if(name.indexOf(search_str)!=-1){if(!search_data.hasOwnProperty(k)){search_data[k]=[];}search_data[k].push(this.addressbook[k][i]);}}}var contacts=this.ulAddressbook.getElementsByTagName("li");for(var l=0;l<contacts.length;l++){var li=contacts[l];var type=li.getAttribute("data-type");if(type=="title"){var _k=li.getAttribute("data-value");if(search_data.hasOwnProperty(_k)){li.style.display="";}else{li.style.display="none";}}else if(type=="contact"){var _k2=li.getAttribute("data-title");if(search_data.hasOwnProperty(_k2)){var id=li.getAttribute("data-value");var isMatch=0;for(var _i=0;_i<search_data[_k2].length;_i++){if(search_data[_k2][_i]["id"]==id){isMatch=1;break;}}if(li.style.display==""){if(isMatch==0){li.style.display="none";}}else{if(isMatch==1){li.style.display="";}}}else{li.style.display="none";}}}}},{key:'getAddressElement',value:function getAddressElement(k,addrs){var _this36=this;var liAddressbook=this.objCreate("li");liAddressbook.classList.add("pc_addressbooktitle");liAddressbook.textContent=k;liAddressbook.setAttribute("data-type","title");liAddressbook.setAttribute("data-value",k);this.ObjAppend(this.ulAddressbook,liAddressbook);var _loop=function _loop(i){liAddressbook=_this36.objCreate("li");liAddressbook.textContent=addrs[i]["address_name"];liAddressbook.setAttribute("data-title",k);liAddressbook.setAttribute("data-type","contact");liAddressbook.setAttribute("data-value",addrs[i]["id"]);liAddressbook.onclick=function(){if(AddressbookView.select){_this36.remove();BlackCat.Main.viewMgr.payView.show();BlackCat.Main.viewMgr.payTransferView.show();BlackCat.PayTransferView.contact=addrs[i];BlackCat.Main.viewMgr.payTransferView.gatSelect();AddressbookView.select="";}else{_this36.hidden();BlackCat.AddressbookDetailsView.refer="AddressbookView";BlackCat.AddressbookDetailsView.contact=addrs[i];BlackCat.Main.viewMgr.change("AddressbookDetailsView");}};_this36.ObjAppend(_this36.ulAddressbook,liAddressbook);};for(var i=0;i<addrs.length;i++){var liAddressbook;_loop(i);}}}]);return AddressbookView;}(BlackCat.ViewBase);BlackCat.AddressbookView=AddressbookView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var AreaView=function(_BlackCat$ViewBase4){_inherits(AreaView,_BlackCat$ViewBase4);function AreaView(){_classCallCheck(this,AreaView);return _possibleConstructorReturn(this,(AreaView.__proto__||Object.getPrototypeOf(AreaView)).apply(this,arguments));}_createClass(AreaView,null,[{key:'getAreaByLang',value:function getAreaByLang(lang){var idx=[];switch(lang){case"en":idx=[3,6,55,10,1,8,5,4,9,7,13,12,11,14,29,21,17,16,32,18,33,23,24,30,26,15,31,28,25,20,19,22,102,42,34,46,27,109,36,189,41,0,43,104,40,44,86,45,47,48,49,35,52,51,53,54,193,56,58,185,78,59,57,61,65,63,62,66,71,155,67,75,70,50,72,73,79,74,69,77,81,80,76,82,83,87,85,84,88,95,92,89,94,93,90,91,96,39,97,99,98,110,100,103,106,108,101,111,120,112,117,116,121,114,118,119,132,128,126,138,140,137,129,135,127,133,136,213,139,64,124,123,131,125,134,122,141,130,142,150,149,147,143,151,146,144,145,148,152,158,163,153,156,164,154,157,159,162,161,165,37,166,167,169,170,105,113,160,206,211,180,184,171,181,168,173,179,176,178,177,172,182,214,107,60,115,174,183,187,175,38,186,199,192,200,191,190,196,198,195,197,194,188,202,201,2,68,203,204,205,210,207,209,208,212,215,216];break;default:idx=[1,11,12,6,55,90,3,5,8,9,58,13,2,152,14,61,57,4,16,156,31,30,95,161,32,29,20,19,158,21,159,22,164,18,26,33,24,23,153,15,28,78,106,193,50,190,52,53,54,56,169,59,66,62,157,65,155,71,45,75,81,77,80,37,35,43,70,74,69,44,83,87,85,107,147,27,125,110,216,51,101,49,103,72,34,76,82,67,102,40,86,47,42,104,109,100,46,165,108,116,112,121,167,166,119,117,118,120,111,170,114,130,126,137,124,135,131,203,17,64,129,154,122,136,133,138,140,123,128,141,127,10,134,139,213,149,214,146,150,142,144,145,148,163,162,99,175,38,160,174,184,185,168,105,178,179,115,172,183,177,113,182,180,211,181,48,173,171,187,206,197,191,196,192,194,188,198,195,200,202,201,25,204,210,207,205,60,176,143,79,186,151,39,88,92,98,96,89,68,94,93,212,97,7,209,208,91,73,215,189,36,0,132,199,84,63,41];break;}if(idx.length>0){var rtn=[];for(var i=0;i<idx.length;i++){var a_idx=idx[i];rtn.push(this.areaInfo[a_idx]);}return rtn;}else{return AreaView.areaInfo;}}},{key:'getByAreaCode',value:function getByAreaCode(areaCode){var areaInfo=null;AreaView.areaInfo.forEach(function(area){if(area.areacode==areaCode){areaInfo=area;}});return areaInfo;}},{key:'getByCodeName',value:function getByCodeName(codeName){var areaInfo=null;AreaView.areaInfo.forEach(function(area){if(area.codename==codeName){areaInfo=area;}});return areaInfo;}}]);return AreaView;}(BlackCat.ViewBase);AreaView.areaInfo=[{"areacode":"86","codename":"CN"},{"areacode":"376","codename":"AD"},{"areacode":"971","codename":"AE"},{"areacode":"93","codename":"AF"},{"areacode":"1268","codename":"AG"},{"areacode":"1264","codename":"AI"},{"areacode":"355","codename":"AL"},{"areacode":"374","codename":"AM"},{"areacode":"244","codename":"AO"},{"areacode":"54","codename":"AR"},{"areacode":"1684","codename":"AS"},{"areacode":"43","codename":"AT"},{"areacode":"61","codename":"AU"},{"areacode":"297","codename":"AW"},{"areacode":"994","codename":"AZ"},{"areacode":"387","codename":"BA"},{"areacode":"1246","codename":"BB"},{"areacode":"880","codename":"BD"},{"areacode":"32","codename":"BE"},{"areacode":"226","codename":"BF"},{"areacode":"359","codename":"BG"},{"areacode":"973","codename":"BH"},{"areacode":"257","codename":"BI"},{"areacode":"229","codename":"BJ"},{"areacode":"1441","codename":"BM"},{"areacode":"673","codename":"BN"},{"areacode":"591","codename":"BO"},{"areacode":"599","codename":"BQ"},{"areacode":"55","codename":"BR"},{"areacode":"1242","codename":"BS"},{"areacode":"975","codename":"BT"},{"areacode":"267","codename":"BW"},{"areacode":"375","codename":"BY"},{"areacode":"501","codename":"BZ"},{"areacode":"1","codename":"CA"},{"areacode":"243","codename":"CD"},{"areacode":"236","codename":"CF"},{"areacode":"242","codename":"CG"},{"areacode":"41","codename":"CH"},{"areacode":"225","codename":"CI"},{"areacode":"682","codename":"CK"},{"areacode":"56","codename":"CL"},{"areacode":"237","codename":"CM"},{"areacode":"57","codename":"CO"},{"areacode":"506","codename":"CR"},{"areacode":"53","codename":"CU"},{"areacode":"238","codename":"CV"},{"areacode":"599","codename":"CW"},{"areacode":"357","codename":"CY"},{"areacode":"420","codename":"CZ"},{"areacode":"49","codename":"DE"},{"areacode":"253","codename":"DJ"},{"areacode":"45","codename":"DK"},{"areacode":"1767","codename":"DM"},{"areacode":"1809","codename":"DO"},{"areacode":"213","codename":"DZ"},{"areacode":"593","codename":"EC"},{"areacode":"372","codename":"EE"},{"areacode":"20","codename":"EG"},{"areacode":"291","codename":"ER"},{"areacode":"34","codename":"ES"},{"areacode":"251","codename":"ET"},{"areacode":"358","codename":"FI"},{"areacode":"679","codename":"FJ"},{"areacode":"691","codename":"FM"},{"areacode":"298","codename":"FO"},{"areacode":"33","codename":"FR"},{"areacode":"241","codename":"GA"},{"areacode":"44","codename":"GB"},{"areacode":"1473","codename":"GD"},{"areacode":"995","codename":"GE"},{"areacode":"594","codename":"GF"},{"areacode":"233","codename":"GH"},{"areacode":"350","codename":"GI"},{"areacode":"299","codename":"GL"},{"areacode":"220","codename":"GM"},{"areacode":"224","codename":"GN"},{"areacode":"590","codename":"GP"},{"areacode":"240","codename":"GQ"},{"areacode":"30","codename":"GR"},{"areacode":"502","codename":"GT"},{"areacode":"1671","codename":"GU"},{"areacode":"245","codename":"GW"},{"areacode":"592","codename":"GY"},{"areacode":"852","codename":"HK"},{"areacode":"504","codename":"HN"},{"areacode":"385","codename":"HR"},{"areacode":"509","codename":"HT"},{"areacode":"36","codename":"HU"},{"areacode":"62","codename":"ID"},{"areacode":"353","codename":"IE"},{"areacode":"972","codename":"IL"},{"areacode":"91","codename":"IN"},{"areacode":"964","codename":"IQ"},{"areacode":"98","codename":"IR"},{"areacode":"354","codename":"IS"},{"areacode":"39","codename":"IT"},{"areacode":"1876","codename":"JM"},{"areacode":"962","codename":"JO"},{"areacode":"81","codename":"JP"},{"areacode":"254","codename":"KE"},{"areacode":"996","codename":"KG"},{"areacode":"855","codename":"KH"},{"areacode":"686","codename":"KI"},{"areacode":"269","codename":"KM"},{"areacode":"1869","codename":"KN"},{"areacode":"850","codename":"KP"},{"areacode":"82","codename":"KR"},{"areacode":"965","codename":"KW"},{"areacode":"1345","codename":"KY"},{"areacode":"7","codename":"KZ"},{"areacode":"856","codename":"LA"},{"areacode":"961","codename":"LB"},{"areacode":"1758","codename":"LC"},{"areacode":"423","codename":"LI"},{"areacode":"94","codename":"LK"},{"areacode":"231","codename":"LR"},{"areacode":"266","codename":"LS"},{"areacode":"370","codename":"LT"},{"areacode":"352","codename":"LU"},{"areacode":"371","codename":"LV"},{"areacode":"218","codename":"LY"},{"areacode":"212","codename":"MA"},{"areacode":"377","codename":"MC"},{"areacode":"373","codename":"MD"},{"areacode":"382","codename":"ME"},{"areacode":"261","codename":"MG"},{"areacode":"692","codename":"MH"},{"areacode":"389","codename":"MK"},{"areacode":"223","codename":"ML"},{"areacode":"95","codename":"MM"},{"areacode":"976","codename":"MN"},{"areacode":"853","codename":"MO"},{"areacode":"222","codename":"MR"},{"areacode":"1664","codename":"MS"},{"areacode":"356","codename":"MT"},{"areacode":"230","codename":"MU"},{"areacode":"960","codename":"MV"},{"areacode":"265","codename":"MW"},{"areacode":"52","codename":"MX"},{"areacode":"60","codename":"MY"},{"areacode":"258","codename":"MZ"},{"areacode":"264","codename":"NA"},{"areacode":"687","codename":"NC"},{"areacode":"227","codename":"NE"},{"areacode":"234","codename":"NG"},{"areacode":"505","codename":"NI"},{"areacode":"31","codename":"NL"},{"areacode":"47","codename":"NO"},{"areacode":"977","codename":"NP"},{"areacode":"674","codename":"NR"},{"areacode":"64","codename":"NZ"},{"areacode":"968","codename":"OM"},{"areacode":"507","codename":"PA"},{"areacode":"51","codename":"PE"},{"areacode":"689","codename":"PF"},{"areacode":"675","codename":"PG"},{"areacode":"63","codename":"PH"},{"areacode":"92","codename":"PK"},{"areacode":"48","codename":"PL"},{"areacode":"508","codename":"PM"},{"areacode":"1787","codename":"PR"},{"areacode":"351","codename":"PT"},{"areacode":"680","codename":"PW"},{"areacode":"595","codename":"PY"},{"areacode":"974","codename":"QA"},{"areacode":"262","codename":"RE"},{"areacode":"40","codename":"RO"},{"areacode":"381","codename":"RS"},{"areacode":"7","codename":"RU"},{"areacode":"250","codename":"RW"},{"areacode":"966","codename":"SA"},{"areacode":"677","codename":"SB"},{"areacode":"248","codename":"SC"},{"areacode":"249","codename":"SD"},{"areacode":"46","codename":"SE"},{"areacode":"65","codename":"SG"},{"areacode":"386","codename":"SI"},{"areacode":"421","codename":"SK"},{"areacode":"232","codename":"SL"},{"areacode":"378","codename":"SM"},{"areacode":"221","codename":"SN"},{"areacode":"252","codename":"SO"},{"areacode":"597","codename":"SR"},{"areacode":"239","codename":"ST"},{"areacode":"503","codename":"SV"},{"areacode":"963","codename":"SY"},{"areacode":"268","codename":"SZ"},{"areacode":"1649","codename":"TC"},{"areacode":"235","codename":"TD"},{"areacode":"228","codename":"TG"},{"areacode":"66","codename":"TH"},{"areacode":"992","codename":"TJ"},{"areacode":"670","codename":"TL"},{"areacode":"993","codename":"TM"},{"areacode":"216","codename":"TN"},{"areacode":"676","codename":"TO"},{"areacode":"90","codename":"TR"},{"areacode":"1868","codename":"TT"},{"areacode":"886","codename":"TW"},{"areacode":"255","codename":"TZ"},{"areacode":"380","codename":"UA"},{"areacode":"256","codename":"UG"},{"areacode":"1","codename":"US"},{"areacode":"598","codename":"UY"},{"areacode":"998","codename":"UZ"},{"areacode":"1784","codename":"VC"},{"areacode":"58","codename":"VE"},{"areacode":"1284","codename":"VG"},{"areacode":"84","codename":"VN"},{"areacode":"678","codename":"VU"},{"areacode":"685","codename":"WS"},{"areacode":"967","codename":"YE"},{"areacode":"269","codename":"YT"},{"areacode":"27","codename":"ZA"},{"areacode":"260","codename":"ZM"},{"areacode":"263","codename":"ZW"}];BlackCat.AreaView=AreaView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var AutoLogoutWalletView=function(_BlackCat$ViewBase5){_inherits(AutoLogoutWalletView,_BlackCat$ViewBase5);function AutoLogoutWalletView(){_classCallCheck(this,AutoLogoutWalletView);var _this38=_possibleConstructorReturn(this,(AutoLogoutWalletView.__proto__||Object.getPrototypeOf(AutoLogoutWalletView)).apply(this,arguments));_this38.logoutTime=[1,5,10,30,60,120,0];return _this38;}_createClass(AutoLogoutWalletView,[{key:'create',value:function create(){var _this39=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_logoutwallet");var header=this.objCreate("div");header.classList.add("pc_header");this.ObjAppend(this.div,header);var returnA=this.objCreate("a");returnA.classList.add("iconfont","icon-fanhui");returnA.textContent=BlackCat.Main.langMgr.get("return");returnA.onclick=function(){_this39.return();};this.ObjAppend(header,returnA);var headerH1=this.objCreate("h1");headerH1.textContent=BlackCat.Main.langMgr.get("security_title");this.ObjAppend(header,headerH1);var divSecurity=this.objCreate("div");divSecurity.classList.add("pc_myinfolist");this.ObjAppend(this.div,divSecurity);var ulSecurity=this.objCreate("ul");this.ObjAppend(divSecurity,ulSecurity);var liveTimeMax=BlackCat.Main.getLiveTimeMax();this.logoutTime.forEach(function(ts){var liTime=_this39.objCreate("li");if(ts*60*1000==liveTimeMax){liTime.classList.add("pc_active");}liTime.textContent=BlackCat.Main.viewMgr.securityCenterView.getWalletOutTimeMaxMsg(ts*60*1000);liTime.onclick=function(){BlackCat.Main.setLiveTimeMax(ts);ulSecurity.getElementsByClassName("pc_active")[0].classList.remove("pc_active");liTime.classList.add("pc_active");BlackCat.Main.viewMgr.securityCenterView.updateWalletOutTimeMaxMsg();_this39.return();};_this39.ObjAppend(ulSecurity,liTime);var iTime=_this39.objCreate("i");iTime.classList.add("iconfont","icon-gou");_this39.ObjAppend(liTime,iTime);});}},{key:'toRefer',value:function toRefer(){BlackCat.Main.viewMgr.securityCenterView.show();}}]);return AutoLogoutWalletView;}(BlackCat.ViewBase);BlackCat.AutoLogoutWalletView=AutoLogoutWalletView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ForgetPasswordView=function(_BlackCat$ViewBase6){_inherits(ForgetPasswordView,_BlackCat$ViewBase6);function ForgetPasswordView(){_classCallCheck(this,ForgetPasswordView);var _this40=_possibleConstructorReturn(this,(ForgetPasswordView.__proto__||Object.getPrototypeOf(ForgetPasswordView)).call(this));_this40.getCodeRetryMax=60;_this40.getCodeRetry_curr=0;return _this40;}_createClass(ForgetPasswordView,[{key:'create',value:function create(){var _this41=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_login","pc_register");var divLogo=this.objCreate("div");divLogo.classList.add("pc_login_logo","iconfont","icon-blacat");this.ObjAppend(this.div,divLogo);var divTitle=this.objCreate("div");divTitle.classList.add("pc_login_title");this.ObjAppend(this.div,divTitle);var h1TitleType=this.objCreate("h1");h1TitleType.classList.add("pc_title_tyle");h1TitleType.textContent=BlackCat.Main.langMgr.get("forgetpass_title");this.ObjAppend(divTitle,h1TitleType);var divTitleobj=this.objCreate("div");divTitleobj.classList.add("pc_title_switch");this.ObjAppend(divTitle,divTitleobj);var aTiletMobile=this.objCreate("a");aTiletMobile.classList.add("pc_tiletmobile","pc_active");aTiletMobile.style.borderLeft="0";aTiletMobile.textContent=BlackCat.Main.langMgr.get("main_phone");aTiletMobile.onclick=function(){areaSelect.style.display="block";aTiletMobile.classList.add("pc_active");aTilEtEmail.classList.remove("pc_active");iIshurushouji.classList.add("icon-shurushouji");iIshurushouji.classList.remove("icon-xinxi");_this41.inputAccount.value="";_this41.inputCode.value="";_this41.accountType="phone";_this41.inputAccount.placeholder=BlackCat.Main.langMgr.get("forgetpass_input"+_this41.accountType);};this.ObjAppend(divTitleobj,aTiletMobile);var aTilEtEmail=this.objCreate("a");aTilEtEmail.textContent=BlackCat.Main.langMgr.get("main_email");aTilEtEmail.onclick=function(){areaSelect.style.display="none";aTilEtEmail.classList.add("pc_active");aTiletMobile.classList.remove("pc_active");iIshurushouji.classList.add("icon-xinxi");iIshurushouji.classList.remove("icon-shurushouji");_this41.inputAccount.value="";_this41.inputCode.value="";_this41.accountType="email";_this41.inputAccount.placeholder=BlackCat.Main.langMgr.get("forgetpass_input"+_this41.accountType);};this.ObjAppend(divTitleobj,aTilEtEmail);var divInput=this.objCreate("div");divInput.classList.add("pc_login_input");this.ObjAppend(this.div,divInput);var areaSelect=this.objCreate("div");areaSelect.classList.add("pc_login_inputbox");this.ObjAppend(divInput,areaSelect);var iRegion=this.objCreate("i");iRegion.classList.add("iconfont","icon-diqiu");this.ObjAppend(areaSelect,iRegion);this.selectArea=this.objCreate("select");var areaInfo=BlackCat.AreaView.getAreaByLang(BlackCat.Main.langMgr.type);areaInfo.forEach(function(area){var option=_this41.objCreate("option");option.setAttribute("value",area.codename);option.textContent=BlackCat.Main.langMgr.get("area_code_"+area.codename);if(area.codename=="CN"){option.setAttribute("selected","selected");}_this41.selectArea.options.add(option);});this.selectArea.onchange=function(){areaInfo.forEach(function(area){if(area.codename==_this41.selectArea.value){_this41.divArea.textContent=area.areacode;}});};this.ObjAppend(areaSelect,this.selectArea);this.divArea=this.objCreate("div");this.divArea.classList.add("pc_area");areaInfo.forEach(function(area){if(area.codename==_this41.selectArea.value){_this41.divArea.textContent=area.areacode;}});this.ObjAppend(areaSelect,this.divArea);var aArea=this.objCreate("a");aArea.classList.add("pc_areaa","iconfont","icon-xiala");this.ObjAppend(areaSelect,aArea);var divTel=this.objCreate("div");divTel.classList.add("pc_login_inputbox");this.ObjAppend(divInput,divTel);var iIshurushouji=this.objCreate("i");iIshurushouji.classList.add("iconfont","icon-shurushouji");this.ObjAppend(divTel,iIshurushouji);this.inputAccount=this.objCreate("input");this.inputAccount.type="text";this.inputAccount.placeholder=BlackCat.Main.langMgr.get("forgetpass_inputphone");this.ObjAppend(divTel,this.inputAccount);var divCode=this.objCreate("div");divCode.classList.add("pc_login_inputbox");this.ObjAppend(divInput,divCode);var iCode=this.objCreate("i");iCode.classList.add("iconfont","icon-dunpai1");this.ObjAppend(divCode,iCode);this.inputCode=this.objCreate("input");this.inputCode.type="text";this.inputCode.style.width="60%";this.inputCode.placeholder=BlackCat.Main.langMgr.get("forgetpass_inputCode");this.ObjAppend(divCode,this.inputCode);var divPass=this.objCreate("div");divPass.classList.add("pc_login_inputbox");this.ObjAppend(divInput,divPass);var iPass=this.objCreate("i");iPass.classList.add("iconfont","icon-mima");this.ObjAppend(divPass,iPass);this.inputPass=this.objCreate("input");this.inputPass.type="password";this.inputPass.placeholder=BlackCat.Main.langMgr.get("forgetpass_inputPass");this.ObjAppend(divPass,this.inputPass);var divVPass=this.objCreate("div");divVPass.classList.add("pc_login_inputbox");this.ObjAppend(divInput,divVPass);var iVPass=this.objCreate("i");iVPass.classList.add("iconfont","icon-mima");this.ObjAppend(divVPass,iVPass);this.inputVpass=this.objCreate("input");this.inputVpass.type="password";this.inputVpass.placeholder=BlackCat.Main.langMgr.get("forgetpass_inputVpass");this.ObjAppend(divVPass,this.inputVpass);this.getCode=this.objCreate("button");this.getCode.textContent=BlackCat.Main.langMgr.get("forgetpass_getCode");this.getCode.onclick=function(){_this41.doGetCode();};this.ObjAppend(divCode,this.getCode);this.getCodeCount=this.objCreate("button");this.getCodeCount.classList.add("pc_getPhoneCodecount");this.getCodeCount.textContent=BlackCat.Main.langMgr.get("forgetpass_getCodecount");this.ObjAppend(divCode,this.getCodeCount);var doForgetPassword=this.objCreate("button");doForgetPassword.classList.add("pc_doLogin");doForgetPassword.textContent=BlackCat.Main.langMgr.get("forgetpass_do");doForgetPassword.onclick=function(){_this41.doForgetPassword();};this.ObjAppend(divInput,doForgetPassword);var doLogin=this.objCreate("button");doLogin.classList.add("pc_loginregion");doLogin.textContent=BlackCat.Main.langMgr.get("forgetpass_doLogin");doLogin.onclick=function(){_this41.remove();BlackCat.Main.viewMgr.change("LoginView");};this.ObjAppend(divInput,doLogin);}},{key:'start',value:function start(){_get(ForgetPasswordView.prototype.__proto__||Object.getPrototypeOf(ForgetPasswordView.prototype),'start',this).call(this);this.inputAccount.focus();}},{key:'update',value:function update(){_get(ForgetPasswordView.prototype.__proto__||Object.getPrototypeOf(ForgetPasswordView.prototype),'update',this).call(this);this.doRetryCount(0);}},{key:'reset',value:function reset(){if(this.s_getCodeCountRetry)clearInterval(this.s_getCodeCountRetry);this.accountType="phone";}},{key:'empty',value:function empty(value){if(value.toString().length==0){return true;}return false;}},{key:'validateAccount',value:function validateAccount(){var emptySkip=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee48(){return regeneratorRuntime.wrap(function _callee48$(_context48){while(1){switch(_context48.prev=_context48.next){case 0:if(!this.empty(this.inputAccount.value)){_context48.next=5;break;}if(!emptySkip){_context48.next=3;break;}return _context48.abrupt('return');case 3:BlackCat.Main.showErrMsg("forgetpass_input"+this.accountType+"_err");return _context48.abrupt('return',false);case 5:_context48.next=7;return BlackCat.Main.validateFormat(this.accountType,this.inputAccount);case 7:_context48.t0=_context48.sent;if(!(_context48.t0==false)){_context48.next=10;break;}return _context48.abrupt('return',false);case 10:_context48.next=12;return this.checkAccountFromApi();case 12:return _context48.abrupt('return',_context48.sent);case 13:case'end':return _context48.stop();}}},_callee48,this);}));}},{key:'validateCode',value:function validateCode(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee49(){return regeneratorRuntime.wrap(function _callee49$(_context49){while(1){switch(_context49.prev=_context49.next){case 0:if(!this.empty(this.inputCode.value)){_context49.next=3;break;}BlackCat.Main.showErrMsg("forgetpass_inputCode_err");return _context49.abrupt('return',false);case 3:_context49.next=5;return BlackCat.Main.validateFormat("vcode",this.inputCode);case 5:return _context49.abrupt('return',_context49.sent);case 6:case'end':return _context49.stop();}}},_callee49,this);}));}},{key:'validatePass',value:function validatePass(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee50(){return regeneratorRuntime.wrap(function _callee50$(_context50){while(1){switch(_context50.prev=_context50.next){case 0:if(!this.empty(this.inputPass.value)){_context50.next=3;break;}BlackCat.Main.showErrMsg("forgetpass_inputPass_err");return _context50.abrupt('return',false);case 3:return _context50.abrupt('return',true);case 4:case'end':return _context50.stop();}}},_callee50,this);}));}},{key:'validateVpass',value:function validateVpass(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee51(){return regeneratorRuntime.wrap(function _callee51$(_context51){while(1){switch(_context51.prev=_context51.next){case 0:if(!this.empty(this.inputVpass.value)){_context51.next=3;break;}BlackCat.Main.showErrMsg("forgetpass_inputVpass_err");return _context51.abrupt('return',false);case 3:if(!(this.inputVpass.value!=this.inputPass.value)){_context51.next=6;break;}BlackCat.Main.showErrMsg("forgetpass_inputVpass_inputPass_err");return _context51.abrupt('return',false);case 6:return _context51.abrupt('return',true);case 7:case'end':return _context51.stop();}}},_callee51,this);}));}},{key:'checkAccountFromApi',value:function checkAccountFromApi(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee52(){var res;return regeneratorRuntime.wrap(function _callee52$(_context52){while(1){switch(_context52.prev=_context52.next){case 0:_context52.t0=this.accountType;_context52.next=_context52.t0==='email'?3:_context52.t0==='phone'?7:11;break;case 3:_context52.next=5;return BlackCat.ApiTool.validEmail(this.inputAccount.value);case 5:res=_context52.sent;return _context52.abrupt('break',12);case 7:_context52.next=9;return BlackCat.ApiTool.validPhone(this.getPhone());case 9:res=_context52.sent;return _context52.abrupt('break',12);case 11:return _context52.abrupt('return');case 12:if(!res.r){_context52.next=15;break;}BlackCat.Main.showErrMsg('forgetpass_input'+this.accountType+'_notexist');return _context52.abrupt('return',false);case 15:return _context52.abrupt('return',true);case 16:case'end':return _context52.stop();}}},_callee52,this);}));}},{key:'doForgetPassword',value:function doForgetPassword(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee53(){var _this42=this;var res;return regeneratorRuntime.wrap(function _callee53$(_context53){while(1){switch(_context53.prev=_context53.next){case 0:_context53.next=2;return this.validateAccount(false);case 2:if(_context53.sent){_context53.next=4;break;}return _context53.abrupt('return');case 4:_context53.next=6;return this.validateCode();case 6:if(_context53.sent){_context53.next=8;break;}return _context53.abrupt('return');case 8:_context53.next=10;return this.validatePass();case 10:if(_context53.sent){_context53.next=12;break;}return _context53.abrupt('return');case 12:_context53.next=14;return this.validateVpass();case 14:if(_context53.sent){_context53.next=16;break;}return _context53.abrupt('return');case 16:if(!(this.inputPass.value.length>32)){_context53.next=19;break;}BlackCat.Main.showErrMsg("forgetpass_exceed",function(){_this42.inputPass.focus();});return _context53.abrupt('return');case 19:_context53.t0=this.accountType;_context53.next=_context53.t0==='email'?22:_context53.t0==='phone'?26:30;break;case 22:_context53.next=24;return BlackCat.ApiTool.forgetPassByEmail(this.inputAccount.value,this.inputCode.value,this.inputVpass.value);case 24:res=_context53.sent;return _context53.abrupt('break',31);case 26:_context53.next=28;return BlackCat.ApiTool.forgetPassByPhone(this.getPhone(),this.inputCode.value,this.inputVpass.value);case 28:res=_context53.sent;return _context53.abrupt('break',31);case 30:return _context53.abrupt('return');case 31:if(res.r){BlackCat.Main.showInfo('forgetpass_do_ok',function(){_this42.remove();BlackCat.Main.viewMgr.change("LoginView");});}else{BlackCat.Main.showErrCode(res.errCode);}case 32:case'end':return _context53.stop();}}},_callee53,this);}));}},{key:'doRetryCount',value:function doRetryCount(type){var _this43=this;switch(type){case 0:if(this.s_getCodeCountRetry){this.getCode.style.display="none";this.getCodeCount.style.display="block";}break;case 1:this.getCodeRetry_curr=this.getCodeRetryMax;this.getCode.style.display="none";this.getCodeCount.style.display="block";this.s_getCodeCountRetry=setInterval(function(){_this43._doRetryCount();},1000);break;}}},{key:'_doRetryCount',value:function _doRetryCount(){if(this.getCodeRetry_curr>0&&this.getCodeCount!=null){this.getCodeRetry_curr--;this.getCodeCount.innerText=BlackCat.Main.langMgr.get("forgetpass_getCodecountRetry")+"("+this.getCodeRetry_curr+")";}else if(this.getCodeCount!=null){clearInterval(this.s_getCodeCountRetry);this.getCodeCount.style.display="none";this.getCode.style.display="block";this.getCodeRetry_curr=0;}else{clearInterval(this.s_getCodeCountRetry);this.getCodeRetry_curr=0;}}},{key:'doGetCode',value:function doGetCode(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee54(){var res;return regeneratorRuntime.wrap(function _callee54$(_context54){while(1){switch(_context54.prev=_context54.next){case 0:_context54.next=2;return this.validateAccount(false);case 2:if(_context54.sent){_context54.next=4;break;}return _context54.abrupt('return');case 4:BlackCat.Main.viewMgr.change("ViewLoading");_context54.prev=5;_context54.t0=this.accountType;_context54.next=_context54.t0==='email'?9:_context54.t0==='phone'?13:17;break;case 9:_context54.next=11;return BlackCat.ApiTool.getEmailCode(this.inputAccount.value,BlackCat.Main.langMgr.type);case 11:res=_context54.sent;return _context54.abrupt('break',18);case 13:_context54.next=15;return BlackCat.ApiTool.getPhoneCode(this.getPhone());case 15:res=_context54.sent;return _context54.abrupt('break',18);case 17:return _context54.abrupt('return');case 18:_context54.next=23;break;case 20:_context54.prev=20;_context54.t1=_context54['catch'](5);console.log("[BlaCat]",'[ForgetPasswordView]','doGetCode, ApiTool '+this.accountType+'error => ',_context54.t1.toString());case 23:BlackCat.Main.viewMgr.viewLoading.remove();if(res.r){this.doRetryCount(1);BlackCat.Main.showToast("forgetpass_getCodeSucc");this.getCode.style.display="none";this.getCodeCount.style.display="block";}else{BlackCat.Main.showErrCode(res.errCode);}case 25:case'end':return _context54.stop();}}},_callee54,this,[[5,20]]);}));}},{key:'getPhone',value:function getPhone(){return BlackCat.Main.getPhone(this.selectArea.value,this.inputAccount.value);}}]);return ForgetPasswordView;}(BlackCat.ViewBase);BlackCat.ForgetPasswordView=ForgetPasswordView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var IconView=function(_BlackCat$ViewBase7){_inherits(IconView,_BlackCat$ViewBase7);function IconView(){_classCallCheck(this,IconView);return _possibleConstructorReturn(this,(IconView.__proto__||Object.getPrototypeOf(IconView)).apply(this,arguments));}_createClass(IconView,[{key:'start',value:function start(){if(this.isCreated===false){this.create();this.isCreated=true;this.bodyAppend(this.div);this.onResize();}this.show();}},{key:'reset',value:function reset(){this.doDragMove=false;if(this.div)this.flushProcess(0);}},{key:'update',value:function update(){}},{key:'create',value:function create(){var _this45=this;this.div=this.objCreate("div");this.div.classList.add("pc_icon");this.showFail();this.div.onclick=function(){console.log("[BlaCat]",'[IconView]','onclick, this.doDragMove => ',_this45.doDragMove);if(_this45.doDragMove==true){return false;}_this45.hidden();BlackCat.Main.viewMgr.mainView.div.classList.remove("pc_windowhide");BlackCat.Main.viewMgr.mainView.show();if(BlackCat.Main.viewMgr.payView&&BlackCat.Main.viewMgr.payView.isCreated){BlackCat.Main.viewMgr.payView.getHeight("nodes");if(BlackCat.tools.WWW.api_clis&&BlackCat.tools.WWW.api_clis!=""){BlackCat.Main.viewMgr.payView.getHeight("clis");}}};this.div.onmousemove=function(){_this45.drag();};this.div.ontouchstart=function(ev){_this45.dragTouch(ev);};this.processDiv=this.objCreate("div");this.ObjAppend(this.div,this.processDiv);this.showState();}},{key:'remove',value:function remove(){this.bodyRemove(this.div);}},{key:'showState',value:function showState(){if(!this.stateDiv){this.stateDiv=this.objCreate("div");this.stateDiv.classList.add("pc_iconstate");var imgStateIcon=this.objCreate("img");imgStateIcon.src=BlackCat.Main.resHost+"res/img/BlackCaticon.gif";this.ObjAppend(this.stateDiv,imgStateIcon);this.ObjAppend(this.div,this.stateDiv);}this.stateDiv.style.display="";}},{key:'removeState',value:function removeState(){if(this.stateDiv)this.objRemove(this.div,this.stateDiv);}},{key:'hiddenState',value:function hiddenState(){if(this.stateDiv)this.stateDiv.style.display="none";}},{key:'showFail',value:function showFail(){this.div.classList.add("pc_iconfail");}},{key:'showSucc',value:function showSucc(){this.div.classList.remove("pc_iconfail");}},{key:'flushProcess',value:function flushProcess(count){console.log("[BlaCat]",'[IconView]','flushProcess, count => ',count);if(count>0){this.div.classList.add("pc_iconRecord");}else{this.div.classList.remove("pc_iconRecord");}}},{key:'dragTouch',value:function dragTouch(ev){var _this46=this;var sent={l:0,r:window.innerWidth-this.div.offsetWidth,t:0,b:window.innerHeight-this.div.offsetHeight};var dmW=document.documentElement.clientWidth||document.body.clientWidth;var dmH=document.documentElement.clientHeight||document.body.clientHeight;var l=sent.l||0;var r=sent.r||dmW-this.div.offsetWidth;var t=sent.t||0;var b=sent.b||dmH-this.div.offsetHeight;this.doDragMove=false;var oEvent=ev.touches[0];var sentX=oEvent.clientX-this.div.offsetLeft;var sentY=oEvent.clientY-this.div.offsetTop;document.ontouchmove=function(ev){var mEvent=ev.touches[0];var slideLeft=mEvent.clientX-sentX;var slideTop=mEvent.clientY-sentY;if(slideLeft<=l){slideLeft=l;}if(slideLeft>=r){slideLeft=r;}if(slideTop<=t){slideTop=t;}if(slideTop>=b){slideTop=b;}_this46.div.style.left=slideLeft+'px';_this46.div.style.top=slideTop+'px';if(oEvent.clientX!=mEvent.clientX||oEvent.clientY!=mEvent.clientY){_this46.doDragMove=true;}};document.ontouchend=function(){document.ontouchmove=null;};}},{key:'drag',value:function drag(){var _this47=this;var sent={l:0,r:window.innerWidth-this.div.offsetWidth,t:0,b:window.innerHeight-this.div.offsetHeight};var dmW=document.documentElement.clientWidth||document.body.clientWidth;var dmH=document.documentElement.clientHeight||document.body.clientHeight;var l=sent.l||0;var r=sent.r||dmW-this.div.offsetWidth;var t=sent.t||0;var b=sent.b||dmH-this.div.offsetHeight;this.div.onmousedown=function(ev){_this47.doDragMove=false;var oEvent=ev;var sentX=oEvent.clientX-_this47.div.offsetLeft;var sentY=oEvent.clientY-_this47.div.offsetTop;document.onmousemove=function(ev){var mEvent=ev;var slideLeft=mEvent.clientX-sentX;var slideTop=mEvent.clientY-sentY;if(slideLeft<=l){slideLeft=l;}if(slideLeft>=r){slideLeft=r;}if(slideTop<=t){slideTop=t;}if(slideTop>=b){slideTop=b;}_this47.div.style.left=slideLeft+'px';_this47.div.style.top=slideTop+'px';if(oEvent.clientX!=mEvent.clientX||oEvent.clientY!=mEvent.clientY){_this47.doDragMove=true;}};document.onmouseup=function(){document.onmousemove=null;document.onmouseup=null;};return false;};}},{key:'onResize',value:function onResize(){var _this48=this;window.onresize=function(){var windowWidth=window.innerWidth;if(parseInt(_this48.div.style.left)+64>=windowWidth){_this48.div.style.left="auto";}};}}]);return IconView;}(BlackCat.ViewBase);BlackCat.IconView=IconView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var LoginView=function(_BlackCat$ViewBase8){_inherits(LoginView,_BlackCat$ViewBase8);function LoginView(){_classCallCheck(this,LoginView);return _possibleConstructorReturn(this,(LoginView.__proto__||Object.getPrototypeOf(LoginView)).apply(this,arguments));}_createClass(LoginView,[{key:'reset',value:function reset(){this.accountType="user";}},{key:'create',value:function create(){var _this50=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_login");var divLogo=this.objCreate("div");divLogo.classList.add("pc_login_logo","iconfont","icon-blacat");this.ObjAppend(this.div,divLogo);var divTitle=this.objCreate("div");divTitle.classList.add("pc_login_title");this.ObjAppend(this.div,divTitle);var h1TitleType=this.objCreate("h1");h1TitleType.classList.add("pc_title_tyle");h1TitleType.textContent=BlackCat.Main.langMgr.get("login_doLogin");this.ObjAppend(divTitle,h1TitleType);var divTitleobj=this.objCreate("div");divTitleobj.classList.add("pc_title_switch");this.ObjAppend(divTitle,divTitleobj);var aTiletUserName=this.objCreate("a");aTiletUserName.classList.add("pc_active");aTiletUserName.textContent=BlackCat.Main.langMgr.get("main_user");aTiletUserName.onclick=function(){areaSelect.style.display="none";aTiletUserName.classList.add("pc_active");aTiletMobile.classList.remove("pc_active");aTilEtEmail.classList.remove("pc_active");iIshurushouji.classList.add("icon-my");iIshurushouji.classList.remove("icon-shurushouji","icon-xinxi");_this50.inputAccount.value="";_this50.inputPass.value="";_this50.accountType="user";_this50.inputAccount.placeholder=BlackCat.Main.langMgr.get("login_input"+_this50.accountType);};this.ObjAppend(divTitleobj,aTiletUserName);var aTiletMobile=this.objCreate("a");aTiletMobile.classList.add("pc_tiletmobile");aTiletMobile.textContent=BlackCat.Main.langMgr.get("main_phone");aTiletMobile.onclick=function(){areaSelect.style.display="block";aTiletMobile.classList.add("pc_active");aTiletUserName.classList.remove("pc_active");aTilEtEmail.classList.remove("pc_active");iIshurushouji.classList.add("icon-shurushouji");iIshurushouji.classList.remove("icon-my","icon-xinxi");_this50.inputAccount.value="";_this50.inputPass.value="";_this50.accountType="phone";_this50.inputAccount.placeholder=BlackCat.Main.langMgr.get("login_input"+_this50.accountType);};this.ObjAppend(divTitleobj,aTiletMobile);var aTilEtEmail=this.objCreate("a");aTilEtEmail.textContent=BlackCat.Main.langMgr.get("main_email");aTilEtEmail.onclick=function(){areaSelect.style.display="none";aTilEtEmail.classList.add("pc_active");aTiletUserName.classList.remove("pc_active");aTiletMobile.classList.remove("pc_active");iIshurushouji.classList.add("icon-xinxi");iIshurushouji.classList.remove("icon-my","icon-shurushouji");_this50.inputAccount.value="";_this50.inputPass.value="";_this50.accountType="email";_this50.inputAccount.placeholder=BlackCat.Main.langMgr.get("login_input"+_this50.accountType);};this.ObjAppend(divTitleobj,aTilEtEmail);var divInput=this.objCreate("div");divInput.classList.add("pc_login_input");this.ObjAppend(this.div,divInput);var areaSelect=this.objCreate("div");areaSelect.classList.add("pc_login_inputbox");areaSelect.style.display="none";this.ObjAppend(divInput,areaSelect);var iRegion=this.objCreate("i");iRegion.classList.add("iconfont","icon-diqiu");this.ObjAppend(areaSelect,iRegion);this.selectArea=this.objCreate("select");var areaInfo=BlackCat.AreaView.getAreaByLang(BlackCat.Main.langMgr.type);areaInfo.forEach(function(area){var option=_this50.objCreate("option");option.setAttribute("value",area.codename);option.textContent=BlackCat.Main.langMgr.get("area_code_"+area.codename);_this50.selectArea.options.add(option);});this.selectArea.onchange=function(){areaInfo.forEach(function(area){if(area.codename==_this50.selectArea.value){_this50.divArea.textContent=area.areacode;}});};this.ObjAppend(areaSelect,this.selectArea);this.divArea=this.objCreate("div");this.divArea.classList.add("pc_area");areaInfo.forEach(function(area){if(area.codename==_this50.selectArea.value){_this50.divArea.textContent=area.areacode;}});this.ObjAppend(areaSelect,this.divArea);var aArea=this.objCreate("a");aArea.classList.add("pc_areaa","iconfont","icon-xiala");this.ObjAppend(areaSelect,aArea);var divTel=this.objCreate("div");divTel.classList.add("pc_login_inputbox");this.ObjAppend(divInput,divTel);var iIshurushouji=this.objCreate("i");iIshurushouji.classList.add("iconfont","icon-my");this.ObjAppend(divTel,iIshurushouji);this.inputAccount=this.objCreate("input");this.inputAccount.type="text";this.inputAccount.autocomplete="off";this.inputAccount.placeholder=BlackCat.Main.langMgr.get("login_inputuser");this.ObjAppend(divTel,this.inputAccount);var divPass=this.objCreate("div");divPass.classList.add("pc_login_inputbox");this.ObjAppend(divInput,divPass);var iPass=this.objCreate("i");iPass.classList.add("iconfont","icon-mima");this.ObjAppend(divPass,iPass);this.inputPass=this.objCreate("input");this.inputPass.type="password";this.inputPass.autocomplete="off";this.inputPass.placeholder=BlackCat.Main.langMgr.get("login_inputPass");this.ObjAppend(divPass,this.inputPass);var divForgetPass=this.objCreate("div");divForgetPass.classList.add("pc_login_forgetpass");this.ObjAppend(divInput,divForgetPass);var aForgetPass=this.objCreate("a");aForgetPass.textContent=BlackCat.Main.langMgr.get("login_textForgetpass");aForgetPass.onclick=function(){_this50.remove();BlackCat.Main.viewMgr.change("ForgetPasswordView");};this.ObjAppend(divForgetPass,aForgetPass);var doLogin=this.objCreate("button");doLogin.classList.add("pc_doLogin");doLogin.textContent=BlackCat.Main.langMgr.get("login_doLogin");doLogin.onclick=function(){_this50.doLogin();};this.ObjAppend(divInput,doLogin);var doRegister=this.objCreate("button");doRegister.classList.add("pc_doregister");doRegister.textContent=BlackCat.Main.langMgr.get("login_doRegister");doRegister.onclick=function(){_this50.remove();BlackCat.Main.viewMgr.change("RegisterView");};this.ObjAppend(divInput,doRegister);}},{key:'start',value:function start(){_get(LoginView.prototype.__proto__||Object.getPrototypeOf(LoginView.prototype),'start',this).call(this);this.inputAccount.focus();}},{key:'getPhone',value:function getPhone(){return BlackCat.Main.getPhone(this.selectArea.value,this.inputAccount.value);}},{key:'verifyAccount',value:function verifyAccount(){var account=this.inputAccount.value;if(!account||account.toString().length==0){return false;}return true;}},{key:'verifyPass',value:function verifyPass(){var pass=this.inputPass.value;if(!pass||pass.toString().length==0){return false;}return true;}},{key:'doLogin',value:function doLogin(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee55(){var _this51=this;var res,wallet_file;return regeneratorRuntime.wrap(function _callee55$(_context55){while(1){switch(_context55.prev=_context55.next){case 0:if(this.verifyAccount()){_context55.next=3;break;}BlackCat.Main.showErrMsg("login_input"+this.accountType+"_err",function(){_this51.inputAccount.focus();});return _context55.abrupt('return');case 3:_context55.next=5;return BlackCat.Main.validateFormat(this.accountType,this.inputAccount);case 5:_context55.t0=_context55.sent;if(!(_context55.t0==false)){_context55.next=8;break;}return _context55.abrupt('return');case 8:if(this.verifyPass()){_context55.next=11;break;}BlackCat.Main.showErrMsg("login_inputPass_err",function(){_this51.inputPass.focus();});return _context55.abrupt('return');case 11:_context55.t1=this.accountType;_context55.next=_context55.t1==='email'?14:_context55.t1==='phone'?18:_context55.t1==='user'?22:26;break;case 14:_context55.next=16;return BlackCat.ApiTool.emailLoginPass(this.inputAccount.value,this.inputPass.value);case 16:res=_context55.sent;return _context55.abrupt('break',27);case 18:_context55.next=20;return BlackCat.ApiTool.phoneLoginPass(this.getPhone(),this.inputPass.value);case 20:res=_context55.sent;return _context55.abrupt('break',27);case 22:_context55.next=24;return BlackCat.ApiTool.userLoginPass(this.inputAccount.value,this.inputPass.value);case 24:res=_context55.sent;return _context55.abrupt('break',27);case 26:return _context55.abrupt('return');case 27:if(!res.r){_context55.next=41;break;}localStorage.setItem(BlackCat.Main.user.cacheKey,JSON.stringify(res.data));BlackCat.Main.user.getInfo();if(!res.data.wallet){_context55.next=37;break;}_context55.next=33;return BlackCat.ApiTool.getWalletFile(res.data.uid,res.data.token);case 33:wallet_file=_context55.sent;if(wallet_file.r){localStorage.setItem(res.data.wallet,wallet_file.data);this.remove();BlackCat.Main.viewMgr.change("PayView");}else{BlackCat.Main.showErrMsg("login_walletDownloadFail");}_context55.next=39;break;case 37:this.remove();BlackCat.Main.viewMgr.change("WalletView");case 39:_context55.next=42;break;case 41:BlackCat.Main.showErrCode(res.errCode);case 42:case'end':return _context55.stop();}}},_callee55,this);}));}}]);return LoginView;}(BlackCat.ViewBase);BlackCat.LoginView=LoginView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var MainView=function(_BlackCat$ViewBase9){_inherits(MainView,_BlackCat$ViewBase9);function MainView(){_classCallCheck(this,MainView);return _possibleConstructorReturn(this,(MainView.__proto__||Object.getPrototypeOf(MainView)).apply(this,arguments));}_createClass(MainView,[{key:'start',value:function start(){if(this.isCreated===false){this.create();this.isCreated=true;this.bodyAppend(this.div);}}},{key:'create',value:function create(){this.div=this.objCreate("div");this.div.classList.add("pc_window");this.div.style.display="none";this.div.onclick=function(){event.stopPropagation();BlackCat.Main.setLiveTime();};}},{key:'createMask',value:function createMask(){if(!this.divMask){BlackCat.Main.viewMgr.change("IconView");this.divMask=this.objCreate("div");this.divMask.classList.add("pc_window_mask");this.divMask.onclick=function(){BlackCat.SDK.showIcon();};this.ObjAppend(this.div,this.divMask);}}},{key:'changNetType',value:function changNetType(){switch(BlackCat.Main.netMgr.type){case 1:this.div.classList.remove("pc_windowtest2");break;case 2:this.div.classList.add("pc_windowtest2");break;}}},{key:'remove',value:function remove(){this.bodyRemove(this.div);}},{key:'hidden',value:function hidden(){var _this53=this;this.div.classList.add("pc_windowhide");this.s_timeout_hidden=setTimeout(function(){_this53.div.style.display="none";},300);}},{key:'show',value:function show(){if(this.s_timeout_hidden)clearTimeout(this.s_timeout_hidden);this.div.classList.remove("pc_windowhide");this.div.style.display="";}}]);return MainView;}(BlackCat.ViewBase);BlackCat.MainView=MainView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ModifyAreaView=function(_BlackCat$ViewBase10){_inherits(ModifyAreaView,_BlackCat$ViewBase10);function ModifyAreaView(){_classCallCheck(this,ModifyAreaView);var _this54=_possibleConstructorReturn(this,(ModifyAreaView.__proto__||Object.getPrototypeOf(ModifyAreaView)).apply(this,arguments));_this54.AreaObj=BlackCat.AreaView.getAreaByLang(BlackCat.Main.langMgr.type);return _this54;}_createClass(ModifyAreaView,[{key:'create',value:function create(){var _this55=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_logoutwallet");var header=this.objCreate("div");header.classList.add("pc_header");this.ObjAppend(this.div,header);var returnA=this.objCreate("a");returnA.classList.add("iconfont","icon-fanhui");returnA.textContent=BlackCat.Main.langMgr.get("return");returnA.onclick=function(){_this55.return();};this.ObjAppend(header,returnA);var headerH1=this.objCreate("h1");headerH1.textContent=BlackCat.Main.langMgr.get("modifyArea");this.ObjAppend(header,headerH1);var divArea=this.objCreate("div");divArea.classList.add("pc_myinfolist");this.ObjAppend(this.div,divArea);var ulArea=this.objCreate("ul");this.ObjAppend(divArea,ulArea);var liveArea=BlackCat.Main.user.info.region;this.AreaObj.forEach(function(area){var liArea=_this55.objCreate("li");if(area.codename==liveArea){liArea.classList.add("pc_active");}liArea.textContent=BlackCat.Main.langMgr.get("area_code_"+area.codename);liArea.onclick=function(){_this55.doArea(area);};_this55.ObjAppend(ulArea,liArea);var iArea=_this55.objCreate("i");iArea.classList.add("iconfont","icon-gou");_this55.ObjAppend(liArea,iArea);});}},{key:'toRefer',value:function toRefer(){BlackCat.Main.viewMgr.myInfoView.show();}},{key:'doArea',value:function doArea(area){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee56(){var res;return regeneratorRuntime.wrap(function _callee56$(_context56){while(1){switch(_context56.prev=_context56.next){case 0:_context56.next=2;return BlackCat.ApiTool.modUserArea(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,area.codename);case 2:res=_context56.sent;if(res.r){BlackCat.Main.showToast("modifyArea_succ");BlackCat.Main.user.setInfo('region',area.codename);BlackCat.Main.viewMgr.myInfoView.modifyArea();this.return();}else{BlackCat.Main.showErrCode(res.errCode);}case 4:case'end':return _context56.stop();}}},_callee56,this);}));}}]);return ModifyAreaView;}(BlackCat.ViewBase);BlackCat.ModifyAreaView=ModifyAreaView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ModifyImgView=function(_BlackCat$ViewBase11){_inherits(ModifyImgView,_BlackCat$ViewBase11);function ModifyImgView(){_classCallCheck(this,ModifyImgView);return _possibleConstructorReturn(this,(ModifyImgView.__proto__||Object.getPrototypeOf(ModifyImgView)).call(this));}_createClass(ModifyImgView,[{key:'create',value:function create(){var _this57=this;this.div=this.objCreate("div");this.div.classList.add("pc_popup");var popupbox=this.objCreate('div');popupbox.classList.add("pc_popupbox");this.ObjAppend(this.div,popupbox);var popupTitle=this.objCreate('div');popupTitle.classList.add("pc_popup_title");popupTitle.innerText=BlackCat.Main.langMgr.get("modifyImg");this.ObjAppend(popupbox,popupTitle);var divImgBox=this.objCreate("div");divImgBox.classList.add("pc_modifyimg");this.ObjAppend(popupbox,divImgBox);this.divImg=this.objCreate("div");this.divImg.classList.add("pc_text_nowrap1");this.divImg.textContent=BlackCat.Main.langMgr.get("modifyImg_select");this.ObjAppend(divImgBox,this.divImg);this.inputImg=this.objCreate("input");this.inputImg.type="file";this.inputImg.accept="image/png,image/jpeg";this.inputImg.onchange=function(){_this57.changeInputImg();};this.ObjAppend(divImgBox,this.inputImg);this.displayImg=this.objCreate("img");this.ObjAppend(divImgBox,this.displayImg);var popupbutbox=this.objCreate('div');popupbutbox.classList.add("pc_popupbutbox");this.ObjAppend(popupbox,popupbutbox);var popupClose=this.objCreate('button');popupClose.classList.add("pc_cancel");popupClose.textContent=BlackCat.Main.langMgr.get("cancel");popupClose.onclick=function(){_this57.remove(300);};this.ObjAppend(popupbutbox,popupClose);var confirmObj=this.objCreate("button");confirmObj.textContent=BlackCat.Main.langMgr.get("ok");confirmObj.onclick=function(){_this57.doConfirm();};this.ObjAppend(popupbutbox,confirmObj);}},{key:'toRefer',value:function toRefer(){if(BlackCat.ModifySexView.refer){BlackCat.Main.viewMgr.change(BlackCat.ModifySexView.refer);BlackCat.ModifySexView.refer=null;}}},{key:'changeInputImg',value:function changeInputImg(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee57(){var _this58=this;var regex,current;return regeneratorRuntime.wrap(function _callee57$(_context57){while(1){switch(_context57.prev=_context57.next){case 0:this.filename="";this.reader=new FileReader();this.reader.onload=function(){_this58.divImg.textContent=_this58.filename;_this58.displayImg.src=_this58.reader.result.toString();_this58.displayImg.style.display="inline-block";};if(!(this.inputImg.files[0]!=undefined)){_context57.next=23;break;}if(!(this.inputImg.files[0].size>=102400)){_context57.next=11;break;}BlackCat.Main.showToast("modifyImg_selectSize_err");this.divImg.textContent=BlackCat.Main.langMgr.get("modifyImg_select");this.filename="";this.displayImg.src="";this.displayImg.style.display="none";return _context57.abrupt('return');case 11:regex=/\.(jpg|png|jpeg)+$/;current=regex.test(this.inputImg.files[0].name);if(current){_context57.next=20;break;}BlackCat.Main.showToast("modifyImg_selectType_err");this.divImg.textContent=BlackCat.Main.langMgr.get("modifyImg_select");this.filename="";this.displayImg.src="";this.displayImg.style.display="none";return _context57.abrupt('return');case 20:if(this.inputImg.files&&this.inputImg.files.length>0){this.filename=this.inputImg.files[0].name;this.reader.readAsDataURL(this.inputImg.files[0]);}else{this.divImg.textContent=BlackCat.Main.langMgr.get("modifyImg_select");this.filename="";this.displayImg.src="";this.displayImg.style.display="none";}_context57.next=27;break;case 23:this.divImg.textContent=BlackCat.Main.langMgr.get("modifyImg_select");this.filename="";this.displayImg.src="";this.displayImg.style.display="none";case 27:case'end':return _context57.stop();}}},_callee57,this);}));}},{key:'doConfirm',value:function doConfirm(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee58(){var regex,current,res;return regeneratorRuntime.wrap(function _callee58$(_context58){while(1){switch(_context58.prev=_context58.next){case 0:if(!(this.inputImg.files[0]!=undefined)){_context58.next=23;break;}if(!(this.inputImg.files[0].size>=102400)){_context58.next=4;break;}BlackCat.Main.showToast("modifyImg_select_err");return _context58.abrupt('return');case 4:regex=/\.(jpg|png|jpeg)+$/;current=regex.test(this.inputImg.files[0].name);if(current){_context58.next=9;break;}BlackCat.Main.showToast("modifyImg_select_err");return _context58.abrupt('return');case 9:BlackCat.Main.viewMgr.change("ViewLoading");_context58.prev=10;_context58.next=13;return BlackCat.ApiTool.modUserIcon(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,this.inputImg.files[0]);case 13:res=_context58.sent;_context58.next=19;break;case 16:_context58.prev=16;_context58.t0=_context58['catch'](10);console.log("[BlaCat]",'[ModifyImgView]','doConfirm, ApiTool.modUserIcon error => ',_context58.t0.toString());case 19:BlackCat.Main.viewMgr.viewLoading.remove();if(res.r){BlackCat.Main.showToast("modifyImg_succ");BlackCat.Main.user.setInfo('icon',res.data);this.remove();if(ModifyImgView.callback){ModifyImgView.callback();ModifyImgView.callback=null;}}else{BlackCat.Main.showErrCode(res.errCode);}_context58.next=24;break;case 23:BlackCat.Main.showToast("modifyImg_select_err");case 24:case'end':return _context58.stop();}}},_callee58,this,[[10,16]]);}));}}]);return ModifyImgView;}(BlackCat.ViewBase);BlackCat.ModifyImgView=ModifyImgView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ModifyNameView=function(_BlackCat$ViewBase12){_inherits(ModifyNameView,_BlackCat$ViewBase12);function ModifyNameView(){_classCallCheck(this,ModifyNameView);return _possibleConstructorReturn(this,(ModifyNameView.__proto__||Object.getPrototypeOf(ModifyNameView)).apply(this,arguments));}_createClass(ModifyNameView,[{key:'start',value:function start(){_get(ModifyNameView.prototype.__proto__||Object.getPrototypeOf(ModifyNameView.prototype),'start',this).call(this);this.inputName.focus();}},{key:'create',value:function create(){var _this60=this;this.div=this.objCreate("div");this.div.classList.add("pc_popup");var popupbox=this.objCreate('div');popupbox.classList.add("pc_popupbox");this.ObjAppend(this.div,popupbox);var popupTitle=this.objCreate('div');popupTitle.classList.add("pc_popup_title");popupTitle.innerText=BlackCat.Main.langMgr.get("modifyName");this.ObjAppend(popupbox,popupTitle);this.inputName=this.objCreate("input");this.inputName.type="text";this.inputName.style.marginTop="40px";this.inputName.placeholder=BlackCat.Main.langMgr.get("modifyName_input");this.ObjAppend(popupbox,this.inputName);var popupbutbox=this.objCreate('div');popupbutbox.classList.add("pc_popupbutbox");this.ObjAppend(popupbox,popupbutbox);var popupClose=this.objCreate('button');popupClose.classList.add("pc_cancel");popupClose.textContent=BlackCat.Main.langMgr.get("cancel");popupClose.onclick=function(){_this60.remove(300);};this.ObjAppend(popupbutbox,popupClose);var confirmObj=this.objCreate("button");confirmObj.textContent=BlackCat.Main.langMgr.get("ok");confirmObj.onclick=function(){_this60.doConfirm();};this.ObjAppend(popupbutbox,confirmObj);}},{key:'toRefer',value:function toRefer(){if(ModifyNameView.refer){BlackCat.Main.viewMgr.change(ModifyNameView.refer);ModifyNameView.refer=null;}}},{key:'doConfirm',value:function doConfirm(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee59(){var res;return regeneratorRuntime.wrap(function _callee59$(_context59){while(1){switch(_context59.prev=_context59.next){case 0:if(this.inputName.value){_context59.next=3;break;}this.inputName.focus();return _context59.abrupt('return');case 3:_context59.next=5;return BlackCat.ApiTool.modUserName(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,this.inputName.value);case 5:res=_context59.sent;if(res.r){BlackCat.Main.showToast("modifyName_succ");BlackCat.Main.user.setInfo('name',this.inputName.value);this.remove();if(ModifyNameView.callback){ModifyNameView.callback();ModifyNameView.callback=null;}}else{BlackCat.Main.showErrCode(res.errCode);}case 7:case'end':return _context59.stop();}}},_callee59,this);}));}}]);return ModifyNameView;}(BlackCat.ViewBase);BlackCat.ModifyNameView=ModifyNameView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ModifyNetworkLineView=function(_BlackCat$ViewBase13){_inherits(ModifyNetworkLineView,_BlackCat$ViewBase13);function ModifyNetworkLineView(){_classCallCheck(this,ModifyNetworkLineView);return _possibleConstructorReturn(this,(ModifyNetworkLineView.__proto__||Object.getPrototypeOf(ModifyNetworkLineView)).apply(this,arguments));}_createClass(ModifyNetworkLineView,[{key:'create',value:function create(){var _this62=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_moifynet");var header=this.objCreate("div");header.classList.add("pc_header");this.ObjAppend(this.div,header);var returnA=this.objCreate("a");returnA.classList.add("iconfont","icon-fanhui");returnA.textContent=BlackCat.Main.langMgr.get("return");returnA.onclick=function(){_this62.return();};this.ObjAppend(header,returnA);var headerH1=this.objCreate("h1");headerH1.textContent=BlackCat.Main.langMgr.get("modifyNet");this.ObjAppend(header,headerH1);this.divTypes=this.objCreate("div");this.divTypes.classList.add("pc_divnettype");this.netType_nodes=this.objCreate("button");this.netType_nodes.textContent="BlockAPI";this.netType_nodes.classList.add("pc_active");if(ModifyNetworkLineView.defaultType=="nodes"){this.netType_nodes.classList.add("pc_active");}this.netType_nodes.onclick=function(){_this62.showNodeInfo("nodes",1);};this.ObjAppend(this.divTypes,this.netType_nodes);this.netType_clis=this.objCreate("button");this.netType_clis.textContent="NeoCli";if(ModifyNetworkLineView.defaultType=="clis"){this.netType_nodes.classList.remove("pc_active");this.netType_clis.classList.add("pc_active");}this.netType_clis.onclick=function(){_this62.showNodeInfo("clis",1);};this.ObjAppend(this.divTypes,this.netType_clis);this.ObjAppend(this.div,this.divTypes);this.divLists=this.objCreate("div");this.divLists.classList.add("pc_myinfolist");this.ObjAppend(this.div,this.divLists);this.showNodeInfo(ModifyNetworkLineView.defaultType);}},{key:'toRefer',value:function toRefer(){if(ModifyNetworkLineView.refer){BlackCat.Main.viewMgr.change(ModifyNetworkLineView.refer);ModifyNetworkLineView.refer=null;}}},{key:'showNodeInfo',value:function showNodeInfo(type){var _this63=this;var clear=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var currNodeInfo=BlackCat.Main.netMgr.getCurrNodeInfo(type);if(currNodeInfo){this.divTypes.getElementsByClassName("pc_active")[0].classList.remove("pc_active");this["netType_"+type].classList.add("pc_active");if(clear==1){this.divLists.innerHTML="";}var ulNet=this.objCreate("ul");this.ObjAppend(this.divLists,ulNet);var nodeLists=BlackCat.Main.netMgr.getNodeLists(type);nodeLists.forEach(function(nodelist){var li=_this63.objCreate("li");if(nodelist[1]==currNodeInfo[1]){li.classList.add("pc_active");}_this63.ObjAppend(ulNet,li);var divArea=_this63.objCreate("div");divArea.classList.add("pc_mmyinfoarea");divArea.textContent=_this63.getNodeName(nodelist);_this63.ObjAppend(li,divArea);var divHeight=_this63.objCreate("div");if(type=="nodes"){divHeight.classList.add("pc_payheighet","iconfont","icon-blalian");}if(type=="clis"){divHeight.classList.add("pc_payheighet","iconfont","icon-neolian");}divHeight.textContent="n/a";_this63.ObjAppend(li,divHeight);var iArea=_this63.objCreate("i");iArea.classList.add("iconfont","icon-gou");_this63.ObjAppend(li,iArea);_this63.getHeight(type,nodelist,divHeight,li,currNodeInfo);});}else{}}},{key:'doChange',value:function doChange(type,nodelist,height){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee60(){return regeneratorRuntime.wrap(function _callee60$(_context60){while(1){switch(_context60.prev=_context60.next){case 0:BlackCat.Main.netMgr.setNode(type,nodelist[1]);BlackCat.Main.showToast("modifyNet_succ");BlackCat.Main.viewMgr.payView.updateHeight(type,height);if(ModifyNetworkLineView.refer=="MyInfoView"){BlackCat.Main.viewMgr.myInfoView.updateNodeInfo();}this.return();case 5:case'end':return _context60.stop();}}},_callee60,this);}));}},{key:'getNodeName',value:function getNodeName(nodeInfo){var content=BlackCat.Main.langMgr.get("area_code_"+nodeInfo[0]);if(nodeInfo[2]){content+=nodeInfo[2];}return content;}},{key:'getHeight',value:function getHeight(type,nodelist,element,li,currNodeInfo){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee61(){var _this64=this;var height;return regeneratorRuntime.wrap(function _callee61$(_context61){while(1){switch(_context61.prev=_context61.next){case 0:_context61.prev=0;_context61.next=3;return BlackCat.tools.WWW["api_getHeight_"+type](nodelist[1]);case 3:height=_context61.sent;if(!(height>0)){_context61.next=9;break;}element.textContent=height.toString();if(nodelist[1]!=currNodeInfo[1]){li.onclick=function(){_this64.doChange(type,nodelist,height);};}if(nodelist[1]==currNodeInfo[1]){BlackCat.Main.viewMgr.payView.updateHeight(type,height);if(ModifyNetworkLineView.refer=="MyInfoView"){BlackCat.Main.viewMgr.myInfoView.updateNodeInfo();}}return _context61.abrupt('return');case 9:_context61.next=13;break;case 11:_context61.prev=11;_context61.t0=_context61['catch'](0);case 13:li.onclick=function(){BlackCat.Main.showErrMsg("modifyNet_node_err");};case 14:case'end':return _context61.stop();}}},_callee61,this,[[0,11]]);}));}}]);return ModifyNetworkLineView;}(BlackCat.ViewBase);ModifyNetworkLineView.defaultType="nodes";BlackCat.ModifyNetworkLineView=ModifyNetworkLineView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ModifySexView=function(_BlackCat$ViewBase14){_inherits(ModifySexView,_BlackCat$ViewBase14);function ModifySexView(){_classCallCheck(this,ModifySexView);return _possibleConstructorReturn(this,(ModifySexView.__proto__||Object.getPrototypeOf(ModifySexView)).apply(this,arguments));}_createClass(ModifySexView,[{key:'create',value:function create(){var _this66=this;this.div=this.objCreate("div");this.div.classList.add("pc_popup");var popupbox=this.objCreate('div');popupbox.classList.add("pc_popupbox");this.ObjAppend(this.div,popupbox);var popupTitle=this.objCreate('div');popupTitle.classList.add("pc_popup_title");popupTitle.innerText=BlackCat.Main.langMgr.get("modifySex");this.ObjAppend(popupbox,popupTitle);this.divSex=this.objCreate("div");this.divSex.classList.add("pc_modifysex");this.ObjAppend(popupbox,this.divSex);this.inputSex1Obj=this.objCreate("div");this.inputSex1Obj.classList.add("iconfont","icon-nan1");this.ObjAppend(this.divSex,this.inputSex1Obj);var inputSex1=this.objCreate("input");inputSex1.setAttribute("type","radio");inputSex1.setAttribute("value","1");inputSex1.setAttribute("name","pc_sex");inputSex1.onclick=function(){_this66.inputSex1Obj.classList.add("pc_modifysex_active");_this66.inputSex2Obj.classList.remove("pc_modifysex_active");};if(BlackCat.Main.user.info.sex=="1"){inputSex1.setAttribute("checked","true");this.inputSex1Obj.classList.add("pc_modifysex_active");}this.ObjAppend(this.inputSex1Obj,inputSex1);this.inputSex2Obj=this.objCreate("div");this.inputSex2Obj.classList.add("iconfont","icon-nv1");this.ObjAppend(this.divSex,this.inputSex2Obj);var inputSex2=this.objCreate("input");inputSex2.setAttribute("type","radio");inputSex2.setAttribute("value","2");inputSex2.setAttribute("name","pc_sex");inputSex2.onclick=function(){_this66.inputSex2Obj.classList.add("pc_modifysex_active");_this66.inputSex1Obj.classList.remove("pc_modifysex_active");};if(BlackCat.Main.user.info.sex=="2"){inputSex2.setAttribute("checked","true");this.inputSex2Obj.classList.add("pc_modifysex_active");}this.ObjAppend(this.inputSex2Obj,inputSex2);var popupbutbox=this.objCreate('div');popupbutbox.classList.add("pc_popupbutbox");this.ObjAppend(popupbox,popupbutbox);var popupClose=this.objCreate('button');popupClose.classList.add("pc_cancel");popupClose.textContent=BlackCat.Main.langMgr.get("cancel");popupClose.onclick=function(){_this66.remove(300);};this.ObjAppend(popupbutbox,popupClose);var confirmObj=this.objCreate("button");confirmObj.textContent=BlackCat.Main.langMgr.get("ok");confirmObj.onclick=function(){_this66.doConfirm();};this.ObjAppend(popupbutbox,confirmObj);}},{key:'toRefer',value:function toRefer(){if(ModifySexView.refer){BlackCat.Main.viewMgr.change(ModifySexView.refer);ModifySexView.refer=null;}}},{key:'doConfirm',value:function doConfirm(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee62(){var sexInputObj,i,sexValue,res;return regeneratorRuntime.wrap(function _callee62$(_context62){while(1){switch(_context62.prev=_context62.next){case 0:sexInputObj=this.divSex.getElementsByTagName("input");i=0;case 2:if(!(i<sexInputObj.length)){_context62.next=13;break;}if(!sexInputObj[i].checked){_context62.next=10;break;}sexValue=sexInputObj[i].value;_context62.next=7;return BlackCat.ApiTool.modUserSex(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,sexValue);case 7:res=_context62.sent;if(res.r){BlackCat.Main.showToast("modifySex_succ");BlackCat.Main.user.setInfo('sex',sexValue);this.remove();if(ModifySexView.callback){ModifySexView.callback();ModifySexView.callback=null;}}else{BlackCat.Main.showErrCode(res.errCode);}return _context62.abrupt('return',sexValue);case 10:i++;_context62.next=2;break;case 13:case'end':return _context62.stop();}}},_callee62,this);}));}}]);return ModifySexView;}(BlackCat.ViewBase);BlackCat.ModifySexView=ModifySexView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var MyInfoView=function(_BlackCat$ViewBase15){_inherits(MyInfoView,_BlackCat$ViewBase15);function MyInfoView(){_classCallCheck(this,MyInfoView);return _possibleConstructorReturn(this,(MyInfoView.__proto__||Object.getPrototypeOf(MyInfoView)).apply(this,arguments));}_createClass(MyInfoView,[{key:'create',value:function create(){var _this68=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_myinfo");var header=this.objCreate("div");header.classList.add("pc_header");this.ObjAppend(this.div,header);var returnA=this.objCreate("a");returnA.classList.add("iconfont","icon-fanhui");returnA.textContent=BlackCat.Main.langMgr.get("return");returnA.onclick=function(){_this68.return();};this.ObjAppend(header,returnA);var headerH1=this.objCreate("h1");headerH1.textContent=BlackCat.Main.langMgr.get("myInfo");this.ObjAppend(header,headerH1);var myinfo=this.objCreate("div");myinfo.classList.add("pc_myinfolist");var ulMyinfo=this.objCreate("ul");this.ObjAppend(myinfo,ulMyinfo);var liMyinfoImg=this.objCreate("li");liMyinfoImg.classList.add("pc_myinfoimg");liMyinfoImg.onclick=function(){_this68.modifyImg();};liMyinfoImg.textContent=BlackCat.Main.langMgr.get("myinfo_headImg");var iMyinfoimg=this.objCreate("i");iMyinfoimg.classList.add("iconfont","icon-gengduo");this.ObjAppend(liMyinfoImg,iMyinfoimg);var spanMyinfoimg=this.objCreate("span");this.ObjAppend(liMyinfoImg,spanMyinfoimg);this.myImg=this.objCreate("img");this.myImg.setAttribute("src",this.getImg());this.ObjAppend(spanMyinfoimg,this.myImg);this.ObjAppend(ulMyinfo,liMyinfoImg);var liMyinfoName=this.objCreate("li");liMyinfoName.textContent=BlackCat.Main.langMgr.get("myinfo_nickname");liMyinfoName.onclick=function(){_this68.modifyName();};this.ObjAppend(ulMyinfo,liMyinfoName);var iMyinfoName=this.objCreate("i");iMyinfoName.classList.add("iconfont","icon-gengduo");this.ObjAppend(liMyinfoName,iMyinfoName);this.myName=this.objCreate("span");this.myName.textContent=this.getName();this.ObjAppend(liMyinfoName,this.myName);var liMyinfoSex=this.objCreate("li");liMyinfoSex.textContent=BlackCat.Main.langMgr.get("myinfo_sex");liMyinfoSex.onclick=function(){_this68.modifySex();};var iMyinfoSex=this.objCreate("i");iMyinfoSex.classList.add("iconfont","icon-gengduo");this.ObjAppend(liMyinfoSex,iMyinfoSex);this.mySex=this.objCreate("span");this.mySex.textContent=this.getSex();this.ObjAppend(liMyinfoSex,this.mySex);this.ObjAppend(ulMyinfo,liMyinfoSex);var liMyinfoUid=this.objCreate("li");liMyinfoUid.style.cursor="Default";liMyinfoUid.textContent=BlackCat.Main.langMgr.get("myinfo_uid");this.ObjAppend(ulMyinfo,liMyinfoUid);var spanMyinfoUid=this.objCreate("span");spanMyinfoUid.textContent=this.getUid();this.ObjAppend(liMyinfoUid,spanMyinfoUid);var liMyinfoArea=this.objCreate("li");liMyinfoArea.textContent=BlackCat.Main.langMgr.get("myinfo_area");liMyinfoArea.onclick=function(){_this68.hidden();BlackCat.Main.viewMgr.change("ModifyAreaView");};this.ObjAppend(ulMyinfo,liMyinfoArea);var iMyinfoArea=this.objCreate("i");iMyinfoArea.classList.add("iconfont","icon-gengduo");this.ObjAppend(liMyinfoArea,iMyinfoArea);this.myArea=this.objCreate("span");this.myArea.textContent=this.getArea();this.ObjAppend(liMyinfoArea,this.myArea);var liMyinfoNet=this.objCreate("li");liMyinfoNet.textContent=BlackCat.Main.langMgr.get("modifyNet");liMyinfoNet.onclick=function(){_this68.hidden();BlackCat.ModifyNetworkLineView.refer="MyInfoView";BlackCat.ModifyNetworkLineView.defaultType="nodes";BlackCat.Main.viewMgr.change("ModifyNetworkLineView");};this.ObjAppend(ulMyinfo,liMyinfoNet);var iMyinfoNet=this.objCreate("i");iMyinfoNet.classList.add("iconfont","icon-gengduo");this.ObjAppend(liMyinfoNet,iMyinfoNet);var spanNet_nodes=this.objCreate("span");this.ObjAppend(liMyinfoNet,spanNet_nodes);spanNet_nodes.classList.add("pc_spannet");this.myNet_nodes=this.objCreate("div");this.myNet_nodes.textContent="BlockAPI";this.ObjAppend(spanNet_nodes,this.myNet_nodes);this.divHeight_nodes=this.objCreate("div");this.divHeight_nodes.classList.add("iconfont","icon-blalian");this.divHeight_nodes.textContent="n/a";this.ObjAppend(spanNet_nodes,this.divHeight_nodes);var spanNet_clis=this.objCreate("span");this.ObjAppend(liMyinfoNet,spanNet_clis);spanNet_clis.classList.add("pc_spannet","pc_spannet_clis");this.myNet_clis=this.objCreate("div");this.myNet_clis.textContent="NeoCli";this.ObjAppend(spanNet_clis,this.myNet_clis);this.divHeight_clis=this.objCreate("div");this.divHeight_clis.classList.add("iconfont","icon-neolian");this.divHeight_clis.textContent="n/a";this.ObjAppend(spanNet_clis,this.divHeight_clis);var liMyinfoTrust=this.objCreate("li");liMyinfoTrust.textContent=BlackCat.Main.langMgr.get("myinfo_security");liMyinfoTrust.onclick=function(){_this68.hidden();BlackCat.Main.viewMgr.change("SecurityCenterView");};this.ObjAppend(ulMyinfo,liMyinfoTrust);var iMyinfoTrust=this.objCreate("i");iMyinfoTrust.classList.add("iconfont","icon-gengduo");this.ObjAppend(liMyinfoTrust,iMyinfoTrust);var spanMyinfoTrust=this.objCreate("span");spanMyinfoTrust.textContent=BlackCat.Main.langMgr.get("myinfo_set");this.ObjAppend(liMyinfoTrust,spanMyinfoTrust);var logout=this.objCreate("button");logout.textContent=BlackCat.Main.langMgr.get("myinfo_logout");logout.onclick=function(){_this68.doLogout();};this.ObjAppend(myinfo,logout);this.ObjAppend(this.div,myinfo);this.getNodeHeight("nodes");this.getNodeHeight("clis");}},{key:'toRefer',value:function toRefer(){if(MyInfoView.refer){BlackCat.Main.viewMgr.change(MyInfoView.refer);MyInfoView.refer=null;}}},{key:'getImg',value:function getImg(){return BlackCat.Main.user.info.icon?BlackCat.Main.user.info.icon:BlackCat.Main.resHost+"res/img/game0.png";}},{key:'getName',value:function getName(){return BlackCat.Main.user.info.name;}},{key:'getUid',value:function getUid(){return BlackCat.Main.user.info.uid;}},{key:'getSex',value:function getSex(){return BlackCat.Main.langMgr.get("myinfo_sex_"+BlackCat.Main.user.info.sex);}},{key:'getArea',value:function getArea(){return BlackCat.Main.langMgr.get("area_code_"+BlackCat.Main.user.info.region)?BlackCat.Main.langMgr.get("area_code_"+BlackCat.Main.user.info.region):BlackCat.Main.langMgr.get("modifyArea_empty");}},{key:'doLogout',value:function doLogout(){var _this69=this;BlackCat.ViewConfirm.callback=function(){_this69.makeLogout();};BlackCat.Main.showConFirm("myinfo_logoutConfirm");}},{key:'makeLogout',value:function makeLogout(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee63(){return regeneratorRuntime.wrap(function _callee63$(_context63){while(1){switch(_context63.prev=_context63.next){case 0:BlackCat.Main.user.logout();BlackCat.Main.viewMgr.removeAll();BlackCat.Main.viewMgr.change("LoginView");BlackCat.Main.logoutCallback();case 4:case'end':return _context63.stop();}}},_callee63,this);}));}},{key:'modifyImg',value:function modifyImg(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee64(){var _this70=this;return regeneratorRuntime.wrap(function _callee64$(_context64){while(1){switch(_context64.prev=_context64.next){case 0:BlackCat.ModifyImgView.callback=function(){_this70.myImg.src=_this70.getImg();};BlackCat.Main.viewMgr.change("ModifyImgView");case 2:case'end':return _context64.stop();}}},_callee64,this);}));}},{key:'modifyName',value:function modifyName(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee65(){var _this71=this;return regeneratorRuntime.wrap(function _callee65$(_context65){while(1){switch(_context65.prev=_context65.next){case 0:BlackCat.ModifyNameView.callback=function(){_this71.myName.textContent=_this71.getName();BlackCat.Main.viewMgr.payView.payMyWallet.textContent=_this71.getName();};BlackCat.Main.viewMgr.change("ModifyNameView");case 2:case'end':return _context65.stop();}}},_callee65,this);}));}},{key:'modifySex',value:function modifySex(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee66(){var _this72=this;return regeneratorRuntime.wrap(function _callee66$(_context66){while(1){switch(_context66.prev=_context66.next){case 0:BlackCat.ModifySexView.callback=function(){_this72.mySex.textContent=_this72.getSex();};BlackCat.Main.viewMgr.change("ModifySexView");case 2:case'end':return _context66.stop();}}},_callee66,this);}));}},{key:'modifyArea',value:function modifyArea(){this.myArea.textContent=this.getArea();}},{key:'getNodeHeight',value:function getNodeHeight(type){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee67(){var height;return regeneratorRuntime.wrap(function _callee67$(_context67){while(1){switch(_context67.prev=_context67.next){case 0:height=BlackCat.Main.viewMgr.payView["height_"+type].toString();if(height>0){this["divHeight_"+type].textContent=height==0?"n/a":height;}case 2:case'end':return _context67.stop();}}},_callee67,this);}));}},{key:'updateNodeInfo',value:function updateNodeInfo(){this.getNodeHeight("nodes");if(BlackCat.tools.WWW.api_clis&&BlackCat.tools.WWW.api_clis!=""){this.getNodeHeight("clis");}}}]);return MyInfoView;}(BlackCat.ViewBase);BlackCat.MyInfoView=MyInfoView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var PayExchangeDetailView=function(_BlackCat$ViewBase16){_inherits(PayExchangeDetailView,_BlackCat$ViewBase16);function PayExchangeDetailView(){_classCallCheck(this,PayExchangeDetailView);return _possibleConstructorReturn(this,(PayExchangeDetailView.__proto__||Object.getPrototypeOf(PayExchangeDetailView)).apply(this,arguments));}_createClass(PayExchangeDetailView,[{key:'create',value:function create(){var _this74=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_exchangedetail");var header=this.objCreate("div");header.classList.add("pc_header");this.ObjAppend(this.div,header);var returnA=this.objCreate("a");returnA.classList.add("iconfont","icon-fanhui");returnA.textContent=BlackCat.Main.langMgr.get("return");returnA.onclick=function(){_this74.return();};this.ObjAppend(header,returnA);var headerH1=this.objCreate("h1");headerH1.textContent=BlackCat.Main.langMgr.get("pay_exchange_gas");this.ObjAppend(header,headerH1);var divExchange=this.objCreate("div");divExchange.classList.add("pc_exchangetitle");this.ObjAppend(this.div,divExchange);var divEcvhangeObj=this.objCreate("div");divEcvhangeObj.classList.add("pc_exchangelist");this.ObjAppend(divExchange,divEcvhangeObj);var divExchangeName=this.objCreate("div");divExchangeName.classList.add("pc_exchangename");var labelExchangeName=this.objCreate("label");labelExchangeName.textContent="Bla Cat";this.ObjAppend(divExchangeName,labelExchangeName);var pExchangeName=this.objCreate("p");pExchangeName.textContent="GAS/NEO";this.ObjAppend(divExchangeName,pExchangeName);this.ObjAppend(divEcvhangeObj,divExchangeName);var divNewPrice=this.objCreate("div");divNewPrice.classList.add("pc_exchangeprice");var divNewPriceName=this.objCreate("label");divNewPriceName.textContent=BlackCat.Main.langMgr.get("pay_exchange_price");this.ObjAppend(divNewPrice,divNewPriceName);var pNewPrice=this.objCreate("p");pNewPrice.textContent="1111111111111";this.ObjAppend(divNewPrice,pNewPrice);this.ObjAppend(divEcvhangeObj,divNewPrice);var divBalance=this.objCreate("div");divBalance.classList.add("pc_exchangeprice");var labelBalanceName=this.objCreate("label");labelBalanceName.textContent=BlackCat.Main.langMgr.get("pay_exchange_price");this.ObjAppend(divBalance,labelBalanceName);var pBalance=this.objCreate("p");pBalance.textContent="1111111111111";this.ObjAppend(divBalance,pBalance);this.ObjAppend(divEcvhangeObj,divBalance);var divGas=this.objCreate("div");divGas.classList.add("pc_exc_purchases");var divConsume=this.objCreate("div");divConsume.classList.add("pc_exc_consume");divConsume.textContent="NEO消耗";this.ObjAppend(divGas,divConsume);var aConsume=this.objCreate("a");aConsume.textContent="NEO不足?";this.ObjAppend(divConsume,aConsume);var divGasObj=this.objCreate("div");divGasObj.classList.add("pc_exc_inputpurchases");divGasObj.textContent="GAS";this.ObjAppend(divGas,divGasObj);this.inputGas=this.objCreate("input");this.inputGas.placeholder="输入购买数量";this.ObjAppend(divGasObj,this.inputGas);var btnGas=this.objCreate("button");btnGas.textContent="确认购买";this.ObjAppend(divGasObj,btnGas);this.ObjAppend(this.div,divGas);var divObj=this.objCreate("div");divObj.classList.add("pc_addressbookdet");this.ObjAppend(this.div,divObj);var divAddressTitle=this.objCreate("div");divAddressTitle.classList.add("pc_addresstitle");this.ObjAppend(divObj,divAddressTitle);var labelAddressTitle=this.objCreate("label");labelAddressTitle.textContent=BlackCat.Main.langMgr.get("addressbook_det_address");this.ObjAppend(divAddressTitle,labelAddressTitle);var butCopy=this.objCreate("button");butCopy.textContent=BlackCat.Main.langMgr.get("copy");butCopy.onclick=function(){var inputCooy=_this74.objCreate("input");inputCooy.value=_this74.divAddress.innerText;_this74.ObjAppend(divObj,inputCooy);inputCooy.select();document.execCommand("Copy");inputCooy.remove();BlackCat.Main.showToast("pc_receivables_copy",1500);};this.ObjAppend(divAddressTitle,butCopy);var butMakeTransfer=this.objCreate("button");butMakeTransfer.textContent=BlackCat.Main.langMgr.get("addressbook_det_transfer");butMakeTransfer.onclick=function(){_this74.doMakeTransfer();};this.ObjAppend(divAddressTitle,butMakeTransfer);this.divAddress=this.objCreate("div");this.divAddress.classList.add("pc_receivables");this.ObjAppend(divObj,this.divAddress);var divQRCode=this.objCreate("div");divQRCode.classList.add("pc_qrcode");this.ObjAppend(divObj,divQRCode);var qrObj=this.objCreate("img");QrCodeWithLogo.toImage({image:qrObj,content:55}).then(function(){var url=URL.createObjectURL(_this74.base64ToBlob(qrObj.src));qr_download.setAttribute('href',url);qr_download.setAttribute("download",555+".png");});this.ObjAppend(divQRCode,qrObj);var qr_download=this.objCreate("a");qr_download.classList.add("iconfont","icon-xiazai");qr_download.textContent=BlackCat.Main.langMgr.get("addressbook_det_download");this.ObjAppend(divQRCode,qr_download);var divDescribeTitle=this.objCreate("div");divDescribeTitle.classList.add("pc_addresstitle");divDescribeTitle.textContent=BlackCat.Main.langMgr.get("addressbook_det_describe");this.ObjAppend(divObj,divDescribeTitle);var divDescribeText=this.objCreate("div");divDescribeText.classList.add("pc_describetext");this.ObjAppend(divObj,divDescribeText);}},{key:'toRefer',value:function toRefer(){if(PayExchangeDetailView.refer){BlackCat.Main.viewMgr.change(PayExchangeDetailView.refer);PayExchangeDetailView.refer=null;}}},{key:'doMakeTransfer',value:function doMakeTransfer(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee68(){var _this75=this;return regeneratorRuntime.wrap(function _callee68$(_context68){while(1){switch(_context68.prev=_context68.next){case 0:if(BlackCat.Main.isWalletOpen()){BlackCat.PayTransferView.callback=function(){BlackCat.Main.viewMgr.payView.doGetWalletLists(1);};BlackCat.Main.viewMgr.change("PayTransferView");}else{BlackCat.ViewWalletOpen.callback=function(){_this75.doMakeTransfer();};BlackCat.Main.viewMgr.change("ViewWalletOpen");}case 1:case'end':return _context68.stop();}}},_callee68,this);}));}},{key:'base64ToBlob',value:function base64ToBlob(code){var parts=code.split(';base64,');var contentType=parts[0].split(':')[1];var raw=window.atob(parts[1]);var rawLength=raw.length;var uInt8Array=new Uint8Array(rawLength);for(var i=0;i<rawLength;++i){uInt8Array[i]=raw.charCodeAt(i);}return new Blob([uInt8Array],{type:contentType});}}]);return PayExchangeDetailView;}(BlackCat.ViewBase);BlackCat.PayExchangeDetailView=PayExchangeDetailView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var PayExchangeView=function(_BlackCat$ViewBase17){_inherits(PayExchangeView,_BlackCat$ViewBase17);function PayExchangeView(){_classCallCheck(this,PayExchangeView);return _possibleConstructorReturn(this,(PayExchangeView.__proto__||Object.getPrototypeOf(PayExchangeView)).apply(this,arguments));}_createClass(PayExchangeView,[{key:'create',value:function create(){var _this77=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj");var header=this.objCreate("div");header.classList.add("pc_header");this.ObjAppend(this.div,header);var returnA=this.objCreate("a");returnA.classList.add("iconfont","icon-fanhui");returnA.textContent=BlackCat.Main.langMgr.get("return");returnA.onclick=function(){_this77.return();};this.ObjAppend(header,returnA);var headerH1=this.objCreate("h1");headerH1.textContent=BlackCat.Main.langMgr.get("pay_exchange_gas");this.ObjAppend(header,headerH1);this.exchange_type_buy=this.objCreate("div");this.exchange_type_buy.classList.add("pc_exchangetitle");this.ObjAppend(this.div,this.exchange_type_buy);this.exchange_detail=this.objCreate("div");this.exchange_detail.classList.add("pc_exchangelist");this.ObjAppend(this.div,this.exchange_detail);this.getExchangeInfo(0);}},{key:'reset',value:function reset(){this.exchange_type_buy=null;this.exchange_typeObj=null;this.exchange_buyObj=null;this.exchange_detail=null;this.exchange_detail_ul=null;this.exchange_info=null;this.exchange_coin_type=null;this.exchange_coin_name=null;}},{key:'toRefer',value:function toRefer(){if(PayExchangeView.refer){BlackCat.Main.viewMgr.change(PayExchangeView.refer);PayExchangeView.refer=null;}}},{key:'getExchangeInfo',value:function getExchangeInfo(src_coin){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee69(){var res,data;return regeneratorRuntime.wrap(function _callee69$(_context69){while(1){switch(_context69.prev=_context69.next){case 0:_context69.prev=0;_context69.next=3;return BlackCat.ApiTool.getExchangeInfo(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,src_coin);case 3:res=_context69.sent;if(res.r){data=res.data;console.log("[BlaCat]",'[PayExchangeView]','getExchangeInfo, data =>',data);if(data&&data.hasOwnProperty("info")&&data.hasOwnProperty("coin")&&data.hasOwnProperty("jys")){this.exchange_info=data;this.showExchangeInfo();}}else{BlackCat.Main.showErrCode(res.errCode);}_context69.next=9;break;case 7:_context69.prev=7;_context69.t0=_context69['catch'](0);case 9:case'end':return _context69.stop();}}},_callee69,this,[[0,7]]);}));}},{key:'showExchangeInfo',value:function showExchangeInfo(){console.log("[BlaCat]",'[PayExchangeView]','showExchangeInfo ...');this.exchange_coin_type=this.exchange_info.coin[0][0];this.showCoinType();this.showBuy();this.showDetail();}},{key:'showCoinType',value:function showCoinType(){var _this78=this;this.exchange_typeObj=this.objCreate("ul");this.ObjAppend(this.exchange_type_buy,this.exchange_typeObj);this.exchange_info.coin.forEach(function(list){var coinType_li=_this78.objCreate("li");coinType_li.textContent=list[1];if(Number(list[0])==_this78.exchange_coin_type){coinType_li.classList.add("pc_active");_this78.exchange_coin_name=list[1];}coinType_li.onclick=function(){_this78.exchange_typeObj.getElementsByClassName("pc_active")[0].classList.remove("pc_active");coinType_li.classList.add("pc_active");_this78.setExchangeCoinTypeInfo(Number(list[0]));_this78.showBuy(1);_this78.showDetail(1);};_this78.ObjAppend(_this78.exchange_typeObj,coinType_li);});}},{key:'showBuy',value:function showBuy(){var _this79=this;var clear=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(this.exchange_buyObj&&clear==1){this.objRemove(this.exchange_type_buy,this.exchange_buyObj);}this.exchange_buyObj=this.objCreate("div");this.exchange_buyObj.classList.add("pc_exchangelist");this.ObjAppend(this.exchange_type_buy,this.exchange_buyObj);var buyObj_name=this.objCreate("div");buyObj_name.classList.add("pc_exchangename");var buyObj_name_img=this.objCreate("img");buyObj_name_img.src=BlackCat.Main.resHost+"res/img/game0.png";this.ObjAppend(buyObj_name,buyObj_name_img);var buyObj_name_content=this.objCreate("label");buyObj_name_content.textContent="Bla Cat";this.ObjAppend(buyObj_name,buyObj_name_content);var buyObj_name_type=this.objCreate("p");buyObj_name_type.textContent="GAS/"+this.exchange_coin_name;this.ObjAppend(buyObj_name,buyObj_name_type);this.ObjAppend(this.exchange_buyObj,buyObj_name);var buyObj_price=this.objCreate("div");buyObj_price.classList.add("pc_exchangeprice");var buyObj_price_name=this.objCreate("label");buyObj_price_name.textContent=BlackCat.Main.langMgr.get("pay_exchange_price");this.ObjAppend(buyObj_price,buyObj_price_name);var buyObj_price_price=this.objCreate("p");buyObj_price_price.textContent=BlackCat.floatNum.addZero(this.getCurr(),8);this.ObjAppend(buyObj_price,buyObj_price_price);this.ObjAppend(this.exchange_buyObj,buyObj_price);var buyObj_buy=this.objCreate("div");buyObj_buy.classList.add("pc_exchangerange");var buyObj_buy_btn=this.objCreate("button");buyObj_buy_btn.textContent=BlackCat.Main.langMgr.get("pay_exchange_purchase");buyObj_buy_btn.onclick=function(){_this79.hidden();BlackCat.PayExchangeDetailView.refer="PayExchangeView";BlackCat.Main.viewMgr.change("PayExchangeDetailView");};this.ObjAppend(buyObj_buy,buyObj_buy_btn);this.ObjAppend(this.exchange_buyObj,buyObj_buy);}},{key:'showDetail',value:function showDetail(){var _this80=this;var clear=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(this.exchange_detail_ul&&clear==1){this.objRemove(this.exchange_detail,this.exchange_detail_ul);}this.exchange_detail_ul=this.objCreate("ul");this.ObjAppend(this.exchange_detail,this.exchange_detail_ul);this.exchange_info.info.forEach(function(list){if(list.type==_this80.exchange_coin_type){var detail_li=_this80.objCreate("li");_this80.ObjAppend(_this80.exchange_detail_ul,detail_li);var li_name=_this80.objCreate("div");li_name.classList.add("pc_exchangename");var li_name_img=_this80.objCreate("img");li_name_img.src=_this80.getMarketLiImg(list);_this80.ObjAppend(li_name,li_name_img);var li_name_content=_this80.objCreate("label");li_name_content.textContent=_this80.exchange_info["jys"][list.jys];_this80.ObjAppend(li_name,li_name_content);var li_name_coin=_this80.objCreate("p");li_name_coin.textContent="GAS/"+_this80.exchange_coin_name;_this80.ObjAppend(li_name,li_name_coin);_this80.ObjAppend(detail_li,li_name);var li_price=_this80.objCreate("div");li_price.classList.add("pc_exchangeprice");var li_price_name=_this80.objCreate("label");li_price_name.textContent=BlackCat.Main.langMgr.get("pay_exchange_price");_this80.ObjAppend(li_price,li_price_name);var li_price_price=_this80.objCreate("p");li_price_price.textContent=BlackCat.floatNum.addZero(BlackCat.floatNum.round(Number(list["curr"]),8),8);_this80.ObjAppend(li_price,li_price_price);_this80.ObjAppend(detail_li,li_price);var li_range=_this80.objCreate("div");li_range.classList.add("pc_exchangerange");var li_range_name=_this80.objCreate("label");li_range_name.textContent=BlackCat.Main.langMgr.get("pay_exchange_range");_this80.ObjAppend(li_range,li_range_name);var li_range_value=_this80.objCreate("p");li_range_value.textContent=BlackCat.floatNum.addZero(BlackCat.floatNum.round(BlackCat.floatNum.times(Number(list["last24"]),100),2),2).toString()+"%";_this80.ObjAppend(li_range,li_range_value);_this80.ObjAppend(detail_li,li_range);}});}},{key:'setExchangeCoinTypeInfo',value:function setExchangeCoinTypeInfo(type){this.exchange_coin_type=type;for(var i=0;i<this.exchange_info.coin.length;i++){if(Number(this.exchange_info.coin[i][0])==type){this.exchange_coin_name=this.exchange_info.coin[i][1];break;}}}},{key:'getMarketLiImg',value:function getMarketLiImg(list){if(this.exchange_info.hasOwnProperty("jys_icon")){if(this.exchange_info["jys_icon"].hasOwnProperty(list.jys)){return this.exchange_info["jys_icon"][list.jys];}}return BlackCat.Main.resHost+"res/img/jys_"+list.jys+".png";}},{key:'getCurr',value:function getCurr(){var count=0;var curr=0;for(var i=0;i<this.exchange_info.info.length;i++){var data=this.exchange_info.info[i];if(data.type==this.exchange_coin_type){count+=1;curr+=Number(data.curr);}}return count==0?0:BlackCat.floatNum.round(curr/count,8);}}]);return PayExchangeView;}(BlackCat.ViewBase);BlackCat.PayExchangeView=PayExchangeView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var PayListDetailView=function(_BlackCat$ViewBase18){_inherits(PayListDetailView,_BlackCat$ViewBase18);function PayListDetailView(){_classCallCheck(this,PayListDetailView);var _this81=_possibleConstructorReturn(this,(PayListDetailView.__proto__||Object.getPrototypeOf(PayListDetailView)).call(this));if(!PayListDetailView.list){PayListDetailView.list=new BlackCat.walletLists();}return _this81;}_createClass(PayListDetailView,[{key:'create',value:function create(){var _this82=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_listdetail");if(PayListDetailView.list&&PayListDetailView.list.hasOwnProperty("wallet")){var headerObj=this.objCreate("div");headerObj.classList.add("pc_header");var returnBtn=this.objCreate("a");returnBtn.classList.add("iconfont","icon-fanhui");returnBtn.textContent=BlackCat.Main.langMgr.get("return");returnBtn.onclick=function(){_this82.return();};this.ObjAppend(headerObj,returnBtn);var h1Obj=this.objCreate("h1");h1Obj.textContent=BlackCat.Main.platName;this.ObjAppend(headerObj,h1Obj);this.ObjAppend(this.div,headerObj);var contentObj=this.objCreate("div");contentObj.classList.add("pc_detail");contentObj.innerHTML='<ul>'+'<li>'+'<div class="pc_listimg">'+'<img src="'+BlackCat.Main.viewMgr.payView.getListImg(PayListDetailView.list)+'">'+'</div>'+'<div class="pc_liftinfo">'+'<div class="pc_listname">'+BlackCat.Main.viewMgr.payView.getListName(PayListDetailView.list)+'</div>'+'<span class="pc_listdate">'+BlackCat.Main.viewMgr.payView.getListCtm(PayListDetailView.list)+'</span>'+'</div>'+'<div class="pc_cnts '+BlackCat.Main.viewMgr.payView.getListCntsClass(PayListDetailView.list)+' "><span>'+this.getCnts()+'</span>'+'<div class="pc_payheighet iconfont icon-diejia">'+BlackCat.Main.viewMgr.payView.getListBlockindex(PayListDetailView.list)+'</div>'+BlackCat.Main.viewMgr.payView.getListState(PayListDetailView.list).outerHTML+'</div>'+'</li>'+'<li><label>'+BlackCat.Main.langMgr.get("paylist_txid")+'</label><p>'+this.getTxid()+'</p></li>'+'<li><label>'+BlackCat.Main.langMgr.get("paylist_wallet")+'</label><p>'+this.getWallet()+'</p></li>'+this.getParams()+'</ul>';this.ObjAppend(this.div,contentObj);}}},{key:'toRefer',value:function toRefer(){if(PayListDetailView.refer){BlackCat.Main.viewMgr.change(PayListDetailView.refer);PayListDetailView.refer=null;}}},{key:'getCnts',value:function getCnts(){return PayListDetailView.list.cnts;}},{key:'getTxid',value:function getTxid(){return PayListDetailView.list.txid;}},{key:'getWallet',value:function getWallet(){return PayListDetailView.list.wallet;}},{key:'getParams',value:function getParams(){var html="";var params=PayListDetailView.list.params;if(params){try{params=JSON.parse(params);if(params.hasOwnProperty("nnc")||params.hasOwnProperty("toaddr")){params=[params];}if(params instanceof Array){if(PayListDetailView.list.type=="6"){for(var k in params){html+='<li class="pc_contractAddress">'+'<div><label>'+BlackCat.Main.langMgr.get("pay_transferGas_toaddr")+'</label><p>'+params[k].toaddr+'</p></div>'+'<div><label>'+BlackCat.Main.langMgr.get("pay_transferGas_count")+'</label><p>'+params[k].count+'</p></div>'+'</li>';}}else{for(var _k3 in params){html+='<li class="pc_contractAddress">'+'<div><label>'+BlackCat.Main.langMgr.get("paylist_nnc")+'</label><p>'+params[_k3].nnc+'</p></div>'+'<div><label>'+BlackCat.Main.langMgr.get("paylist_sbParamJson")+'</label><p>'+params[_k3].sbParamJson+'</p></div>'+'<div><label>'+BlackCat.Main.langMgr.get("paylist_sbPushString")+'</label><p>'+params[_k3].sbPushString+'</p></div>'+'</li>';}}}}catch(e){console.log("[BlaCat]",'[PayListDetailView]','getParams error => ',e.toString());}}return html;}}]);return PayListDetailView;}(BlackCat.ViewBase);BlackCat.PayListDetailView=PayListDetailView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var PayListMoreView=function(_BlackCat$ViewBase19){_inherits(PayListMoreView,_BlackCat$ViewBase19);function PayListMoreView(){_classCallCheck(this,PayListMoreView);var _this83=_possibleConstructorReturn(this,(PayListMoreView.__proto__||Object.getPrototypeOf(PayListMoreView)).call(this));_this83.page=1;_this83.num=BlackCat.Main.viewMgr.payView.listPageNum;_this83.isLast=false;return _this83;}_createClass(PayListMoreView,[{key:'create',value:function create(){var _this84=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_paylist");var header=this.objCreate("div");header.classList.add("pc_header");this.ObjAppend(this.div,header);var returnA=this.objCreate("a");returnA.classList.add("iconfont","icon-fanhui");returnA.textContent=BlackCat.Main.langMgr.get("return");returnA.onclick=function(){_this84.return();};this.ObjAppend(header,returnA);var headerH1=this.objCreate("h1");headerH1.textContent=BlackCat.Main.platName;this.ObjAppend(header,headerH1);this.listsDiv=this.objCreate("ul");this.ObjAppend(this.div,this.listsDiv);this.getMoreDiv=this.objCreate("div");this.getMoreDiv.classList.add("pc_listmore");this.getMoreDiv.onclick=function(){_this84.doGetWalletLists();};this.ObjAppend(this.div,this.getMoreDiv);this.doGetWalletLists();}},{key:'remove',value:function remove(){_get(PayListMoreView.prototype.__proto__||Object.getPrototypeOf(PayListMoreView.prototype),'remove',this).call(this);this.reset();}},{key:'toRefer',value:function toRefer(){BlackCat.Main.viewMgr.change("PayView");}},{key:'reset',value:function reset(){this.page=1;this.isLast=false;}},{key:'doGetWalletLists',value:function doGetWalletLists(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee70(){var _this85=this;var res;return regeneratorRuntime.wrap(function _callee70$(_context70){while(1){switch(_context70.prev=_context70.next){case 0:if(!this.isLast){_context70.next=2;break;}return _context70.abrupt('return');case 2:_context70.next=4;return BlackCat.ApiTool.getWalletListss(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,this.page,this.num,BlackCat.Main.netMgr.type);case 4:res=_context70.sent;if(!res.r){_context70.next=15;break;}if(!(res.data&&res.data.length>=1)){_context70.next=12;break;}if(res.data.length<this.num){this.isLast=true;this.getMoreDiv.textContent=BlackCat.Main.langMgr.get("paylist_noMore");}else{this.page+=1;this.getMoreDiv.textContent=BlackCat.Main.langMgr.get("paylist_getMore");}_context70.next=10;return res.data.forEach(function(list){var listObj=_this85.objCreate("li");listObj.onclick=function(){_this85.hidden();BlackCat.PayListDetailView.refer="PayListMoreView";BlackCat.PayListDetailView.list=list;BlackCat.Main.viewMgr.change("PayListDetailView");};var img_div=_this85.objCreate("div");img_div.classList.add("pc_listimg");var img=_this85.objCreate("img");img.src=BlackCat.Main.viewMgr.payView.getListImg(list);_this85.ObjAppend(img_div,img);_this85.ObjAppend(listObj,img_div);var content_div=_this85.objCreate("div");content_div.classList.add("pc_liftinfo");var content_name_div=_this85.objCreate("div");content_name_div.classList.add("pc_listname");content_name_div.textContent=BlackCat.Main.viewMgr.payView.getListName(list);_this85.ObjAppend(content_div,content_name_div);var content_ctm_p=_this85.objCreate("p");content_ctm_p.classList.add("pc_method");content_ctm_p.textContent=BlackCat.Main.viewMgr.payView.getListParamMethods(list);_this85.ObjAppend(content_div,content_ctm_p);_this85.ObjAppend(listObj,content_div);var state_cnts_div=_this85.objCreate("div");state_cnts_div.classList.add("pc_cnts");var content_ctm_span=_this85.objCreate("div");content_ctm_span.classList.add("pc_listdate");content_ctm_span.textContent=BlackCat.Main.viewMgr.payView.getListCtmMsg(list);_this85.ObjAppend(state_cnts_div,content_ctm_span);var cnts=BlackCat.Main.viewMgr.payView.getListCnts(list);if(cnts){_this85.ObjAppend(state_cnts_div,cnts);var cnts_class=BlackCat.Main.viewMgr.payView.getListCntsClass(list);if(cnts_class)state_cnts_div.classList.add(cnts_class);}var state=BlackCat.Main.viewMgr.payView.getListState(list);if(state)_this85.ObjAppend(state_cnts_div,state);_this85.ObjAppend(listObj,state_cnts_div);_this85.ObjAppend(_this85.listsDiv,listObj);});case 10:_context70.next=13;break;case 12:this.getMoreDiv.textContent=BlackCat.Main.langMgr.get("paylist_noRecord");case 13:_context70.next=16;break;case 15:BlackCat.Main.showErrCode(res.errCode);case 16:case'end':return _context70.stop();}}},_callee70,this);}));}}]);return PayListMoreView;}(BlackCat.ViewBase);BlackCat.PayListMoreView=PayListMoreView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var PayReceivablesView=function(_BlackCat$ViewBase20){_inherits(PayReceivablesView,_BlackCat$ViewBase20);function PayReceivablesView(){_classCallCheck(this,PayReceivablesView);return _possibleConstructorReturn(this,(PayReceivablesView.__proto__||Object.getPrototypeOf(PayReceivablesView)).apply(this,arguments));}_createClass(PayReceivablesView,[{key:'create',value:function create(){var _this87=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_maillist");var header=this.objCreate("div");header.classList.add("pc_header");this.ObjAppend(this.div,header);var returnA=this.objCreate("a");returnA.classList.add("iconfont","icon-fanhui");returnA.textContent=BlackCat.Main.langMgr.get("return");returnA.onclick=function(){_this87.return();};this.ObjAppend(header,returnA);var headerH1=this.objCreate("h1");headerH1.textContent=BlackCat.Main.langMgr.get("pay_received");this.ObjAppend(header,headerH1);var divObj=this.objCreate("div");divObj.classList.add("pc_qrcode");divObj.style.marginTop="100px";this.ObjAppend(this.div,divObj);var qrObj=this.objCreate("img");QrCodeWithLogo.toImage({image:qrObj,content:BlackCat.Main.user.info.wallet}).then(function(){var url=URL.createObjectURL(_this87.base64ToBlob(qrObj.src));qr_download.setAttribute('href',url);qr_download.setAttribute("download",BlackCat.Main.user.info.wallet+".png");});this.ObjAppend(divObj,qrObj);var qr_download=this.objCreate("a");qr_download.classList.add("iconfont","icon-xiazai");qr_download.textContent=BlackCat.Main.langMgr.get("pc_receivables_download");this.ObjAppend(divObj,qr_download);this.divAddress=this.objCreate("div");this.divAddress.classList.add("pc_receivables");this.divAddress.textContent=BlackCat.Main.user.info.wallet;this.ObjAppend(divObj,this.divAddress);var butCopy=this.objCreate("button");butCopy.classList.add("pc_receivablescopy");butCopy.textContent=BlackCat.Main.langMgr.get("copy");butCopy.onclick=function(){var inputCooy=_this87.objCreate("input");inputCooy.value=_this87.divAddress.innerText;_this87.ObjAppend(divObj,inputCooy);inputCooy.select();document.execCommand("Copy");inputCooy.remove();BlackCat.Main.showToast("pc_receivables_copy",1500);};this.ObjAppend(divObj,butCopy);}},{key:'toRefer',value:function toRefer(){if(PayReceivablesView.refer){BlackCat.Main.viewMgr.change(PayReceivablesView.refer);PayReceivablesView.refer=null;}}},{key:'base64ToBlob',value:function base64ToBlob(code){var parts=code.split(';base64,');var contentType=parts[0].split(':')[1];var raw=window.atob(parts[1]);var rawLength=raw.length;var uInt8Array=new Uint8Array(rawLength);for(var i=0;i<rawLength;++i){uInt8Array[i]=raw.charCodeAt(i);}return new Blob([uInt8Array],{type:contentType});}}]);return PayReceivablesView;}(BlackCat.ViewBase);BlackCat.PayReceivablesView=PayReceivablesView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var PayTransferView=function(_BlackCat$ViewBase21){_inherits(PayTransferView,_BlackCat$ViewBase21);function PayTransferView(){_classCallCheck(this,PayTransferView);return _possibleConstructorReturn(this,(PayTransferView.__proto__||Object.getPrototypeOf(PayTransferView)).apply(this,arguments));}_createClass(PayTransferView,[{key:'reset',value:function reset(){this.gasBalance='0';this.toaddress="";}},{key:'start',value:function start(){this.gasBalance=BlackCat.Main.getStringNumber(BlackCat.Main.viewMgr.payView.gas);_get(PayTransferView.prototype.__proto__||Object.getPrototypeOf(PayTransferView.prototype),'start',this).call(this);if(!this.toaddress){this.inputTransferAddr.focus();}else{this.inputGasCount.focus();}}},{key:'create',value:function create(){var _this89=this;this.div=this.objCreate("div");this.div.classList.add("pc_popup");var popupbox=this.objCreate('div');popupbox.classList.add("pc_popupbox","pc_transfer");this.ObjAppend(this.div,popupbox);var popupTitle=this.objCreate('div');popupTitle.classList.add("pc_popup_title");popupTitle.innerText=BlackCat.Main.langMgr.get("pay_transfer");this.ObjAppend(popupbox,popupTitle);var divtransfer=this.objCreate("div");divtransfer.classList.add("pc_transferbox");this.ObjAppend(popupbox,divtransfer);var divtransfertype=this.objCreate("div");divtransfertype.classList.add("pc_transfertype");this.ObjAppend(divtransfer,divtransfertype);var gasBalancetype=this.objCreate("label");gasBalancetype.innerHTML=BlackCat.Main.langMgr.get("pay_transferType");this.ObjAppend(divtransfertype,gasBalancetype);this.divTransferAddr=this.objCreate("div");this.divTransferAddr.classList.add("pc_transfertype");this.ObjAppend(divtransfer,this.divTransferAddr);this.labelName=this.objCreate("label");this.labelName.classList.add("pc_transfername");this.ObjAppend(this.divTransferAddr,this.labelName);this.inputTransferAddr=this.objCreate("input");this.inputTransferAddr.classList.add("pc_transaddress");this.inputTransferAddr.placeholder=BlackCat.Main.langMgr.get("pay_transferToAddr");this.inputTransferAddr.value=this.getAddress();this.inputTransferAddr.onfocus=function(){_this89.inputTransferAddr.select();};this.inputTransferAddr.onchange=function(){_this89.divTransferAddr.classList.remove("pc_transfer_active");_this89.inputTransferAddr.style.padding="0 35px 0 5px";_this89.inputTransferAddr.style.width="230px";};this.ObjAppend(this.divTransferAddr,this.inputTransferAddr);var aAddresbook=this.objCreate("a");aAddresbook.classList.add("pc_transferaddressbook","iconfont","icon-tongxunlu");aAddresbook.onclick=function(){_this89.hidden();BlackCat.Main.viewMgr.payView.hidden();BlackCat.AddressbookView.select="select";BlackCat.Main.viewMgr.change("AddressbookView");};this.ObjAppend(this.divTransferAddr,aAddresbook);var divGasCount=this.objCreate("div");divGasCount.classList.add("pc_transfertype");this.ObjAppend(divtransfer,divGasCount);this.inputGasCount=this.objCreate("input");this.inputGasCount.placeholder=BlackCat.Main.langMgr.get("pay_transferCount");this.ObjAppend(divGasCount,this.inputGasCount);this.inputGasCount.onkeyup=function(){_this89.doinputchange();};this.divHaveAmounts=this.objCreate("div");this.divHaveAmounts.classList.add("pc_haveamounts");this.ObjAppend(popupbox,this.divHaveAmounts);this.divHaveGasAmounts=this.objCreate("div");this.divHaveGasAmounts.textContent="GAS："+BlackCat.Main.getStringNumber(BlackCat.Main.viewMgr.payView.gas);this.ObjAppend(this.divHaveAmounts,this.divHaveGasAmounts);this.netFeeCom=new BlackCat.NetFeeComponent(popupbox,function(net_fee){_this89.netFeeChange(net_fee);});this.netFeeCom.setFeeDefault();this.netFeeCom.createDiv();var popupbutbox=this.objCreate('div');popupbutbox.classList.add("pc_popupbutbox");this.ObjAppend(popupbox,popupbutbox);var popupClose=this.objCreate('button');popupClose.classList.add("pc_cancel");popupClose.textContent=BlackCat.Main.langMgr.get("cancel");popupClose.onclick=function(){_this89.remove(300);};this.ObjAppend(popupbutbox,popupClose);var transferObj=this.objCreate("button");transferObj.textContent=BlackCat.Main.langMgr.get("ok");transferObj.onclick=function(){_this89.doTransfer();};this.ObjAppend(popupbutbox,transferObj);}},{key:'toRefer',value:function toRefer(){if(PayTransferView.refer){BlackCat.Main.viewMgr.change(PayTransferView.refer);PayTransferView.refer=null;}}},{key:'getAddress',value:function getAddress(){if(PayTransferView.address){this.toaddress=PayTransferView.address;PayTransferView.address="";}return this.toaddress;}},{key:'doinputchange',value:function doinputchange(){if(!BlackCat.Main.viewMgr.payView.checkTransCount(this.inputGasCount.value)){this.spanHaveGasAmounts.textContent="";return;}this.divHaveGasAmounts.classList.add("pc_expenditure");this.spanHaveGasAmounts.textContent=BlackCat.Main.getStringNumber(BlackCat.floatNum.plus(Number(this.inputGasCount.value),Number(this.net_fee)));}},{key:'gatSelect',value:function gatSelect(){this.divTransferAddr.classList.add("pc_transfer_active");this.labelName.textContent=PayTransferView.contact.address_name+":";this.inputTransferAddr.value=PayTransferView.contact.address_wallet;var labelNameW=this.labelName.clientWidth+10;var inputTransferAddrw=270-labelNameW-35;this.inputTransferAddr.style.width=inputTransferAddrw+"px";this.inputTransferAddr.style.padding="0 35px 0 "+labelNameW+"px";if(this.labelName){this.inputGasCount.focus();}}},{key:'doTransfer',value:function doTransfer(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee71(){var _this90=this;var wallet_res,net_fee,res;return regeneratorRuntime.wrap(function _callee71$(_context71){while(1){switch(_context71.prev=_context71.next){case 0:_context71.next=2;return BlackCat.Main.validateFormat("walletaddr",this.inputTransferAddr);case 2:wallet_res=_context71.sent;if(!(wallet_res===false)){_context71.next=7;break;}return _context71.abrupt('return');case 7:if(wallet_res!==true){this.toaddress=wallet_res;}else{this.toaddress=this.inputTransferAddr.value;}case 8:if(BlackCat.Main.viewMgr.payView.checkTransCount(this.inputGasCount.value)){_context71.next=11;break;}BlackCat.Main.showErrMsg("pay_transferCountError",function(){_this90.inputGasCount.focus();});return _context71.abrupt('return');case 11:net_fee=this.net_fee;if(!(Number(this.inputGasCount.value)+Number(net_fee)>Number(this.gasBalance))){_context71.next=15;break;}BlackCat.Main.showErrMsg("pay_transferGasNotEnough",function(){_this90.inputGasCount.focus();});return _context71.abrupt('return');case 15:BlackCat.Main.viewMgr.change("ViewLoading");_context71.prev=16;_context71.next=19;return BlackCat.tools.CoinTool.rawTransaction(this.toaddress,BlackCat.tools.CoinTool.id_GAS,this.inputGasCount.value,Neo.Fixed8.fromNumber(Number(net_fee)));case 19:res=_context71.sent;_context71.next=28;break;case 22:_context71.prev=22;_context71.t0=_context71['catch'](16);res=new BlackCat.Result();res.err=true;res.info=_context71.t0.toString();console.log("[BlaCat]",'[PayTransferView]','doTransfer, tools.CoinTool.rawTransaction error => ',_context71.t0.toString());case 28:BlackCat.Main.viewMgr.viewLoading.remove();if(!res){_context71.next=43;break;}console.log("[BlaCat]",'[PayTransferView]','gas转账结果 => ',res);if(!(res.err==false)){_context71.next=40;break;}_context71.next=34;return BlackCat.ApiTool.addUserWalletLogs(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,res.info,"0",this.inputGasCount.value,"6",'{"sbPushString":"transfer", "toaddr":"'+this.toaddress+'", "count": "'+this.inputGasCount.value+'"}',BlackCat.Main.netMgr.type,"0",net_fee);case 34:BlackCat.Main.showInfo("pay_transferDoSucc");this.remove();PayTransferView.callback();PayTransferView.callback=null;_context71.next=41;break;case 40:BlackCat.Main.showErrMsg("pay_transferDoFail");case 41:_context71.next=44;break;case 43:BlackCat.Main.showErrMsg("pay_transferDoFail");case 44:case'end':return _context71.stop();}}},_callee71,this,[[16,22]]);}));}},{key:'netFeeChange',value:function netFeeChange(net_fee){this.net_fee=net_fee;var v=this.inputGasCount.value;if(Number(this.net_fee)>0){if(v.length==0||v.replace(/(^s*)|(s*$)/g,"").length==0){}else{this.divHaveAmounts.classList.add("pc_haveamountsgas");this.spanHaveGasAmounts.textContent=BlackCat.Main.getStringNumber(BlackCat.floatNum.plus(Number(v),Number(this.net_fee)));}}else{if(v.length==0||v.replace(/(^s*)|(s*$)/g,"").length==0){this.spanHaveGasAmounts.textContent="";}else{this.divHaveAmounts.classList.add("pc_haveamountsgas");this.spanHaveGasAmounts.textContent=BlackCat.Main.getStringNumber(BlackCat.floatNum.plus(Number(v),Number(this.net_fee)));}}}},{key:'updateBalance',value:function updateBalance(){this.divHaveGasAmounts.textContent="GAS："+BlackCat.Main.getStringNumber(BlackCat.Main.viewMgr.payView.gas);}}]);return PayTransferView;}(BlackCat.ViewBase);PayTransferView.address="";BlackCat.PayTransferView=PayTransferView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var PayView=function(_BlackCat$ViewBase22){_inherits(PayView,_BlackCat$ViewBase22);function PayView(){_classCallCheck(this,PayView);return _possibleConstructorReturn(this,(PayView.__proto__||Object.getPrototypeOf(PayView)).apply(this,arguments));}_createClass(PayView,[{key:'reset',value:function reset(){this.gas=0;this.sgas=0;this.listPageNum=10;this.height_clis=0;this.height_nodes=0;this.getWalletListsTimeout=20000;this.getWalletListsTimeout_min=10000;this.WalletListsNeedConfirm=false;this.WalletListsHashString="";this.walletListsNeedConfirmCounts=0;this.clearTimeout();}},{key:'start',value:function start(){_get(PayView.prototype.__proto__||Object.getPrototypeOf(PayView.prototype),'start',this).call(this);BlackCat.Main.loginCallback();}},{key:'create',value:function create(){var _this92=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_pay");var headerTitle=this.objCreate("div");headerTitle.classList.add("pc_header");this.ObjAppend(this.div,headerTitle);var myinfo_a=this.objCreate("a");myinfo_a.classList.add("iconfont","icon-touxiang");myinfo_a.onclick=function(){_this92.hidden();BlackCat.MyInfoView.refer="PayView";BlackCat.Main.viewMgr.change("MyInfoView");};this.ObjAppend(headerTitle,myinfo_a);this.divHeight_nodes=this.objCreate("div");this.divHeight_nodes.classList.add("pc_payheighet","iconfont","icon-blalian","network");this.divHeight_nodes.style.top="5px";this.divHeight_nodes.textContent="n/a";this.divHeight_nodes.onclick=function(){_this92.hidden();BlackCat.ModifyNetworkLineView.refer="PayView";BlackCat.ModifyNetworkLineView.defaultType="nodes";BlackCat.Main.viewMgr.change("ModifyNetworkLineView");};this.ObjAppend(headerTitle,this.divHeight_nodes);this.divHeight_clis=this.objCreate("div");this.divHeight_clis.classList.add("pc_payheighet","iconfont","icon-neolian","network");this.divHeight_clis.textContent="n/a";this.divHeight_clis.onclick=function(){if(BlackCat.tools.WWW.api_clis&&BlackCat.tools.WWW.api_clis!=""){_this92.hidden();BlackCat.ModifyNetworkLineView.refer="PayView";BlackCat.ModifyNetworkLineView.defaultType="clis";BlackCat.Main.viewMgr.change("ModifyNetworkLineView");}};this.ObjAppend(headerTitle,this.divHeight_clis);var headerh1=this.objCreate("h1");headerh1.textContent=BlackCat.Main.platName;this.ObjAppend(headerTitle,headerh1);var divNetType=this.objCreate("div");divNetType.classList.add("pc_net","iconfont");divNetType.textContent=this.getNetTypeName();divNetType.onclick=function(){_this92.showChangeNetType();};this.ObjAppend(headerTitle,divNetType);this.divNetSelect=this.objCreate("div");this.divNetSelect.classList.add("pc_netbox");this.ObjAppend(headerTitle,this.divNetSelect);var aReturnGame=this.objCreate("i");aReturnGame.classList.add("pc_returngame","iconfont","icon-fanhui1");aReturnGame.onclick=function(){BlackCat.SDK.showIcon();};this.ObjAppend(headerTitle,aReturnGame);var paycard=this.objCreate("div");paycard.classList.add("pc_card");this.ObjAppend(this.div,paycard);var aWalletDetail=this.objCreate("a");aWalletDetail.classList.add("pc_mydetail","iconfont","icon-xiangqing");aWalletDetail.onclick=function(){_this92.wallet_detail();};this.ObjAppend(paycard,aWalletDetail);var payAddressbook=this.objCreate("a");payAddressbook.classList.add("pc_mydetail","iconfont","icon-tongxunlu");payAddressbook.onclick=function(){_this92.hidden();BlackCat.AddressbookView.refer="PayView";BlackCat.Main.viewMgr.change("AddressbookView");};this.ObjAppend(paycard,payAddressbook);var divWallet=this.objCreate("div");divWallet.classList.add("pc_cardcon");divWallet.textContent=BlackCat.Main.user.info.wallet.substr(0,4)+"****"+BlackCat.Main.user.info.wallet.substr(BlackCat.Main.user.info.wallet.length-4);this.ObjAppend(paycard,divWallet);var payRefresh=this.objCreate("div");payRefresh.classList.add("pc_cardrefresh");payRefresh.textContent=BlackCat.Main.langMgr.get("pay_refresh");payRefresh.onclick=function(){_this92.doGetBalances();_this92.doGetWalletLists(1);};this.ObjAppend(paycard,payRefresh);var iRefresh=this.objCreate("i");iRefresh.classList.add("iconfont","icon-shuaxin");this.ObjAppend(payRefresh,iRefresh);var divWalletUser=this.objCreate("div");divWalletUser.classList.add("pc_cardtransaction");this.ObjAppend(paycard,divWalletUser);var butReceivables=this.objCreate("button");butReceivables.textContent=BlackCat.Main.langMgr.get("pay_received");butReceivables.onclick=function(){_this92.doMakeReceivables();};this.ObjAppend(divWalletUser,butReceivables);var makeTransferObj=this.objCreate("button");makeTransferObj.textContent=BlackCat.Main.langMgr.get("pay_send");makeTransferObj.onclick=function(){_this92.doMakeTransfer();};this.ObjAppend(divWalletUser,makeTransferObj);var divCurrency=this.objCreate("div");divCurrency.classList.add("pc_currency");this.ObjAppend(this.div,divCurrency);var divCurrencyNumber=this.objCreate("div");divCurrencyNumber.classList.add("pc_currencynumber");this.ObjAppend(divCurrency,divCurrencyNumber);var spanCurrencyNumber=this.objCreate("div");spanCurrencyNumber.innerText=BlackCat.Main.langMgr.get("pay_coin_name");this.ObjAppend(divCurrencyNumber,spanCurrencyNumber);if(BlackCat.tools.CoinTool.id_SGAS_OLD&&BlackCat.tools.CoinTool.id_SGAS_OLD.length>0){var bntCurrencyNumber=this.objCreate("button");bntCurrencyNumber.textContent=BlackCat.Main.langMgr.get("pay_coin_old");bntCurrencyNumber.onclick=function(){_this92.doMakeRefundOld();};this.ObjAppend(divCurrencyNumber,bntCurrencyNumber);}var divGas=this.objCreate("div");divGas.innerHTML=BlackCat.Main.langMgr.get("pay_gas");this.ObjAppend(divCurrency,divGas);var labelGas=this.objCreate("label");labelGas.classList.add("iconfont","icon-help");this.ObjAppend(divGas,labelGas);this.spanGas=this.objCreate("span");this.spanGas.textContent="0";this.ObjAppend(divGas,this.spanGas);var divSGascon=this.objCreate("div");divSGascon.classList.add("pc_sgascon");divSGascon.textContent=BlackCat.Main.langMgr.get("pay_gas_desc");this.ObjAppend(labelGas,divSGascon);var divSGas=this.objCreate("div");divSGas.innerHTML=BlackCat.Main.langMgr.get("pay_sgas");this.ObjAppend(divCurrency,divSGas);var labelSGas=this.objCreate("label");labelSGas.classList.add("iconfont","icon-help");this.ObjAppend(divSGas,labelSGas);this.spanSgas=this.objCreate("span");this.spanSgas.textContent="0";this.ObjAppend(divSGas,this.spanSgas);var divSGascon=this.objCreate("div");divSGascon.classList.add("pc_sgascon");divSGascon.textContent=BlackCat.Main.langMgr.get("pay_sgas_desc");this.ObjAppend(labelSGas,divSGascon);var makePurchaseObj=this.objCreate("button");makePurchaseObj.textContent=BlackCat.Main.langMgr.get("pay_purchase");makePurchaseObj.onclick=function(){if(BlackCat.Main.netMgr.type==1){_this92.doMakePurchase();}else{BlackCat.Main.showToast("pay_purchase_testnet_cant_buy");}};this.ObjAppend(divGas,makePurchaseObj);var makeMintTokenObj=this.objCreate("button");makeMintTokenObj.textContent=BlackCat.Main.langMgr.get("pay_makeMint");makeMintTokenObj.onclick=function(){_this92.doMakeMintToken();};this.ObjAppend(divSGas,makeMintTokenObj);this.divLists=this.objCreate("ul");this.divLists.classList.add("pc_paylists");this.ObjAppend(this.div,this.divLists);this.doGetBalances();this.doGetWalletLists(1);this.getHeight("nodes");if(BlackCat.tools.WWW.api_clis&&BlackCat.tools.WWW.api_clis!=""){this.getHeight("clis");}}},{key:'update',value:function update(){var isHidden=this.isHidden();this.reset();_get(PayView.prototype.__proto__||Object.getPrototypeOf(PayView.prototype),'update',this).call(this);if(isHidden)this.hidden();}},{key:'clearTimeout',value:function(_clearTimeout2){function clearTimeout(){return _clearTimeout2.apply(this,arguments);}clearTimeout.toString=function(){return _clearTimeout2.toString();};return clearTimeout;}(function(){if(this.s_doGetWalletLists)clearTimeout(this.s_doGetWalletLists);})},{key:'doGetBalances',value:function doGetBalances(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee72(){var _this93=this;var balances;return regeneratorRuntime.wrap(function _callee72$(_context72){while(1){switch(_context72.prev=_context72.next){case 0:BlackCat.tools.CoinTool.initAllAsset();_context72.next=3;return BlackCat.tools.WWW.api_getBalance(BlackCat.Main.user.info.wallet);case 3:balances=_context72.sent;if(!balances){_context72.next=10;break;}balances.map(function(item){return item.names=BlackCat.tools.CoinTool.assetID2name[item.asset];});_context72.next=8;return balances.forEach(function(balance){if(balance.asset==BlackCat.tools.CoinTool.id_GAS){_this93.gas=balance.balance;_this93.spanGas.textContent=BlackCat.Main.getStringNumber(_this93.gas);}});case 8:_context72.next=12;break;case 10:this.gas=0;this.spanGas.textContent="0";case 12:_context72.next=14;return BlackCat.Main.getSgasBalanceByAddress(BlackCat.tools.CoinTool.id_SGAS,BlackCat.Main.user.info.wallet);case 14:this.sgas=_context72.sent;this.spanSgas.textContent=BlackCat.Main.getStringNumber(this.sgas);BlackCat.Main.viewMgr.updateBalance();case 17:case'end':return _context72.stop();}}},_callee72,this);}));}},{key:'doMakeRefundOld',value:function doMakeRefundOld(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee73(){var _this94=this;var id_SGAS,sgas,id_SGAS_balance;return regeneratorRuntime.wrap(function _callee73$(_context73){while(1){switch(_context73.prev=_context73.next){case 0:if(!BlackCat.Main.isWalletOpen()){_context73.next=14;break;}id_SGAS=BlackCat.tools.CoinTool.id_SGAS_OLD[0];_context73.next=4;return BlackCat.Main.getSgasBalanceByAddress(id_SGAS,BlackCat.Main.user.info.wallet);case 4:sgas=_context73.sent;id_SGAS_balance=sgas.toString();BlackCat.ViewTransCount.transTypename1="SGASOLD2OLD";BlackCat.ViewTransCount.transTypename2="SGAS2GAS";BlackCat.ViewTransCount.transBalances=id_SGAS_balance;BlackCat.ViewTransCount.refer="PayView";BlackCat.ViewTransCount.callback=function(){_this94.makeRefundTransaction(id_SGAS);};BlackCat.Main.viewMgr.change("ViewTransCount");_context73.next=17;break;case 14:BlackCat.ViewWalletOpen.refer="PayView";BlackCat.ViewWalletOpen.callback=function(){_this94.doMakeRefundOld();};BlackCat.Main.viewMgr.change("ViewWalletOpen");case 17:case'end':return _context73.stop();}}},_callee73,this);}));}},{key:'doMakePurchase',value:function doMakePurchase(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee74(){var _this95=this;return regeneratorRuntime.wrap(function _callee74$(_context74){while(1){switch(_context74.prev=_context74.next){case 0:if(BlackCat.Main.isWalletOpen()){BlackCat.PayExchangeView.refer="PayView";this.hidden();BlackCat.Main.viewMgr.change("PayExchangeView");}else{BlackCat.ViewWalletOpen.refer="PayView";BlackCat.ViewWalletOpen.callback=function(){_this95.doMakePurchase();};BlackCat.Main.viewMgr.change("ViewWalletOpen");}case 1:case'end':return _context74.stop();}}},_callee74,this);}));}},{key:'doMakeMintToken',value:function doMakeMintToken(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee75(){var _this96=this;return regeneratorRuntime.wrap(function _callee75$(_context75){while(1){switch(_context75.prev=_context75.next){case 0:if(BlackCat.Main.isWalletOpen()){BlackCat.ViewTransCount.transTypename1="";BlackCat.ViewTransCount.refer="PayView";BlackCat.ViewTransCount.callback=function(){if(BlackCat.ViewTransCount.transTypename1=="GAS2SGAS"){_this96.makeMintTokenTransaction();}else if(BlackCat.ViewTransCount.transTypename1=="SGAS2GAS"){_this96.makeRefundTransaction();}};BlackCat.Main.viewMgr.change("ViewTransCount");}else{BlackCat.ViewWalletOpen.refer="PayView";BlackCat.ViewWalletOpen.callback=function(){_this96.doMakeMintToken();};BlackCat.Main.viewMgr.change("ViewWalletOpen");}case 1:case'end':return _context75.stop();}}},_callee75,this);}));}},{key:'divLists_recreate',value:function divLists_recreate(){var _this97=this;this.divLists.innerHTML="";var liRecord=this.objCreate("li");liRecord.classList.add("pc_payrecord");this.ObjAppend(this.divLists,liRecord);var spanRecord=this.objCreate("div");spanRecord.innerText=BlackCat.Main.langMgr.get("pay_recentLists");this.ObjAppend(liRecord,spanRecord);this.divListsMore=this.objCreate("button");this.divListsMore.classList.add("pc_paymore");this.divListsMore.textContent=BlackCat.Main.langMgr.get("more");this.divListsMore.onclick=function(){_this97.hidden();BlackCat.Main.viewMgr.change("PayListMoreView");};this.divListsMore.style.display="none";this.ObjAppend(liRecord,this.divListsMore);var iListsMore=this.objCreate("i");iListsMore.classList.add("iconfont","icon-sanjiaoxing");this.ObjAppend(this.divListsMore,iListsMore);}},{key:'doGetWalletLists',value:function doGetWalletLists(){var force=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee76(){var _this98=this;var res,hasNeedConfirm,next_timeout,curr_ts,WalletListsHashString_tmp,isFirstShow;return regeneratorRuntime.wrap(function _callee76$(_context76){while(1){switch(_context76.prev=_context76.next){case 0:console.log("[BlaCat]",'[PayView]','doGetWalletLists, force => ',force);if(BlackCat.Main.user.info.token){_context76.next=4;break;}console.log("[BlaCat]",'[PayView]','doGetWalletLists, 已退出登录，本次请求取消');return _context76.abrupt('return');case 4:if(!(force==0&&this.WalletListsNeedConfirm)){_context76.next=7;break;}console.log("[BlaCat]",'[PayView]','doGetWalletLists, 有定时刷新，本次请求取消');return _context76.abrupt('return');case 7:if(this.s_doGetWalletLists){clearTimeout(this.s_doGetWalletLists);this.s_doGetWalletLists=null;}_context76.next=10;return BlackCat.ApiTool.getWalletListss(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,1,this.listPageNum,BlackCat.Main.netMgr.type);case 10:res=_context76.sent;if(!res.r){_context76.next=42;break;}if(!(res.data&&res.data.length>0)){_context76.next=40;break;}BlackCat.Main.walletLogId=Number(res.data[0].id);if(!(BlackCat.Main.walletLogId<BlackCat.Main.appWalletLogId||BlackCat.Main.walletLogId<BlackCat.Main.platWalletLogId)){_context76.next=18;break;}console.log("[BlaCat]",'[PayView]','doGetWalletLists, 钱包记录要重新获取 ..');this.doGetWalletLists(1);return _context76.abrupt('return');case 18:hasNeedConfirm=false;next_timeout=this.getWalletListsTimeout;curr_ts=Math.round(new Date().getTime()/1000);this.walletListsNeedConfirmCounts=0;_context76.next=24;return res.data.forEach(function(list){if(list.state=='0'){hasNeedConfirm=true;_this98.walletListsNeedConfirmCounts+=1;var last_ts=(curr_ts-list.ctm)*1000-BlackCat.Main.tsOffset;console.log('[BlaCat]','[PayView]','doGetWalletLists, last_ts =>',last_ts);if(last_ts>=_this98.getWalletListsTimeout&&last_ts<_this98.getWalletListsTimeout*3){next_timeout=_this98.getWalletListsTimeout_min;}}else if(list.type=="2"){if(list.client_notify=="0"){_this98.walletListsNeedConfirmCounts+=1;}}});case 24:this.WalletListsNeedConfirm=hasNeedConfirm;BlackCat.Main.viewMgr.iconView.flushProcess(this.walletListsNeedConfirmCounts);if(this.WalletListsNeedConfirm){console.log("[BlaCat]",'[PayView]','doGetWalletLists, 有待确认交易，轮询查询');console.log('[BlaCat]','[PayView]','doGetWalletLists, next_timeout =>',next_timeout);this.s_doGetWalletLists=setTimeout(function(){_this98.doGetWalletLists(1);},next_timeout);}WalletListsHashString_tmp=JSON.stringify(res.data);if(!(WalletListsHashString_tmp==this.WalletListsHashString)){_context76.next=31;break;}console.log("[BlaCat]",'[PayView]','doGetWalletLists, 交易记录没有更新 ..');return _context76.abrupt('return');case 31:console.log("[BlaCat]",'[PayView]','doGetWalletLists, 交易记录有更新');isFirstShow=false;if(this.WalletListsHashString==""){isFirstShow=true;}this.WalletListsHashString=WalletListsHashString_tmp;if(!isFirstShow){console.log("[BlaCat]",'[PayView]','doGetWalletLists, 交易记录有更新，刷新余额');this.doGetBalances();}this.divLists_recreate();if(res.data&&res.data.length==this.listPageNum){this.divListsMore.style.display="";}_context76.next=40;return res.data.forEach(function(list){var listObj=_this98.objCreate("li");listObj.onclick=function(){_this98.hidden();BlackCat.PayListDetailView.refer="PayView";BlackCat.PayListDetailView.list=list;BlackCat.Main.viewMgr.change("PayListDetailView");};var img_div=_this98.objCreate("div");img_div.classList.add("pc_listimg");var img=_this98.objCreate("img");img.src=_this98.getListImg(list);_this98.ObjAppend(img_div,img);_this98.ObjAppend(listObj,img_div);var content_div=_this98.objCreate("div");content_div.classList.add("pc_liftinfo");var content_name_div=_this98.objCreate("div");content_name_div.classList.add("pc_listname");content_name_div.textContent=_this98.getListName(list);_this98.ObjAppend(content_div,content_name_div);var content_ctm_p=_this98.objCreate("p");content_ctm_p.classList.add("pc_method");content_ctm_p.textContent=_this98.getListParamMethods(list);_this98.ObjAppend(content_div,content_ctm_p);_this98.ObjAppend(listObj,content_div);var state_cnts_div=_this98.objCreate("div");state_cnts_div.classList.add("pc_cnts");var content_ctm_span=_this98.objCreate("div");content_ctm_span.classList.add("pc_listdate","listCtm");content_ctm_span.textContent=_this98.getListCtmMsg(list);content_ctm_span.setAttribute("ctm",list.ctm);_this98.ObjAppend(state_cnts_div,content_ctm_span);var cnts=_this98.getListCnts(list);if(cnts){_this98.ObjAppend(state_cnts_div,cnts);var cnts_class=_this98.getListCntsClass(list);if(cnts_class)state_cnts_div.classList.add(cnts_class);}var state=_this98.getListState(list);if(state)_this98.ObjAppend(state_cnts_div,state);_this98.ObjAppend(listObj,state_cnts_div);_this98.ObjAppend(_this98.divLists,listObj);});case 40:_context76.next=43;break;case 42:BlackCat.Main.showErrCode(res.errCode);case 43:case'end':return _context76.stop();}}},_callee76,this);}));}},{key:'getSgasIcon',value:function getSgasIcon(v){try{var params=JSON.parse(v.params);if(params.hasOwnProperty("nnc")){params=[params];}if(params instanceof Array){for(var k in params){if(params[k].hasOwnProperty('nnc')){if(params[k].nnc==BlackCat.tools.CoinTool.id_SGAS){return BlackCat.Main.resHost+"res/img/sgas.png";}}}}}catch(e){console.log("[BlaCat]",'[PayView]','getListImg, v.type='+v.type+', error => ',e);}return BlackCat.Main.resHost+"res/img/oldsgas.png";}},{key:'getListImg',value:function getListImg(v){if(v.state=="0"){return BlackCat.Main.resHost+"res/img/transconfirm.png";}switch(v.type){case"1":case"2":case"3":case"4":return this.getSgasIcon(v);case"5":try{var params=JSON.parse(v.params);if(params.hasOwnProperty("nnc")){params=[params];}if(params instanceof Array){for(var k in params){if(params[k].hasOwnProperty('nnc')){if(params[k].nnc==BlackCat.tools.CoinTool.id_SGAS){return BlackCat.Main.resHost+"res/img/sgas.png";}}}if(Number(v.cnts)>0){return BlackCat.Main.resHost+"res/img/oldsgas.png";}}}catch(e){console.log("[BlaCat]",'[PayView]','getListImg, v.type=5, error => ',e);}return v.icon;case"6":return BlackCat.Main.resHost+"res/img/gas.png";default:return BlackCat.Main.resHost+"res/img/game0.png";}}},{key:'getListName',value:function getListName(v){if(v.g_id=="0"){return BlackCat.Main.platName;}else{try{var nameObj=JSON.parse(v.name);if(nameObj.hasOwnProperty(BlackCat.Main.langMgr.type)){return nameObj[BlackCat.Main.langMgr.type];}else if(nameObj.hasOwnProperty("cn")){return nameObj.cn;}}catch(e){console.log("[BlaCat]",'[PayView]','getListName, v',v,'error => ',e.toString());}}return v.name;}},{key:'getListCtm',value:function getListCtm(v){return BlackCat.Main.getDate(v.ctm);}},{key:'getListCtmMsg',value:function getListCtmMsg(v){var str="";var timestamp=new Date().getTime();var ts=Math.round(timestamp/1000);var last=ts-Number(v.ctm);var year=60*60*24*365;var month=60*60*24*30;var day=60*60*24;var hour=60*60;var minute=60;if(last>=year){var n=Math.floor(last/year);return BlackCat.Main.langMgr.get("paylist_ctm_year",{"year":n});}else if(last>=month){var n=Math.floor(last/month);return BlackCat.Main.langMgr.get("paylist_ctm_month",{"month":n});}else if(last>=day){var n=Math.floor(last/day);return BlackCat.Main.langMgr.get("paylist_ctm_day",{"day":n});}else if(last>=hour){var n=Math.floor(last/hour);return BlackCat.Main.langMgr.get("paylist_ctm_hour",{"hour":n});}else if(last>=minute){var n=Math.floor(last/minute);return BlackCat.Main.langMgr.get("paylist_ctm_minute",{"minute":n});}else if(last>=0){return BlackCat.Main.langMgr.get("paylist_ctm_recent");}else{return BlackCat.Main.langMgr.get("paylist_ctm_recent");}}},{key:'getListParamMethods',value:function getListParamMethods(v){try{var params=JSON.parse(v.params);if(params.hasOwnProperty("sbPushString")){params=[params];}if(params instanceof Array){var method=new Array();for(var k in params){if(params[k].hasOwnProperty("sbPushString")){method.push(params[k].sbPushString);}}if(method.length>1){return method[0]+', ...';}else{return method.toString();}}}catch(e){console.log("[BlaCat]",'[PayView]','getListParamMethods, v',v,'error => ',e.toString());}return BlackCat.Main.langMgr.get("paylist_sbPushString_none");}},{key:'getListCnts',value:function getListCnts(v){if(v.cnts&&Number(v.cnts)!=0){var state_cnts_span=this.objCreate("span");state_cnts_span.textContent=v.cnts;return state_cnts_span;}}},{key:'getListCntsClass',value:function getListCntsClass(v){if(v.type=="1"||v.type=="5"&&v.type_detail=="2"){return'pc_income';}else if(Number(v.cnts)>0){return'pc_expenditure';}return"";}},{key:'getListState',value:function getListState(v){var state=v.state;var pct="50%";var i=1;if(v.type=="2"){pct="25%";if(v.state=="1"){state='0';pct='50%';if(v.ext!=""){state='0';pct="75%";if(v.client_notify=="1"){state='1';}}else{if(!BlackCat.Main.isWalletOpen()){i=2;}}}}switch(state){case'0':var state_button0=this.objCreate("div");state_button0.classList.add("pc_verification");if(i==1){state_button0.classList.add("iconfont","icon-dengdai");state_button0.innerHTML="<label>"+pct+"</label>";}else{var obja=this.objCreate("a");obja.classList.add("iconfont","icon-jinhangzhong");obja.innerHTML='<label>'+pct+'</label>';obja.onclick=function(){BlackCat.Main.continueRefund();event.stopPropagation();};this.ObjAppend(state_button0,obja);}return state_button0;case'1':var state_a1=this.objCreate("a");state_a1.classList.add("iconfont","icon-gou");return state_a1;case'2':var state_a2=this.objCreate("a");state_a2.classList.add("iconfont","icon-chacha");return state_a2;}}},{key:'getListBlockindex',value:function getListBlockindex(v){if(v.hasOwnProperty('blockindex')){return v["blockindex"];}return 0;}},{key:'wallet_detail',value:function wallet_detail(){var _this99=this;if(BlackCat.Main.isWalletOpen()){BlackCat.PayWalletDetailView.refer="PayView";BlackCat.Main.viewMgr.change("PayWalletDetailView");this.hidden();}else{BlackCat.ViewWalletOpen.refer="PayView";BlackCat.ViewWalletOpen.callback=function(){_this99.wallet_detail();};BlackCat.Main.viewMgr.change("ViewWalletOpen");}}},{key:'makeMintTokenTransaction',value:function makeMintTokenTransaction(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee77(){var mintCount,net_fee,login,utxos_assets,scriptaddress,nepAddress,makeTranRes,errmsg,sb,tran,oldarr,msg,signdata,txid,data,r,logRes,height;return regeneratorRuntime.wrap(function _callee77$(_context77){while(1){switch(_context77.prev=_context77.next){case 0:BlackCat.Main.viewMgr.change("ViewLoading");mintCount=BlackCat.Main.viewMgr.viewTransCount.inputCount.value;net_fee=BlackCat.Main.viewMgr.viewTransCount.net_fee;console.log("[BlaCat]",'[PayView]','充值sgas，数量 => ',mintCount,'手续费netfee =>',net_fee);login=BlackCat.tools.LoginInfo.getCurrentLogin();_context77.prev=5;_context77.next=8;return BlackCat.tools.CoinTool.getassets();case 8:utxos_assets=_context77.sent;console.log("[BlaCat]",'[PayView]','utxos_assets => ',utxos_assets);scriptaddress=BlackCat.tools.CoinTool.id_SGAS.hexToBytes().reverse();nepAddress=ThinNeo.Helper.GetAddressFromScriptHash(scriptaddress);makeTranRes=BlackCat.tools.CoinTool.makeTran(utxos_assets,nepAddress,BlackCat.tools.CoinTool.id_GAS,Neo.Fixed8.fromNumber(Number(mintCount)),Neo.Fixed8.fromNumber(Number(net_fee)));_context77.next=21;break;case 15:_context77.prev=15;_context77.t0=_context77['catch'](5);BlackCat.Main.viewMgr.viewLoading.remove();errmsg=BlackCat.Main.langMgr.get(_context77.t0.message);if(errmsg){BlackCat.Main.showErrMsg(_context77.t0.message);}else{BlackCat.Main.showErrMsg("pay_makeMintGasNotEnough");}return _context77.abrupt('return');case 21:sb=new ThinNeo.ScriptBuilder();sb.EmitParamJson([]);sb.EmitPushString("mintTokens");sb.EmitAppCall(scriptaddress);tran=makeTranRes.info.tran;oldarr=makeTranRes.info.oldarr;tran.type=ThinNeo.TransactionType.InvocationTransaction;tran.extdata=new ThinNeo.InvokeTransData();tran.extdata.script=sb.ToArray();tran.extdata.gas=Neo.Fixed8.fromNumber(Number(net_fee));msg=tran.GetMessage();signdata=ThinNeo.Helper.Sign(msg,login.prikey);tran.AddWitness(signdata,login.pubkey,login.address);txid=tran.GetHash().clone().reverse().toHexString();data=tran.GetRawData();_context77.next=38;return BlackCat.tools.WWW.api_postRawTransaction(data);case 38:r=_context77.sent;if(!r){_context77.next=58;break;}if(!(r["txid"]||r["sendrawtransactionresult"])){_context77.next=54;break;}if(!r["txid"]||r["txid"]==""){r["txid"]=txid;}_context77.next=44;return BlackCat.ApiTool.addUserWalletLogs(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,r["txid"],"0",mintCount,"1",'{"sbParamJson":"[]", "sbPushString": "mintTokens", "nnc": "'+BlackCat.tools.CoinTool.id_SGAS+'"}',BlackCat.Main.netMgr.type,"0",net_fee);case 44:logRes=_context77.sent;_context77.next=47;return BlackCat.tools.WWW.api_getHeight_nodes();case 47:height=_context77.sent;oldarr.map(function(old){return old.height=height;});BlackCat.tools.OldUTXO.oldutxosPush(oldarr);BlackCat.Main.viewMgr.viewLoading.remove();this.doGetWalletLists(1);_context77.next=56;break;case 54:BlackCat.Main.viewMgr.viewLoading.remove();BlackCat.Main.showErrMsg("pay_makeMintDoFail");case 56:_context77.next=60;break;case 58:BlackCat.Main.viewMgr.viewLoading.remove();BlackCat.Main.showErrMsg("pay_makeMintDoFail2");case 60:case'end':return _context77.stop();}}},_callee77,this,[[5,15]]);}));}},{key:'makeRefundTransaction',value:function makeRefundTransaction(){var id_SGAS=arguments.length>0&&arguments[0]!==undefined?arguments[0]:BlackCat.tools.CoinTool.id_SGAS;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee78(){var refundCount,sendCount,net_fee,scriptaddress,login,utxos_assets,us,us_random,count,i,sb,data,r,stack,value,nepAddress,makeTranRes,user_utxos_assets,user_makeTranRes,user_tran,_i2,_i3,user_oldarr,_i4,errmsg,sgasScript,scriptHash,tran,oldarr,wsb,signdata,txid,trandata,paramJson_tmp,logRes,height;return regeneratorRuntime.wrap(function _callee78$(_context78){while(1){switch(_context78.prev=_context78.next){case 0:BlackCat.Main.viewMgr.change("ViewLoading");refundCount=BlackCat.Main.viewMgr.viewTransCount.inputCount.value;sendCount=Neo.Fixed8.fromNumber(Number(refundCount));net_fee=BlackCat.Main.viewMgr.viewTransCount.net_fee;console.log("[BlaCat]",'[PayView]','退到gas，数量 => ',refundCount,'手续费netfee =>',net_fee);scriptaddress=id_SGAS.hexToBytes().reverse();login=BlackCat.tools.LoginInfo.getCurrentLogin();_context78.next=9;return BlackCat.tools.CoinTool.getsgasAssets(id_SGAS);case 9:utxos_assets=_context78.sent;us=utxos_assets[BlackCat.tools.CoinTool.id_GAS];if(!(us==undefined)){_context78.next=15;break;}BlackCat.Main.viewMgr.viewLoading.remove();BlackCat.Main.showErrMsg("pay_makeRefundSgasNotEnoughUtxo");return _context78.abrupt('return');case 15:us_random=[];BlackCat.Main.randomSort(us,us_random);us=us_random;console.log("[BlaCat]",'[payView]','makeRefundTransaction, us.before => ',us);count=Neo.Fixed8.Zero;i=us.length-1;case 21:if(!(i>=0)){_context78.next=41;break;}if(!(count.compareTo(sendCount)>0)){_context78.next=26;break;}console.log("[BlaCat]",'[payView]','makeRefundTransaction, enough us['+i+'].delete => ',us[i]);delete us[i];return _context78.abrupt('continue',38);case 26:if(!(us[i].n>0)){_context78.next=29;break;}count=count.add(us[i].count);return _context78.abrupt('continue',38);case 29:sb=new ThinNeo.ScriptBuilder();sb.EmitParamJson(["(hex256)"+us[i].txid.toString()]);sb.EmitPushString("getRefundTarget");sb.EmitAppCall(scriptaddress);data=sb.ToArray();_context78.next=36;return BlackCat.tools.WWW.rpc_getInvokescript(data);case 36:r=_context78.sent;if(r){stack=r["stack"];value=stack[0]["value"].toString();if(value.length>0){console.log("[BlaCat]",'[payView]','makeRefundTransaction, us['+i+'].delete => ',us[i]);delete us[i];}else{count=count.add(us[i].count);}}case 38:i--;_context78.next=21;break;case 41:console.log("[BlaCat]",'[payView]','makeRefundTransaction, us.after => ',us);utxos_assets[BlackCat.tools.CoinTool.id_GAS]=us;console.log("[BlaCat]",'[payView]','makeRefundTransaction, utxos_assets.after => ',utxos_assets);_context78.prev=44;nepAddress=ThinNeo.Helper.GetAddressFromScriptHash(scriptaddress);makeTranRes=BlackCat.tools.CoinTool.makeTran(utxos_assets,nepAddress,BlackCat.tools.CoinTool.id_GAS,Neo.Fixed8.fromNumber(Number(refundCount)));if(!(Number(net_fee)>0)){_context78.next=68;break;}_context78.prev=48;_context78.next=51;return BlackCat.tools.CoinTool.getassets();case 51:user_utxos_assets=_context78.sent;console.log("[BlaCat]",'[PayView]','makeRefundTransaction, user_utxos_assets => ',user_utxos_assets);user_makeTranRes=BlackCat.tools.CoinTool.makeTran(user_utxos_assets,BlackCat.Main.user.info.wallet,BlackCat.tools.CoinTool.id_GAS,Neo.Fixed8.Zero,Neo.Fixed8.fromNumber(Number(net_fee)));user_tran=user_makeTranRes.info.tran;for(_i2=0;_i2<user_tran.inputs.length;_i2++){makeTranRes.info.tran.inputs.push(user_tran.inputs[_i2]);}for(_i3=0;_i3<user_tran.outputs.length;_i3++){makeTranRes.info.tran.outputs.push(user_tran.outputs[_i3]);}user_oldarr=user_makeTranRes.info.oldarr;for(_i4=0;_i4<user_oldarr.length;_i4++){makeTranRes.info.oldarr.push(user_oldarr[_i4]);}console.log("[BlaCat]",'[PayView]','makeRefundTransaction, user_makeTranRes => ',user_makeTranRes);_context78.next=68;break;case 62:_context78.prev=62;_context78.t0=_context78['catch'](48);BlackCat.Main.viewMgr.viewLoading.remove();errmsg=BlackCat.Main.langMgr.get(_context78.t0.message);if(errmsg){BlackCat.Main.showErrMsg(_context78.t0.message);}else{BlackCat.Main.showErrMsg("pay_makeMintGasNotEnough");}return _context78.abrupt('return');case 68:_context78.next=75;break;case 70:_context78.prev=70;_context78.t1=_context78['catch'](44);BlackCat.Main.viewMgr.viewLoading.remove();BlackCat.Main.showErrMsg("pay_makeRefundSgasNotEnough");return _context78.abrupt('return');case 75:console.log("[BlaCat]","[payView]","makeRefundTransaction, makeTranRes => ",makeTranRes);_context78.next=78;return BlackCat.tools.WWW.api_getcontractstate(id_SGAS);case 78:r=_context78.sent;if(!(r&&r["script"])){_context78.next=134;break;}sgasScript=r["script"].hexToBytes();scriptHash=ThinNeo.Helper.GetPublicKeyScriptHash_FromAddress(login.address);sb=new ThinNeo.ScriptBuilder();sb.EmitParamJson(["(bytes)"+scriptHash.toHexString()]);sb.EmitPushString("refund");sb.EmitAppCall(scriptaddress);tran=makeTranRes.info.tran;oldarr=makeTranRes.info.oldarr;tran.type=ThinNeo.TransactionType.InvocationTransaction;tran.extdata=new ThinNeo.InvokeTransData();tran.extdata.script=sb.ToArray();if(Number(net_fee)>0)tran.extdata.gas=Neo.Fixed8.fromNumber(Number(net_fee));tran.attributes=new Array(1);tran.attributes[0]=new ThinNeo.Attribute();tran.attributes[0].usage=ThinNeo.TransactionAttributeUsage.Script;tran.attributes[0].data=scriptHash;wsb=new ThinNeo.ScriptBuilder();wsb.EmitPushString("whatever");wsb.EmitPushNumber(new Neo.BigInteger(250));tran.AddWitnessScript(sgasScript,wsb.ToArray());signdata=ThinNeo.Helper.Sign(tran.GetMessage(),login.prikey);tran.AddWitness(signdata,login.pubkey,login.address);txid=tran.GetHash().clone().reverse().toHexString();trandata=tran.GetRawData();console.log("[BlaCat]",'[payView]','makeRefundTransaction, tran => ',tran);_context78.next=107;return BlackCat.tools.WWW.api_postRawTransaction(trandata);case 107:r=_context78.sent;if(!r){_context78.next=130;break;}if(!(r.txid||r['sendrawtransactionresult'])){_context78.next=125;break;}if(!r["txid"]||r["txid"]==""){r["txid"]=txid;}paramJson_tmp="(bytes)"+scriptHash.toHexString();_context78.next=114;return BlackCat.ApiTool.addUserWalletLogs(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,r.txid,"0",refundCount,"2",'{"sbParamJson":"'+paramJson_tmp+'", "sbPushString": "refund", "nnc": "'+id_SGAS+'"}',BlackCat.Main.netMgr.type);case 114:logRes=_context78.sent;if(logRes.r){BlackCat.Main.platWalletLogId=parseInt(logRes.data);}_context78.next=118;return BlackCat.tools.WWW.api_getHeight_nodes();case 118:height=_context78.sent;oldarr.map(function(old){return old.height=height;});BlackCat.tools.OldUTXO.oldutxosPush(oldarr);BlackCat.Main.viewMgr.viewLoading.remove();this.doGetWalletLists(1);_context78.next=127;break;case 125:BlackCat.Main.viewMgr.viewLoading.remove();BlackCat.Main.showErrMsg("pay_makeRefundDoFail");case 127:console.log("[BlaCat]",'[payView]','makeRefundTransaction, api_postRawTransaction结果 => ',r);_context78.next=132;break;case 130:BlackCat.Main.viewMgr.viewLoading.remove();BlackCat.Main.showErrMsg("pay_makeRefundDoFail2");case 132:_context78.next=136;break;case 134:BlackCat.Main.viewMgr.viewLoading.remove();BlackCat.Main.showErrMsg("pay_makeRefundGetScriptFail");case 136:case'end':return _context78.stop();}}},_callee78,this,[[44,70],[48,62]]);}));}},{key:'doMakeReceivables',value:function doMakeReceivables(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee79(){return regeneratorRuntime.wrap(function _callee79$(_context79){while(1){switch(_context79.prev=_context79.next){case 0:this.hidden();BlackCat.PayReceivablesView.refer="PayView";BlackCat.Main.viewMgr.change("PayReceivablesView");case 3:case'end':return _context79.stop();}}},_callee79,this);}));}},{key:'doMakeTransfer',value:function doMakeTransfer(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee80(){var _this100=this;return regeneratorRuntime.wrap(function _callee80$(_context80){while(1){switch(_context80.prev=_context80.next){case 0:if(BlackCat.Main.isWalletOpen()){BlackCat.PayTransferView.refer="PayView";BlackCat.PayTransferView.callback=function(){_this100.doGetWalletLists(1);};BlackCat.Main.viewMgr.change("PayTransferView");}else{BlackCat.ViewWalletOpen.refer="PayView";BlackCat.ViewWalletOpen.callback=function(){_this100.doMakeTransfer();};BlackCat.Main.viewMgr.change("ViewWalletOpen");}case 1:case'end':return _context80.stop();}}},_callee80,this);}));}},{key:'flushListCtm',value:function flushListCtm(){var ctms=document.getElementsByClassName("listCtm");if(ctms&&ctms.length>0){for(var k=0;k<ctms.length;k++){var list={ctm:ctms[k].getAttribute("ctm")};ctms[k].textContent=this.getListCtmMsg(list);}}}},{key:'getNetTypeName',value:function getNetTypeName(){return BlackCat.Main.langMgr.get("pay_nettype_"+BlackCat.Main.netMgr.type);}},{key:'showChangeNetType',value:function showChangeNetType(){if(this.divNetSelect.innerHTML.length>0){this.divNetSelect.innerHTML="";}else{var other=BlackCat.Main.netMgr.getOtherTypes();for(var i=0;i<other.length;i++){this.ObjAppend(this.divNetSelect,this.getDivNetSelectType(other[i]));}}}},{key:'getDivNetSelectType',value:function getDivNetSelectType(type){var divObj=this.objCreate("div");divObj.textContent=BlackCat.Main.langMgr.get("pay_nettype_"+type);divObj.onclick=function(){BlackCat.Main.changeNetType(type);};return divObj;}},{key:'checkTransCount',value:function checkTransCount(count){var regex=/(?!^0*(\.0{1,2})?$)^\d{1,14}(\.\d{1,8})?$/;if(!regex.test(count)){return false;}if(Number(count)<=0){return false;}return true;}},{key:'getHeight',value:function getHeight(type){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee81(){var height;return regeneratorRuntime.wrap(function _callee81$(_context81){while(1){switch(_context81.prev=_context81.next){case 0:_context81.next=2;return BlackCat.tools.WWW["api_getHeight_"+type]();case 2:height=_context81.sent;this.updateHeight(type,height);case 4:case'end':return _context81.stop();}}},_callee81,this);}));}},{key:'updateHeight',value:function updateHeight(type,height){this["divHeight_"+type].textContent=height.toString();this["height_"+type]=height;}}]);return PayView;}(BlackCat.ViewBase);BlackCat.PayView=PayView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var PayWalletDetailView=function(_BlackCat$ViewBase23){_inherits(PayWalletDetailView,_BlackCat$ViewBase23);function PayWalletDetailView(){_classCallCheck(this,PayWalletDetailView);return _possibleConstructorReturn(this,(PayWalletDetailView.__proto__||Object.getPrototypeOf(PayWalletDetailView)).apply(this,arguments));}_createClass(PayWalletDetailView,[{key:'reset',value:function reset(){this.private_wif="";this.private_hex="";}},{key:'create',value:function create(){var _this102=this;this.getWalletInfo();this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_walletdetail");var header=this.objCreate("div");header.classList.add("pc_header");this.ObjAppend(this.div,header);var returnA=this.objCreate("a");returnA.classList.add("iconfont","icon-fanhui");returnA.textContent=BlackCat.Main.langMgr.get("return");returnA.onclick=function(){_this102.return();};this.ObjAppend(header,returnA);var headerH1=this.objCreate("h1");headerH1.textContent=BlackCat.Main.langMgr.get("pay_walletDetail");this.ObjAppend(header,headerH1);var content=this.objCreate("div");content.classList.add("pc_paydetail");content.innerHTML="<ul><li>"+BlackCat.Main.langMgr.get("pay_walletDetail_addr")+"<p>"+this.wallet_addr+"</p></li>"+"<li>"+BlackCat.Main.langMgr.get("pay_walletDetail_key")+"<p>"+this.public_key+"</p></li>"+"<li class='pc_detailhide'>"+BlackCat.Main.langMgr.get("pay_walletDetail_hex")+"<p>"+this.private_hex+"</p></li>"+"<li class='pc_detailhide'>"+BlackCat.Main.langMgr.get("pay_walletDetail_wif")+"<p>"+this.private_wif+"</p></li>";this.ObjAppend(this.div,content);var divNotes=this.objCreate("div");divNotes.classList.add("pc_paydetailnotes");divNotes.innerText=BlackCat.Main.langMgr.get("pay_walletDetail_notice");this.ObjAppend(content,divNotes);var iMoreshow=this.objCreate("i");iMoreshow.classList.add("iconfont","icon-gengduo1");iMoreshow.onclick=function(){content.classList.add("pc_paydetailshow");iMoreshow.style.display="none";iMorehide.style.display="block";};this.ObjAppend(divNotes,iMoreshow);var iMorehide=this.objCreate("i");iMorehide.style.display="none";iMorehide.classList.add("iconfont","icon-gengduo1");iMorehide.onclick=function(){content.classList.remove("pc_paydetailshow");iMorehide.style.display="none";iMoreshow.style.display="block";};this.ObjAppend(divNotes,iMorehide);this.walletExport=this.objCreate("a");this.walletExport.classList.add("pc_walletExport");this.walletExport.textContent=BlackCat.Main.langMgr.get("pay_walletDetail_export");this.walletExport.setAttribute("download",this.wallet_addr+".json");this.ObjAppend(this.div,this.walletExport);this.exportWallet();var iWalletExport=this.objCreate("i");iWalletExport.classList.add("iconfont","icon-daochuqianbao");this.ObjAppend(this.walletExport,iWalletExport);}},{key:'toRefer',value:function toRefer(){if(PayWalletDetailView.refer){BlackCat.Main.viewMgr.change(PayWalletDetailView.refer);PayWalletDetailView.refer=null;}}},{key:'getWalletInfo',value:function getWalletInfo(){var login=BlackCat.tools.LoginInfo.getCurrentLogin();this.wallet_addr=BlackCat.tools.LoginInfo.getCurrentAddress();this.public_key=login.pubkey.toHexString();this.private_wif=ThinNeo.Helper.GetWifFromPrivateKey(login.prikey);this.private_hex=login.prikey.toHexString();}},{key:'exportWallet',value:function exportWallet(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee82(){var blob,url;return regeneratorRuntime.wrap(function _callee82$(_context82){while(1){switch(_context82.prev=_context82.next){case 0:_context82.t0=BlackCat.Main.wallet.filestr;if(_context82.t0){_context82.next=5;break;}_context82.next=4;return BlackCat.Main.wallet.readWalletFile(1);case 4:_context82.t0=_context82.sent;case 5:if(!_context82.t0){_context82.next=9;break;}blob=new Blob([ThinNeo.Helper.String2Bytes(BlackCat.Main.wallet.filestr)]);url=URL.createObjectURL(blob);this.walletExport.setAttribute('href',url);case 9:case'end':return _context82.stop();}}},_callee82,this);}));}}]);return PayWalletDetailView;}(BlackCat.ViewBase);BlackCat.PayWalletDetailView=PayWalletDetailView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var RegisterView=function(_BlackCat$ViewBase24){_inherits(RegisterView,_BlackCat$ViewBase24);function RegisterView(){_classCallCheck(this,RegisterView);var _this103=_possibleConstructorReturn(this,(RegisterView.__proto__||Object.getPrototypeOf(RegisterView)).call(this));_this103.getCodeRetryMax=60;_this103.getCodeRetry_curr=0;return _this103;}_createClass(RegisterView,[{key:'create',value:function create(){var _this104=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_login","pc_register");var divLogo=this.objCreate("div");divLogo.classList.add("pc_login_logo","iconfont","icon-blacat");this.ObjAppend(this.div,divLogo);var divTitle=this.objCreate("div");divTitle.classList.add("pc_login_title");this.ObjAppend(this.div,divTitle);var h1TitleType=this.objCreate("h1");h1TitleType.classList.add("pc_title_tyle");h1TitleType.textContent=BlackCat.Main.langMgr.get("register_title");this.ObjAppend(divTitle,h1TitleType);var divTitleobj=this.objCreate("div");divTitleobj.classList.add("pc_title_switch");this.ObjAppend(divTitle,divTitleobj);var aTiletMobile=this.objCreate("a");aTiletMobile.classList.add("pc_tiletmobile","pc_active");aTiletMobile.style.borderLeft="0";aTiletMobile.textContent=BlackCat.Main.langMgr.get("main_phone");aTiletMobile.onclick=function(){areaSelect.style.display="block";aTiletMobile.classList.add("pc_active");aTilEtEmail.classList.remove("pc_active");iIshurushouji.classList.add("icon-shurushouji");iIshurushouji.classList.remove("icon-xinxi");_this104.inputAccount.value="";_this104.inputCode.value="";_this104.accountType="phone";_this104.inputAccount.placeholder=BlackCat.Main.langMgr.get("register_input"+_this104.accountType);};this.ObjAppend(divTitleobj,aTiletMobile);var aTilEtEmail=this.objCreate("a");aTilEtEmail.textContent=BlackCat.Main.langMgr.get("main_email");aTilEtEmail.onclick=function(){areaSelect.style.display="none";aTilEtEmail.classList.add("pc_active");aTiletMobile.classList.remove("pc_active");iIshurushouji.classList.add("icon-xinxi");iIshurushouji.classList.remove("icon-shurushouji");_this104.inputAccount.value="";_this104.inputCode.value="";_this104.accountType="email";_this104.inputAccount.placeholder=BlackCat.Main.langMgr.get("register_input"+_this104.accountType);};this.ObjAppend(divTitleobj,aTilEtEmail);var divInput=this.objCreate("div");divInput.classList.add("pc_login_input");this.ObjAppend(this.div,divInput);var userName=this.objCreate("div");userName.classList.add("pc_login_inputbox");this.ObjAppend(divInput,userName);var iUserName=this.objCreate("i");iUserName.classList.add("iconfont","icon-my");this.ObjAppend(userName,iUserName);this.inputUid=this.objCreate("input");this.inputUid.type="text";this.inputUid.placeholder=BlackCat.Main.langMgr.get("register_inputUid");this.inputUid.onblur=function(){_this104.validateUid();};this.ObjAppend(userName,this.inputUid);var areaSelect=this.objCreate("div");areaSelect.classList.add("pc_login_inputbox");this.ObjAppend(divInput,areaSelect);var iRegion=this.objCreate("i");iRegion.classList.add("iconfont","icon-diqiu");this.ObjAppend(areaSelect,iRegion);this.selectArea=this.objCreate("select");var areaInfo=BlackCat.AreaView.getAreaByLang(BlackCat.Main.langMgr.type);areaInfo.forEach(function(area){var option=_this104.objCreate("option");option.setAttribute("value",area.codename);option.textContent=BlackCat.Main.langMgr.get("area_code_"+area.codename);if(area.codename=="CN"){option.setAttribute("selected","selected");}_this104.selectArea.options.add(option);});this.selectArea.onchange=function(){areaInfo.forEach(function(area){if(area.codename==_this104.selectArea.value){_this104.divArea.textContent=area.areacode;}});};this.ObjAppend(areaSelect,this.selectArea);this.divArea=this.objCreate("div");this.divArea.classList.add("pc_area");areaInfo.forEach(function(area){if(area.codename==_this104.selectArea.value){_this104.divArea.textContent=area.areacode;}});this.ObjAppend(areaSelect,this.divArea);var aArea=this.objCreate("a");aArea.classList.add("pc_areaa","iconfont","icon-xiala");this.ObjAppend(areaSelect,aArea);var divTel=this.objCreate("div");divTel.classList.add("pc_login_inputbox");this.ObjAppend(divInput,divTel);var iIshurushouji=this.objCreate("i");iIshurushouji.classList.add("iconfont","icon-shurushouji");this.ObjAppend(divTel,iIshurushouji);this.inputAccount=this.objCreate("input");this.inputAccount.type="text";this.inputAccount.placeholder=BlackCat.Main.langMgr.get("register_inputphone");this.inputAccount.onblur=function(){_this104.validateAccount();};this.ObjAppend(divTel,this.inputAccount);var divCode=this.objCreate("div");divCode.classList.add("pc_login_inputbox");this.ObjAppend(divInput,divCode);var iDivCode=this.objCreate("i");iDivCode.classList.add("iconfont","icon-dunpai1");this.ObjAppend(divCode,iDivCode);this.inputCode=this.objCreate("input");this.inputCode.type="text";this.inputCode.style.width="60%";this.inputCode.placeholder=BlackCat.Main.langMgr.get("register_inputCode");this.ObjAppend(divCode,this.inputCode);var divPass=this.objCreate("div");divPass.classList.add("pc_login_inputbox");this.ObjAppend(divInput,divPass);var iPass=this.objCreate("i");iPass.classList.add("iconfont","icon-mima");this.ObjAppend(divPass,iPass);this.inputPass=this.objCreate("input");this.inputPass.type="password";this.inputPass.placeholder=BlackCat.Main.langMgr.get("register_inputPass");this.ObjAppend(divPass,this.inputPass);var divVPass=this.objCreate("div");divVPass.classList.add("pc_login_inputbox");this.ObjAppend(divInput,divVPass);var iVPass=this.objCreate("i");iVPass.classList.add("iconfont","icon-mima");this.ObjAppend(divVPass,iVPass);this.inputVpass=this.objCreate("input");this.inputVpass.type="password";this.inputVpass.placeholder=BlackCat.Main.langMgr.get("register_inputVpass");this.ObjAppend(divVPass,this.inputVpass);this.getCode=this.objCreate("button");this.getCode.textContent=BlackCat.Main.langMgr.get("register_getCode");this.getCode.onclick=function(){_this104.doGetCode();};this.ObjAppend(divCode,this.getCode);this.getCodeCount=this.objCreate("button");this.getCodeCount.classList.add("pc_getPhoneCodecount");this.getCodeCount.textContent=BlackCat.Main.langMgr.get("register_getCodecount");this.ObjAppend(divCode,this.getCodeCount);var doRegister=this.objCreate("button");doRegister.classList.add("pc_doLogin");doRegister.textContent=BlackCat.Main.langMgr.get("register_doRegister");doRegister.onclick=function(){_this104.doRegister();};this.ObjAppend(divInput,doRegister);var doLogin=this.objCreate("button");doLogin.classList.add("pc_loginregion");doLogin.textContent=BlackCat.Main.langMgr.get("register_doLogin");doLogin.onclick=function(){_this104.remove();BlackCat.Main.viewMgr.change("LoginView");};this.ObjAppend(divInput,doLogin);}},{key:'start',value:function start(){_get(RegisterView.prototype.__proto__||Object.getPrototypeOf(RegisterView.prototype),'start',this).call(this);this.inputUid.focus();}},{key:'update',value:function update(){_get(RegisterView.prototype.__proto__||Object.getPrototypeOf(RegisterView.prototype),'update',this).call(this);this.doRetryCount(0);}},{key:'reset',value:function reset(){if(this.s_getCodeCountRetry)clearInterval(this.s_getCodeCountRetry);this.accountType="phone";}},{key:'empty',value:function empty(value){if(value.toString().length==0){return true;}return false;}},{key:'getPhone',value:function getPhone(){return BlackCat.Main.getPhone(this.selectArea.value,this.inputAccount.value);}},{key:'checkAccountFromApi',value:function checkAccountFromApi(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee83(){var res;return regeneratorRuntime.wrap(function _callee83$(_context83){while(1){switch(_context83.prev=_context83.next){case 0:_context83.t0=this.accountType;_context83.next=_context83.t0==='email'?3:_context83.t0==='phone'?7:11;break;case 3:_context83.next=5;return BlackCat.ApiTool.validEmail(this.inputAccount.value);case 5:res=_context83.sent;return _context83.abrupt('break',12);case 7:_context83.next=9;return BlackCat.ApiTool.validPhone(this.getPhone());case 9:res=_context83.sent;return _context83.abrupt('break',12);case 11:return _context83.abrupt('return');case 12:if(res.r){_context83.next=15;break;}BlackCat.Main.showErrCode(res.errCode);return _context83.abrupt('return',false);case 15:return _context83.abrupt('return',true);case 16:case'end':return _context83.stop();}}},_callee83,this);}));}},{key:'checkUidFromApi',value:function checkUidFromApi(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee84(){var res;return regeneratorRuntime.wrap(function _callee84$(_context84){while(1){switch(_context84.prev=_context84.next){case 0:_context84.next=2;return BlackCat.ApiTool.validUid(this.inputUid.value);case 2:res=_context84.sent;if(res.r){_context84.next=6;break;}BlackCat.Main.showErrCode(res.errCode);return _context84.abrupt('return',false);case 6:return _context84.abrupt('return',true);case 7:case'end':return _context84.stop();}}},_callee84,this);}));}},{key:'validateAccount',value:function validateAccount(){var emptySkip=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee85(){return regeneratorRuntime.wrap(function _callee85$(_context85){while(1){switch(_context85.prev=_context85.next){case 0:if(!this.empty(this.inputAccount.value)){_context85.next=5;break;}if(!emptySkip){_context85.next=3;break;}return _context85.abrupt('return');case 3:BlackCat.Main.showErrMsg("register_input"+this.accountType+"_err");return _context85.abrupt('return',false);case 5:_context85.next=7;return BlackCat.Main.validateFormat(this.accountType,this.inputAccount);case 7:_context85.t0=_context85.sent;if(!(_context85.t0==false)){_context85.next=10;break;}return _context85.abrupt('return',false);case 10:_context85.next=12;return this.checkAccountFromApi();case 12:return _context85.abrupt('return',_context85.sent);case 13:case'end':return _context85.stop();}}},_callee85,this);}));}},{key:'validateUid',value:function validateUid(){var emptySkip=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee86(){return regeneratorRuntime.wrap(function _callee86$(_context86){while(1){switch(_context86.prev=_context86.next){case 0:if(!this.empty(this.inputUid.value)){_context86.next=5;break;}if(!emptySkip){_context86.next=3;break;}return _context86.abrupt('return',false);case 3:BlackCat.Main.showErrMsg("register_inputUid_err");return _context86.abrupt('return',false);case 5:_context86.next=7;return BlackCat.Main.validateFormat("user",this.inputUid);case 7:_context86.t0=_context86.sent;if(!(_context86.t0==false)){_context86.next=10;break;}return _context86.abrupt('return',false);case 10:_context86.next=12;return this.checkUidFromApi();case 12:return _context86.abrupt('return',_context86.sent);case 13:case'end':return _context86.stop();}}},_callee86,this);}));}},{key:'validateCode',value:function validateCode(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee87(){return regeneratorRuntime.wrap(function _callee87$(_context87){while(1){switch(_context87.prev=_context87.next){case 0:if(!this.empty(this.inputCode.value)){_context87.next=3;break;}BlackCat.Main.showErrMsg("register_inputCode_err");return _context87.abrupt('return',false);case 3:_context87.next=5;return BlackCat.Main.validateFormat("vcode",this.inputCode);case 5:return _context87.abrupt('return',_context87.sent);case 6:case'end':return _context87.stop();}}},_callee87,this);}));}},{key:'validatePass',value:function validatePass(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee88(){return regeneratorRuntime.wrap(function _callee88$(_context88){while(1){switch(_context88.prev=_context88.next){case 0:if(!this.empty(this.inputPass.value)){_context88.next=3;break;}BlackCat.Main.showErrMsg("register_inputPass_err");return _context88.abrupt('return',false);case 3:return _context88.abrupt('return',true);case 4:case'end':return _context88.stop();}}},_callee88,this);}));}},{key:'validateVpass',value:function validateVpass(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee89(){return regeneratorRuntime.wrap(function _callee89$(_context89){while(1){switch(_context89.prev=_context89.next){case 0:if(!this.empty(this.inputVpass.value)){_context89.next=3;break;}BlackCat.Main.showErrMsg("register_inputVpass_err");return _context89.abrupt('return',false);case 3:if(!(this.inputVpass.value!=this.inputPass.value)){_context89.next=6;break;}BlackCat.Main.showErrMsg("register_inputVpass_inputPass_err");return _context89.abrupt('return',false);case 6:return _context89.abrupt('return',true);case 7:case'end':return _context89.stop();}}},_callee89,this);}));}},{key:'doRegister',value:function doRegister(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee90(){var _this105=this;var res,wallet_file;return regeneratorRuntime.wrap(function _callee90$(_context90){while(1){switch(_context90.prev=_context90.next){case 0:_context90.next=2;return this.validateUid(false);case 2:if(_context90.sent){_context90.next=4;break;}return _context90.abrupt('return');case 4:_context90.next=6;return this.validateAccount(false);case 6:if(_context90.sent){_context90.next=8;break;}return _context90.abrupt('return');case 8:_context90.next=10;return this.validateCode();case 10:if(_context90.sent){_context90.next=12;break;}return _context90.abrupt('return');case 12:_context90.next=14;return this.validatePass();case 14:if(_context90.sent){_context90.next=16;break;}return _context90.abrupt('return');case 16:_context90.next=18;return this.validateVpass();case 18:if(_context90.sent){_context90.next=20;break;}return _context90.abrupt('return');case 20:if(!(this.inputPass.value.length>32)){_context90.next=23;break;}BlackCat.Main.showErrMsg("register_exceed",function(){_this105.inputPass.focus();});return _context90.abrupt('return');case 23:_context90.t0=this.accountType;_context90.next=_context90.t0==='email'?26:_context90.t0==='phone'?30:34;break;case 26:_context90.next=28;return BlackCat.ApiTool.registerByEmail(this.inputAccount.value,this.inputCode.value,this.inputVpass.value,this.selectArea.value,this.inputUid.value);case 28:res=_context90.sent;return _context90.abrupt('break',35);case 30:_context90.next=32;return BlackCat.ApiTool.registerByPhone(this.getPhone(),this.inputCode.value,this.inputVpass.value,this.selectArea.value,this.inputUid.value);case 32:res=_context90.sent;return _context90.abrupt('break',35);case 34:return _context90.abrupt('return');case 35:if(!res.r){_context90.next=49;break;}localStorage.setItem(BlackCat.Main.user.cacheKey,JSON.stringify(res.data));BlackCat.Main.user.getInfo();if(!res.data.wallet){_context90.next=45;break;}_context90.next=41;return BlackCat.ApiTool.getWalletFile(res.data.uid,res.data.token);case 41:wallet_file=_context90.sent;if(wallet_file.r){localStorage.setItem(res.data.wallet,wallet_file.data);this.remove();BlackCat.Main.viewMgr.change("PayView");}else{BlackCat.Main.showErrMsg("login_walletDownloadFail");}_context90.next=47;break;case 45:this.remove();BlackCat.Main.viewMgr.change("WalletView");case 47:_context90.next=50;break;case 49:BlackCat.Main.showErrCode(res.errCode);case 50:case'end':return _context90.stop();}}},_callee90,this);}));}},{key:'doRetryCount',value:function doRetryCount(type){var _this106=this;switch(type){case 0:if(this.s_getCodeCountRetry){this.getCode.style.display="none";this.getCodeCount.style.display="block";}break;case 1:this.getCodeRetry_curr=this.getCodeRetryMax;this.getCode.style.display="none";this.getCodeCount.style.display="block";this.s_getCodeCountRetry=setInterval(function(){_this106._doRetryCount();},1000);break;}}},{key:'_doRetryCount',value:function _doRetryCount(){if(this.getCodeRetry_curr>0&&this.getCodeCount!=null){this.getCodeRetry_curr--;this.getCodeCount.innerText=BlackCat.Main.langMgr.get("register_getCodecountRetry")+"("+this.getCodeRetry_curr+")";}else if(this.getCodeCount!=null){clearInterval(this.s_getCodeCountRetry);this.getCodeCount.style.display="none";this.getCode.style.display="block";this.getCodeRetry_curr=0;}else{clearInterval(this.s_getCodeCountRetry);this.getCodeRetry_curr=0;}}},{key:'doGetCode',value:function doGetCode(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee91(){var _this107=this;var res;return regeneratorRuntime.wrap(function _callee91$(_context91){while(1){switch(_context91.prev=_context91.next){case 0:if(!this.empty(this.inputAccount.value)){_context91.next=3;break;}BlackCat.Main.showErrMsg("register_input"+this.accountType+"_err",function(){_this107.inputAccount.focus();});return _context91.abrupt('return');case 3:BlackCat.Main.viewMgr.change("ViewLoading");_context91.next=6;return this.checkAccountFromApi();case 6:if(_context91.sent){_context91.next=9;break;}BlackCat.Main.viewMgr.viewLoading.remove();return _context91.abrupt('return');case 9:_context91.prev=9;_context91.t0=this.accountType;_context91.next=_context91.t0==='email'?13:_context91.t0==='phone'?17:21;break;case 13:_context91.next=15;return BlackCat.ApiTool.getEmailCode(this.inputAccount.value,BlackCat.Main.langMgr.type);case 15:res=_context91.sent;return _context91.abrupt('break',22);case 17:_context91.next=19;return BlackCat.ApiTool.getPhoneCode(this.getPhone());case 19:res=_context91.sent;return _context91.abrupt('break',22);case 21:return _context91.abrupt('return');case 22:_context91.next=27;break;case 24:_context91.prev=24;_context91.t1=_context91['catch'](9);console.log("[BlaCat]",'[RegisterView]','doGetCode, ApiTool.getxxCode','error => ',_context91.t1.toString());case 27:BlackCat.Main.viewMgr.viewLoading.remove();if(res.r){this.doRetryCount(1);BlackCat.Main.showToast("register_getCodeSucc");}else{BlackCat.Main.showErrCode(res.errCode);}case 29:case'end':return _context91.stop();}}},_callee91,this,[[9,24]]);}));}}]);return RegisterView;}(BlackCat.ViewBase);BlackCat.RegisterView=RegisterView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var SecurityCenterView=function(_BlackCat$ViewBase25){_inherits(SecurityCenterView,_BlackCat$ViewBase25);function SecurityCenterView(){_classCallCheck(this,SecurityCenterView);return _possibleConstructorReturn(this,(SecurityCenterView.__proto__||Object.getPrototypeOf(SecurityCenterView)).apply(this,arguments));}_createClass(SecurityCenterView,[{key:'create',value:function create(){var _this109=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_security");var header=this.objCreate("div");header.classList.add("pc_header");this.ObjAppend(this.div,header);var returnA=this.objCreate("a");returnA.classList.add("iconfont","icon-fanhui");returnA.textContent=BlackCat.Main.langMgr.get("return");returnA.onclick=function(){_this109.return();};this.ObjAppend(header,returnA);var headerH1=this.objCreate("h1");headerH1.textContent=BlackCat.Main.langMgr.get("security_title");this.ObjAppend(header,headerH1);var divSecurity=this.objCreate("div");divSecurity.classList.add("pc_myinfolist");this.ObjAppend(this.div,divSecurity);var ulSecurity=this.objCreate("ul");this.ObjAppend(divSecurity,ulSecurity);var liTrust=this.objCreate("li");liTrust.style.cursor="pointer";liTrust.textContent=BlackCat.Main.langMgr.get("security_trust");liTrust.onclick=function(){_this109.hidden();BlackCat.Main.viewMgr.change("TrustContractView");};this.ObjAppend(ulSecurity,liTrust);var iTrust=this.objCreate("i");iTrust.classList.add("iconfont","icon-gengduo");this.ObjAppend(liTrust,iTrust);var spanTrust=this.objCreate("span");spanTrust.textContent=BlackCat.Main.langMgr.get("security_trust_admin");this.ObjAppend(liTrust,spanTrust);var liSignOut=this.objCreate("li");liSignOut.style.cursor="pointer";liSignOut.textContent=BlackCat.Main.langMgr.get("security_walletOut");liSignOut.onclick=function(){_this109.hidden();BlackCat.Main.viewMgr.change("AutoLogoutWalletView");};this.ObjAppend(ulSecurity,liSignOut);var iSignOut=this.objCreate("i");iSignOut.classList.add("iconfont","icon-gengduo");this.ObjAppend(liSignOut,iSignOut);this.spanSignOut=this.objCreate("span");this.spanSignOut.textContent=this.getWalletOutTimeMaxMsg(BlackCat.Main.getLiveTimeMax());this.ObjAppend(liSignOut,this.spanSignOut);var divwalletOutTips=this.objCreate("div");divwalletOutTips.classList.add("pc_signout_tips");divwalletOutTips.textContent=BlackCat.Main.langMgr.get("security_walletOut_toast");this.ObjAppend(liSignOut,divwalletOutTips);}},{key:'toRefer',value:function toRefer(){BlackCat.Main.viewMgr.myInfoView.show();}},{key:'getWalletOutTimeMaxMsg',value:function getWalletOutTimeMaxMsg(liveTimeMax){if(liveTimeMax>=60*60*1000){var hour=liveTimeMax/(60*60*1000);return BlackCat.Main.langMgr.get("security_walletOut_admin_h",{hours:hour});}else if(liveTimeMax>0){var minute=liveTimeMax/(60*1000);return BlackCat.Main.langMgr.get("security_walletOut_admin_m",{minutes:minute});}return BlackCat.Main.langMgr.get("security_walletOut_admin");}},{key:'updateWalletOutTimeMaxMsg',value:function updateWalletOutTimeMaxMsg(){this.spanSignOut.textContent=this.getWalletOutTimeMaxMsg(BlackCat.Main.getLiveTimeMax());}}]);return SecurityCenterView;}(BlackCat.ViewBase);BlackCat.SecurityCenterView=SecurityCenterView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var TrustContractView=function(_BlackCat$ViewBase26){_inherits(TrustContractView,_BlackCat$ViewBase26);function TrustContractView(){_classCallCheck(this,TrustContractView);var _this110=_possibleConstructorReturn(this,(TrustContractView.__proto__||Object.getPrototypeOf(TrustContractView)).call(this));_this110.num=BlackCat.Main.viewMgr.payView.listPageNum;_this110.reset();return _this110;}_createClass(TrustContractView,[{key:'create',value:function create(){var _this111=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_paylist","pc_trustcontract");var header=this.objCreate("div");header.classList.add("pc_header");this.ObjAppend(this.div,header);var returnA=this.objCreate("a");returnA.classList.add("iconfont","icon-fanhui");returnA.textContent=BlackCat.Main.langMgr.get("return");returnA.onclick=function(){_this111.return();BlackCat.Main.viewMgr.securityCenterView.show();};this.ObjAppend(header,returnA);var headerH1=this.objCreate("h1");headerH1.textContent=BlackCat.Main.langMgr.get("trust_title");this.ObjAppend(header,headerH1);this.listsDiv=this.objCreate("ul");this.ObjAppend(this.div,this.listsDiv);this.getMoreDiv=this.objCreate("div");this.getMoreDiv.classList.add("pc_listmore");this.getMoreDiv.onclick=function(){_this111.doGetTrustLists();};this.ObjAppend(this.div,this.getMoreDiv);this.doGetTrustLists();}},{key:'remove',value:function remove(){_get(TrustContractView.prototype.__proto__||Object.getPrototypeOf(TrustContractView.prototype),'remove',this).call(this);this.reset();}},{key:'reset',value:function reset(){this.offset=0;this.isLast=false;}},{key:'doGetTrustLists',value:function doGetTrustLists(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee92(){var _this112=this;var res;return regeneratorRuntime.wrap(function _callee92$(_context92){while(1){switch(_context92.prev=_context92.next){case 0:if(!this.isLast){_context92.next=2;break;}return _context92.abrupt('return');case 2:_context92.next=4;return BlackCat.ApiTool.getTrustLists(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,this.offset,this.num);case 4:res=_context92.sent;if(!res.r){_context92.next=15;break;}if(!(res.data&&res.data.length>=1)){_context92.next=12;break;}if(res.data.length<this.num){this.isLast=true;this.getMoreDiv.textContent=BlackCat.Main.langMgr.get("paylist_noMore");}else{this.offset+=this.num;this.getMoreDiv.textContent=BlackCat.Main.langMgr.get("paylist_getMore");}_context92.next=10;return res.data.forEach(function(list){var listObj=_this112.objCreate("li");var img_div=_this112.objCreate("div");img_div.classList.add("pc_listimg");var img=_this112.objCreate("img");img.src=_this112.getListImg(list);_this112.ObjAppend(img_div,img);_this112.ObjAppend(listObj,img_div);var content_div=_this112.objCreate("div");content_div.classList.add("pc_liftinfo");var content_name_div=_this112.objCreate("div");content_name_div.classList.add("pc_listname");content_name_div.textContent=BlackCat.Main.viewMgr.payView.getListName(list);_this112.ObjAppend(content_div,content_name_div);var content_ctm_p=_this112.objCreate("p");content_ctm_p.classList.add("pc_method");content_ctm_p.textContent=_this112.getListNnc(list);_this112.ObjAppend(content_div,content_ctm_p);_this112.ObjAppend(listObj,content_div);var trustObj=_this112.objCreate("a");trustObj.onclick=function(){listObj.remove();_this112.doDelList(list);};trustObj.classList.add("pc_switch","pc_switch_active");var spanSwitchBut=_this112.objCreate("span");_this112.ObjAppend(trustObj,spanSwitchBut);_this112.ObjAppend(listObj,trustObj);_this112.ObjAppend(_this112.listsDiv,listObj);});case 10:_context92.next=13;break;case 12:this.getMoreDiv.textContent=BlackCat.Main.langMgr.get("paylist_noRecord");case 13:_context92.next=16;break;case 15:BlackCat.Main.showErrCode(res.errCode);case 16:case'end':return _context92.stop();}}},_callee92,this);}));}},{key:'getListImg',value:function getListImg(v){return v.icon;}},{key:'getListNnc',value:function getListNnc(v){return v.nnc;}},{key:'doDelList',value:function doDelList(v){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee93(){var res;return regeneratorRuntime.wrap(function _callee93$(_context93){while(1){switch(_context93.prev=_context93.next){case 0:_context93.next=2;return BlackCat.ApiTool.delTrustNncs(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,v.id);case 2:res=_context93.sent;if(res.r){BlackCat.Main.removeTrustNnc(v.nnc);this.offset-=1;BlackCat.Main.showToast("trust_relieve_succ");}else{BlackCat.Main.showErrCode(res.errCode);}case 4:case'end':return _context93.stop();}}},_callee93,this);}));}}]);return TrustContractView;}(BlackCat.ViewBase);BlackCat.TrustContractView=TrustContractView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ViewAlert=function(_BlackCat$ViewBase27){_inherits(ViewAlert,_BlackCat$ViewBase27);function ViewAlert(){_classCallCheck(this,ViewAlert);return _possibleConstructorReturn(this,(ViewAlert.__proto__||Object.getPrototypeOf(ViewAlert)).apply(this,arguments));}_createClass(ViewAlert,[{key:'create',value:function create(){var _this114=this;this.div=this.objCreate("div");this.div.classList.add("pc_alter");var alter=this.objCreate('div');alter.classList.add("pc_alterbox");this.ObjAppend(this.div,alter);var popupTitle=this.objCreate('div');popupTitle.classList.add("pc_altertitle");popupTitle.innerText=BlackCat.Main.langMgr.get("info");this.ObjAppend(alter,popupTitle);var alterText=this.objCreate("div");alterText.classList.add("pc_altertext");var lang_content=BlackCat.Main.langMgr.get(ViewAlert.content,ViewAlert.content_ext);if(!lang_content){lang_content=ViewAlert.content;}alterText.textContent=lang_content;this.ObjAppend(alter,alterText);var popupbutbox=this.objCreate('div');popupbutbox.classList.add("pc_popupbutbox");this.ObjAppend(alter,popupbutbox);var butConfirm=this.objCreate("button");butConfirm.textContent=BlackCat.Main.langMgr.get("ok");butConfirm.onclick=function(){_this114.doConfirm();};this.ObjAppend(popupbutbox,butConfirm);}},{key:'toRefer',value:function toRefer(){if(ViewAlert.refer){BlackCat.Main.viewMgr.change(ViewAlert.refer);ViewAlert.refer=null;}}},{key:'doConfirm',value:function doConfirm(){this.remove(300);if(ViewAlert.callback){ViewAlert.callback();ViewAlert.callback=null;}}}]);return ViewAlert;}(BlackCat.ViewBase);BlackCat.ViewAlert=ViewAlert;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ViewConfirm=function(_BlackCat$ViewBase28){_inherits(ViewConfirm,_BlackCat$ViewBase28);function ViewConfirm(){_classCallCheck(this,ViewConfirm);return _possibleConstructorReturn(this,(ViewConfirm.__proto__||Object.getPrototypeOf(ViewConfirm)).apply(this,arguments));}_createClass(ViewConfirm,[{key:'create',value:function create(){var _this116=this;this.div=this.objCreate("div");this.div.classList.add("pc_alter","pc_confirm");var alter=this.objCreate('div');alter.classList.add("pc_alterbox");this.ObjAppend(this.div,alter);var popupTitle=this.objCreate('div');popupTitle.classList.add("pc_altertitle");popupTitle.innerText=BlackCat.Main.langMgr.get("info");this.ObjAppend(alter,popupTitle);var alterText=this.objCreate("div");alterText.classList.add("pc_altertext");var lang_content=BlackCat.Main.langMgr.get(ViewConfirm.content);if(!lang_content){lang_content=ViewConfirm.content;}alterText.textContent=lang_content;this.ObjAppend(alter,alterText);var popupbutbox=this.objCreate('div');popupbutbox.classList.add("pc_popupbutbox");this.ObjAppend(alter,popupbutbox);var popupClose=this.objCreate("button");popupClose.classList.add("pc_cancel");popupClose.textContent=BlackCat.Main.langMgr.get("cancel");popupClose.onclick=function(){_this116.doCancel();};this.ObjAppend(popupbutbox,popupClose);var butConfirm=this.objCreate("button");butConfirm.textContent=BlackCat.Main.langMgr.get("ok");butConfirm.onclick=function(){_this116.doConfirm();};this.ObjAppend(popupbutbox,butConfirm);}},{key:'toRefer',value:function toRefer(){if(ViewConfirm.refer){BlackCat.Main.viewMgr.change(ViewConfirm.refer);ViewConfirm.refer=null;}}},{key:'doConfirm',value:function doConfirm(){this.remove(300);ViewConfirm.callback(ViewConfirm.callback_params);ViewConfirm.callback_params=null;}},{key:'doCancel',value:function doCancel(){this.remove(300);if(ViewConfirm.callback_cancel){ViewConfirm.callback_cancel(ViewConfirm.callback_params);}ViewConfirm.callback_params=null;}}]);return ViewConfirm;}(BlackCat.ViewBase);BlackCat.ViewConfirm=ViewConfirm;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ViewConnecting=function(_BlackCat$ViewBase29){_inherits(ViewConnecting,_BlackCat$ViewBase29);function ViewConnecting(){_classCallCheck(this,ViewConnecting);var _this117=_possibleConstructorReturn(this,(ViewConnecting.__proto__||Object.getPrototypeOf(ViewConnecting)).apply(this,arguments));_this117.showReturn=false;return _this117;}_createClass(ViewConnecting,[{key:'create',value:function create(){this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_connecting");if(this.showType=="connecting"){this.showConnecting();}else if(this.showType=="retry"){this.showRetry(this.showReturn);}}},{key:'showConnecting',value:function showConnecting(){this.showType="connecting";this.div.innerHTML="";this.div.classList.add("pc_loading");var divConnecting=this.objCreate("div");divConnecting.classList.add("pc_loadingbox");divConnecting.innerHTML="<div class='pc_loading1'></div>"+"<div class='pc_loading2'></div>"+"<div class='pc_loading3'></div>"+"<div class='pc_loading4'></div>"+"<div class='pc_loading5'></div>"+"<div class='pc_loading6'></div>"+"<div class='pc_loading7'></div>"+"<div class='pc_loading8'></div>"+"<div class='pc_loading9'></div>"+"<div class='pc_loading10'></div>"+"<div class='pc_loading11'></div>"+"<div class='pc_loading12'></div>"+"<p id='pc_loadingtext'>"+BlackCat.Main.langMgr.get("netmgr_connecting")+"</p>";this.ObjAppend(this.div,divConnecting);}},{key:'showRetry',value:function showRetry(showReturn){var _this118=this;this.showType="retry";this.showReturn=showReturn;this.div.innerHTML="";var divRetry=this.objCreate("div");divRetry.classList.add("pc_connectingtext");var descDiv=this.objCreate("div");var lang_key="netmgr_connecting_fail";if(ViewConnecting.content){lang_key=ViewConnecting.content;}descDiv.textContent=BlackCat.Main.langMgr.get(lang_key);this.ObjAppend(divRetry,descDiv);if(showReturn){var returnObj=this.objCreate("button");returnObj.classList.add("pc_cancel");returnObj.textContent=BlackCat.Main.langMgr.get("return");returnObj.onclick=function(){_this118.return();};this.ObjAppend(divRetry,returnObj);}var retryObj=this.objCreate("button");retryObj.textContent=BlackCat.Main.langMgr.get("retry");retryObj.onclick=function(){if(ViewConnecting.callback_retry)ViewConnecting.callback_retry();};this.ObjAppend(divRetry,retryObj);this.ObjAppend(this.div,divRetry);}}]);return ViewConnecting;}(BlackCat.ViewBase);BlackCat.ViewConnecting=ViewConnecting;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ViewLoading=function(_BlackCat$ViewBase30){_inherits(ViewLoading,_BlackCat$ViewBase30);function ViewLoading(){_classCallCheck(this,ViewLoading);return _possibleConstructorReturn(this,(ViewLoading.__proto__||Object.getPrototypeOf(ViewLoading)).apply(this,arguments));}_createClass(ViewLoading,[{key:'create',value:function create(){this.div=this.objCreate("div");this.div.classList.add("pc_loading");var divLoading=this.objCreate("div");divLoading.classList.add("pc_loadingbox");var lang_content=BlackCat.Main.langMgr.get(ViewLoading.content);if(!lang_content){lang_content=ViewLoading.content;}divLoading.innerHTML="<div class='pc_loading1'></div>"+"<div class='pc_loading2'></div>"+"<div class='pc_loading3'></div>"+"<div class='pc_loading4'></div>"+"<div class='pc_loading5'></div>"+"<div class='pc_loading6'></div>"+"<div class='pc_loading7'></div>"+"<div class='pc_loading8'></div>"+"<div class='pc_loading9'></div>"+"<div class='pc_loading10'></div>"+"<div class='pc_loading11'></div>"+"<div class='pc_loading12'></div>"+"<p id='pc_loadingtext'>"+lang_content+"</p>";this.ObjAppend(this.div,divLoading);}}]);return ViewLoading;}(BlackCat.ViewBase);ViewLoading.content="";BlackCat.ViewLoading=ViewLoading;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ViewMgr=function(){function ViewMgr(){_classCallCheck(this,ViewMgr);this.mainView=new BlackCat.MainView();this.mainView.start();this.views={};}_createClass(ViewMgr,[{key:'change',value:function change(type){switch(type){case"ViewWalletOpen":console.log("[BlaCat]",'[ViewMgr]','显示打开钱包输入密码界面('+type+') ...');if(!this.viewWalletOpen){this.viewWalletOpen=new BlackCat.ViewWalletOpen();this.views[type]=this.viewWalletOpen;}this.viewWalletOpen.start();break;case"ViewTransCount":console.log("[BlaCat]",'[ViewMgr]','显示输入交易数量界面('+type+') ...');if(!this.viewTransCount){this.viewTransCount=new BlackCat.ViewTransCount();this.views[type]=this.viewTransCount;}this.viewTransCount.start();break;case"ViewTransConfirm":console.log("[BlaCat]",'[viewMgr]','显示确认交易界面('+type+') ...');if(!this.viewTransConfirm){this.viewTransConfirm=new BlackCat.ViewTransConfirm();this.views[type]=this.viewTransConfirm;}this.viewTransConfirm.start();break;case"IconView":console.log("[BlaCat]",'[ViewMgr]','显示SDK图标('+type+') ...');if(!this.iconView){this.iconView=new BlackCat.IconView();this.views[type]=this.iconView;}this.iconView.start();break;case"LoginView":console.log("[BlaCat]",'[ViewMgr]','显示登录('+type+') ...');if(!this.loginView){this.loginView=new BlackCat.LoginView();this.views[type]=this.loginView;}this.loginView.start();break;case"WalletView":console.log("[BlaCat]",'[ViewMgr]','显示绑定&导入钱包('+type+') ...');if(!this.walletView){this.walletView=new BlackCat.WalletView();this.views[type]=this.walletView;}this.walletView.start();break;case"WalletCreateView":console.log("[BlaCat]",'[ViewMgr]','显示新建钱包('+type+') ...');if(!this.walletCreateView){this.walletCreateView=new BlackCat.WalletCreateView();this.views[type]=this.walletCreateView;}this.walletCreateView.start();break;case"WalletImportView":console.log("[BlaCat]",'[ViewMgr]','显示导入钱包('+type+') ...');if(!this.walletImportView){this.walletImportView=new BlackCat.WalletImportView();this.views[type]=this.walletImportView;}this.walletImportView.start();break;case"PayView":console.log("[BlaCat]",'[ViewMgr]','显示钱包页('+type+') ...');if(!this.payView){this.payView=new BlackCat.PayView();this.views[type]=this.payView;}this.payView.start();break;case"PayListDetailView":console.log("[BlaCat]",'[ViewMgr]','显示交易详情('+type+') ...');if(!this.payListDetailView){this.payListDetailView=new BlackCat.PayListDetailView();this.views[type]=this.payListDetailView;}this.payListDetailView.start();break;case"PayListMoreView":console.log("[BlaCat]",'[ViewMgr]','显示更多记录('+type+') ...');if(!this.payListMoreView){this.payListMoreView=new BlackCat.PayListMoreView();this.views[type]=this.payListMoreView;}this.payListMoreView.start();break;case"MyInfoView":console.log("[BlaCat]",'[ViewMgr]','显示我的信息('+type+') ...');if(!this.myInfoView){this.myInfoView=new BlackCat.MyInfoView();this.views[type]=this.myInfoView;}this.myInfoView.start();break;case"PayWalletDetailView":console.log("[BlaCat]",'[ViewMgr]','显示钱包详情('+type+') ...');if(!this.payWalletDetailView){this.payWalletDetailView=new BlackCat.PayWalletDetailView();this.views[type]=this.payWalletDetailView;}this.payWalletDetailView.start();break;case"PayExchangeView":console.log("[BlaCat]",'[ViewMgr]','显示交易所('+type+') ...');if(!this.payExchangeView){this.payExchangeView=new BlackCat.PayExchangeView();this.views[type]=this.payExchangeView;}this.payExchangeView.start();break;case"PayExchangeDetailView":console.log("[BlaCat]",'[ViewMgr]','显示交易所购买详情('+type+') ...');if(!this.payExchangeDetailView){this.payExchangeDetailView=new BlackCat.PayExchangeDetailView();this.views[type]=this.payExchangeDetailView;}this.payExchangeDetailView.start();break;case"PayReceivablesView":console.log("[BlaCat]",'[ViewMgr]','显示收款('+type+') ...');if(!this.payReceivablesView){this.payReceivablesView=new BlackCat.PayReceivablesView();this.views[type]=this.payReceivablesView;}this.payReceivablesView.start();break;case"PayTransferView":console.log("[BlaCat]",'[ViewMgr]','显示转账('+type+') ...');if(!this.payTransferView){this.payTransferView=new BlackCat.PayTransferView();this.views[type]=this.payTransferView;}this.payTransferView.start();break;case"ViewAlert":console.log("[BlaCat]",'[ViewMgr]','显示提示('+type+') ...');if(!this.viewAlert){this.viewAlert=new BlackCat.ViewAlert();this.views[type]=this.viewAlert;}this.viewAlert.start();break;case"ViewConfirm":console.log("[BlaCat]",'[ViewMgr]','显示确认('+type+') ...');if(!this.viewConfirm){this.viewConfirm=new BlackCat.ViewConfirm();this.views[type]=this.viewConfirm;}this.viewConfirm.start();break;case"ViewToast":console.log("[BlaCat]",'[ViewMgr]','显示Toast('+type+') ...');if(!this.viewToast){this.viewToast=new BlackCat.ViewToast();}this.viewToast.start();break;case"ViewLoading":console.log("[BlaCat]",'[ViewMgr]','显示Loading('+type+') ...');if(!this.viewLoading){this.viewLoading=new BlackCat.ViewLoading();this.views[type]=this.viewLoading;}this.viewLoading.start();break;case"ViewTransConfirmGas":console.log("[BlaCat]",'[ViewMgr]','显示Gas转账确认('+type+') ...');if(!this.viewTransConfirmGas){this.viewTransConfirmGas=new BlackCat.ViewTransConfirmGas();this.views[type]=this.viewTransConfirmGas;}this.viewTransConfirmGas.start();break;case"RegisterView":console.log("[BlaCat]",'[ViewMgr]','注册('+type+') ...');if(!this.registerView){this.registerView=new BlackCat.RegisterView();this.views[type]=this.registerView;}this.registerView.start();break;case"ForgetPasswordView":console.log("[BlaCat]",'[ViewMgr]','忘记密码('+type+') ...');if(!this.forgetPasswordView){this.forgetPasswordView=new BlackCat.ForgetPasswordView();this.views[type]=this.forgetPasswordView;}this.forgetPasswordView.start();break;case"ModifyImgView":console.log("[BlaCat]",'[ViewMgr]','显示修改头像('+type+') ...');if(!this.modifyImgView){this.modifyImgView=new BlackCat.ModifyImgView();this.views[type]=this.modifyImgView;}this.modifyImgView.start();break;case"ModifyNameView":console.log("[BlaCat]",'[ViewMgr]','显示修改昵称('+type+') ...');if(!this.modifyNameView){this.modifyNameView=new BlackCat.ModifyNameView();this.views[type]=this.modifyNameView;}this.modifyNameView.start();break;case"ModifySexView":console.log("[BlaCat]",'[ViewMgr]','显示修改性别('+type+') ...');if(!this.modifySexView){this.modifySexView=new BlackCat.ModifySexView();this.views[type]=this.modifySexView;}this.modifySexView.start();break;case"ModifyAreaView":console.log("[BlaCat]",'[ViewMgr]','显示修改地区('+type+') ...');if(!this.modifyAreaView){this.modifyAreaView=new BlackCat.ModifyAreaView();this.views[type]=this.modifyAreaView;}this.modifyAreaView.start();break;case"ModifyNetworkLineView":console.log("[BlaCat]",'[ViewMgr]','显示修改网络线路('+type+') ...');if(!this.modifyNetworkLineView){this.modifyNetworkLineView=new BlackCat.ModifyNetworkLineView();this.views[type]=this.modifyNetworkLineView;}this.modifyNetworkLineView.start();break;case"SecurityCenterView":console.log("[BlaCat]",'[ViewMgr]','显示安全中心('+type+') ...');if(!this.securityCenterView){this.securityCenterView=new BlackCat.SecurityCenterView();this.views[type]=this.securityCenterView;}this.securityCenterView.start();break;case"TrustContractView":console.log("[BlaCat]",'[ViewMgr]','显示信任合约('+type+') ...');if(!this.trustContractView){this.trustContractView=new BlackCat.TrustContractView();this.views[type]=this.trustContractView;}this.trustContractView.start();break;case"AutoLogoutWalletView":console.log("[BlaCat]",'[ViewMgr]','显示自动登出钱包('+type+') ...');if(!this.autoLogoutWalletView){this.autoLogoutWalletView=new BlackCat.AutoLogoutWalletView();this.views[type]=this.autoLogoutWalletView;}this.autoLogoutWalletView.start();break;case"AddressbookView":console.log("[BlaCat]",'[ViewMgr]','显示通讯录('+type+') ...');if(!this.addressbookView){this.addressbookView=new BlackCat.AddressbookView();this.views[type]=this.addressbookView;}this.addressbookView.start();break;case"AddressbookDetailsView":console.log("[BlaCat]",'[ViewMgr]','显示通讯录详情('+type+') ...');if(!this.addressbookDetailsView){this.addressbookDetailsView=new BlackCat.AddressbookDetailsView();this.views[type]=this.addressbookDetailsView;}this.addressbookDetailsView.start();break;case"AddressbookOpView":console.log("[BlaCat]",'[ViewMgr]','显示通讯录操作联系人信息('+type+') ...');if(!this.addressbookOpView){this.addressbookOpView=new BlackCat.AddressbookOpView();this.views[type]=this.addressbookOpView;}this.addressbookOpView.start();break;case"ViewConnecting":console.log("[BlaCat]",'[ViewMgr]','显示连接中('+type+') ...');if(!this.viewConnecting){this.viewConnecting=new BlackCat.ViewConnecting();this.views[type]=this.viewConnecting;}this.viewConnecting.start();break;}}},{key:'removeAll',value:function removeAll(){for(var className in this.views){var v=this.views[className];console.log("[BlaCat]",'[ViewMgr]','removeAll, view => ',v);switch(className){case"IconView":v.reset();break;default:if(v.isCreated){v.remove();}break;}}}},{key:'update',value:function update(){console.log("[BlaCat]",'[ViewMgr]','update ...');for(var className in this.views){var v=this.views[className];console.log("[BlaCat]",'[ViewMgr]','update, v =>',v);switch(className){case"PayView":if(v.isCreated){v.update();}break;default:if(v.isCreated&&!v.isHidden()){v.update();}break;}}}},{key:'updateBalance',value:function updateBalance(){console.log("[BlaCat]",'[ViewMgr]','updateBalance ...');for(var className in this.views){var v=this.views[className];if(v.__proto__["updateBalance"]){v.updateBalance();}}}}]);return ViewMgr;}();BlackCat.ViewMgr=ViewMgr;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ViewToast=function(_BlackCat$ViewBase31){_inherits(ViewToast,_BlackCat$ViewBase31);function ViewToast(){_classCallCheck(this,ViewToast);return _possibleConstructorReturn(this,(ViewToast.__proto__||Object.getPrototypeOf(ViewToast)).apply(this,arguments));}_createClass(ViewToast,[{key:'create',value:function create(){this.div=this.objCreate("div");this.div.classList.add("pc_alter","pc_toast");var toast=this.objCreate("div");toast.classList.add("pc_alterbox");this.ObjAppend(this.div,toast);var alterText=this.objCreate("div");alterText.classList.add("pc_altertext");var lang_content=BlackCat.Main.langMgr.get(ViewToast.content);if(!lang_content){lang_content=ViewToast.content;}alterText.textContent=lang_content;this.ObjAppend(toast,alterText);}},{key:'show',value:function show(){_get(ViewToast.prototype.__proto__||Object.getPrototypeOf(ViewToast.prototype),'show',this).call(this);this.remove(ViewToast.showTime,null);}}]);return ViewToast;}(BlackCat.ViewBase);ViewToast.showTime=2500;BlackCat.ViewToast=ViewToast;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ViewTransConfirm=function(_BlackCat$ViewBase32){_inherits(ViewTransConfirm,_BlackCat$ViewBase32);function ViewTransConfirm(){_classCallCheck(this,ViewTransConfirm);var _this121=_possibleConstructorReturn(this,(ViewTransConfirm.__proto__||Object.getPrototypeOf(ViewTransConfirm)).call(this));if(!ViewTransConfirm.list){ViewTransConfirm.list=new BlackCat.walletLists();}return _this121;}_createClass(ViewTransConfirm,[{key:'start',value:function start(){if(this.isCreated){this.remove();}_get(ViewTransConfirm.prototype.__proto__||Object.getPrototypeOf(ViewTransConfirm.prototype),'start',this).call(this);if(this.div.clientHeight<667){this.divConfirmSelect.style.top="auto";this.divConfirmSelect.style.bottom="0";}this.trust="0";}},{key:'create',value:function create(){var _this122=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_listdetail","pc_tradeconfirm","pc_trust");if(ViewTransConfirm.list&&ViewTransConfirm.list.hasOwnProperty("wallet")){var headerTitle=this.objCreate("div");headerTitle.classList.add("pc_header");var returnBtn=this.objCreate("a");returnBtn.classList.add("iconfont","icon-fanhui");returnBtn.textContent=BlackCat.Main.langMgr.get("return");returnBtn.onclick=function(){_this122.return();if(ViewTransConfirm.callback_cancel){ViewTransConfirm.callback_cancel();ViewTransConfirm.callback_cancel=null;}};this.ObjAppend(headerTitle,returnBtn);var h1Obj=this.objCreate("h1");h1Obj.textContent=BlackCat.Main.platName;this.ObjAppend(headerTitle,h1Obj);this.ObjAppend(this.div,headerTitle);var contentObj=this.objCreate("div");contentObj.classList.add("pc_detail");contentObj.style.paddingBottom="120px";contentObj.innerHTML='<ul>'+'<li>'+'<div class="pc_listimg">'+'<img src="'+BlackCat.Main.viewMgr.payView.getListImg(ViewTransConfirm.list)+'">'+'</div>'+'<div class="pc_liftinfo">'+'<div class="pc_listname">'+BlackCat.Main.viewMgr.payView.getListName(ViewTransConfirm.list)+'</div>'+'<span class="pc_listdate">'+BlackCat.Main.viewMgr.payView.getListCtm(ViewTransConfirm.list)+'</span>'+'</div>'+'<div class="pc_cnts '+BlackCat.Main.viewMgr.payView.getListCntsClass(ViewTransConfirm.list)+' ">'+this.getCnts()+'</div>'+'</li>'+'<li><label>'+BlackCat.Main.langMgr.get("paylist_wallet")+'</label><p>'+this.getWallet()+'</p></li>'+this.getParams()+'</ul>';this.ObjAppend(this.div,contentObj);this.divConfirmSelect=this.objCreate("div");this.divConfirmSelect.classList.add("pc_tradeconfirmbut");this.ObjAppend(this.div,this.divConfirmSelect);this.divTrust=this.objCreate("div");this.divTrust.classList.add("pc_switchbox");this.divTrust.textContent=BlackCat.Main.langMgr.get("pay_trust_tips");this.ObjAppend(this.divConfirmSelect,this.divTrust);var labelTrust=this.objCreate("label");labelTrust.textContent=BlackCat.Main.langMgr.get("pay_trust_Vice_tips");this.ObjAppend(this.divTrust,labelTrust);var trustObj=this.objCreate("a");trustObj.classList.add("pc_switch");trustObj.onclick=function(){if(_this122.trust=="0"){_this122.trust="1";trustObj.classList.add("pc_switch_active");}else{_this122.trust="0";trustObj.classList.remove("pc_switch_active");}};this.ObjAppend(this.divTrust,trustObj);var spanSwitchBut=this.objCreate("span");this.ObjAppend(trustObj,spanSwitchBut);var cancelObj=this.objCreate("button");cancelObj.classList.add("pc_cancel");cancelObj.textContent=BlackCat.Main.langMgr.get("cancel");cancelObj.onclick=function(){console.log("[BlaCat]",'[ViewTransConfirm]','交易取消..');if(ViewTransConfirm.callback_cancel){ViewTransConfirm.callback_cancel(ViewTransConfirm.callback_params);ViewTransConfirm.callback_cancel=null;}_this122.remove();};this.ObjAppend(this.divConfirmSelect,cancelObj);var confirmObj=this.objCreate("button");if(ViewTransConfirm.list.type=="3"){confirmObj.textContent=BlackCat.Main.langMgr.get("pay_makeRecharge");}else{confirmObj.textContent=BlackCat.Main.langMgr.get("ok");}confirmObj.onclick=function(){console.log("[BlaCat]",'[ViewTransConfirm]','交易确认..');ViewTransConfirm.callback(ViewTransConfirm.callback_params,_this122.trust);ViewTransConfirm.callback=null;_this122.remove(300);};this.ObjAppend(this.divConfirmSelect,confirmObj);}}},{key:'toRefer',value:function toRefer(){if(ViewTransConfirm.refer){BlackCat.Main.viewMgr.change(ViewTransConfirm.refer);ViewTransConfirm.refer=null;}}},{key:'getCnts',value:function getCnts(){return ViewTransConfirm.list.cnts!='0'?ViewTransConfirm.list.cnts:"";}},{key:'getWallet',value:function getWallet(){return ViewTransConfirm.list.wallet;}},{key:'getParams',value:function getParams(){var html="";var params=ViewTransConfirm.list.params;console.log("[BlaCat]",'[ViewTransConfirm]','getParams, params => ',params);if(params){try{params=JSON.parse(params);if(params.hasOwnProperty("nnc")){params=[params];}if(params instanceof Array){for(var k in params){html+='<li class="pc_contractAddress">'+'<div><label>'+BlackCat.Main.langMgr.get("paylist_nnc")+'</label><p>'+params[k].nnc+'</p></div>'+'<div><label>'+BlackCat.Main.langMgr.get("paylist_sbParamJson")+'</label><p>'+params[k].sbParamJson+'</p></div>'+'<div><label>'+BlackCat.Main.langMgr.get("paylist_sbPushString")+'</label><p>'+params[k].sbPushString+'</p></div>'+'</li>';}}}catch(e){console.log("[BlaCat]",'[ViewTransConfirm]','getParams error => ',e.toString());}}return html;}}]);return ViewTransConfirm;}(BlackCat.ViewBase);BlackCat.ViewTransConfirm=ViewTransConfirm;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ViewTransConfirmGas=function(_BlackCat$ViewBase33){_inherits(ViewTransConfirmGas,_BlackCat$ViewBase33);function ViewTransConfirmGas(){_classCallCheck(this,ViewTransConfirmGas);var _this123=_possibleConstructorReturn(this,(ViewTransConfirmGas.__proto__||Object.getPrototypeOf(ViewTransConfirmGas)).call(this));if(!ViewTransConfirmGas.list){ViewTransConfirmGas.list=new BlackCat.walletLists();}return _this123;}_createClass(ViewTransConfirmGas,[{key:'start',value:function start(){if(this.isCreated){this.remove();}_get(ViewTransConfirmGas.prototype.__proto__||Object.getPrototypeOf(ViewTransConfirmGas.prototype),'start',this).call(this);if(this.div.clientHeight<667){this.divConfirmSelect.style.top="auto";this.divConfirmSelect.style.bottom="0";}}},{key:'create',value:function create(){var _this124=this;this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_listdetail","pc_tradeconfirm");if(ViewTransConfirmGas.list&&ViewTransConfirmGas.list.hasOwnProperty("wallet")){var headerTitle=this.objCreate("div");headerTitle.classList.add("pc_header");var returnBtn=this.objCreate("a");returnBtn.classList.add("iconfont","icon-fanhui");returnBtn.textContent=BlackCat.Main.langMgr.get("return");returnBtn.onclick=function(){_this124.return();if(ViewTransConfirmGas.callback_cancel){ViewTransConfirmGas.callback_cancel();ViewTransConfirmGas.callback_cancel=null;}};this.ObjAppend(headerTitle,returnBtn);var h1Obj=this.objCreate("h1");h1Obj.textContent=BlackCat.Main.platName;this.ObjAppend(headerTitle,h1Obj);this.ObjAppend(this.div,headerTitle);var contentObj=this.objCreate("div");contentObj.classList.add("pc_detail");contentObj.style.paddingBottom="90px";contentObj.innerHTML='<ul>'+'<li>'+'<div class="pc_listimg">'+'<img src="'+BlackCat.Main.viewMgr.payView.getListImg(ViewTransConfirmGas.list)+'">'+'</div>'+'<div class="pc_liftinfo">'+'<div class="pc_listname">'+BlackCat.Main.viewMgr.payView.getListName(ViewTransConfirmGas.list)+'</div>'+'<span class="pc_listdate">'+BlackCat.Main.viewMgr.payView.getListCtm(ViewTransConfirmGas.list)+'</span>'+'</div>'+'<div class="pc_cnts '+BlackCat.Main.viewMgr.payView.getListCntsClass(ViewTransConfirmGas.list)+' ">'+this.getCnts()+'</div>'+'</li>'+'<li><label>'+BlackCat.Main.langMgr.get("paylist_wallet")+'</label><p>'+this.getWallet()+'</p></li>'+this.getParams()+'</ul>';this.ObjAppend(this.div,contentObj);this.divConfirmSelect=this.objCreate("div");this.divConfirmSelect.classList.add("pc_tradeconfirmbut");this.ObjAppend(this.div,this.divConfirmSelect);var cancelObj=this.objCreate("button");cancelObj.classList.add("pc_cancel");cancelObj.textContent=BlackCat.Main.langMgr.get("cancel");cancelObj.onclick=function(){console.log("[BlaCat]",'[ViewTransConfirmGas]','PayTransfer交易取消..');if(ViewTransConfirmGas.callback_cancel){ViewTransConfirmGas.callback_cancel(ViewTransConfirmGas.callback_params);ViewTransConfirmGas.callback_cancel=null;}_this124.remove();};this.ObjAppend(this.divConfirmSelect,cancelObj);var confirmObj=this.objCreate("button");if(ViewTransConfirmGas.list.type=="3"){confirmObj.textContent=BlackCat.Main.langMgr.get("pay_makeRecharge");}else{confirmObj.textContent=BlackCat.Main.langMgr.get("ok");}confirmObj.onclick=function(){console.log("[BlaCat]",'[ViewTransConfirmGas]','PayTransfer交易确认..');ViewTransConfirmGas.callback(ViewTransConfirmGas.callback_params);ViewTransConfirmGas.callback=null;_this124.remove(300);};this.ObjAppend(this.divConfirmSelect,confirmObj);}}},{key:'toRefer',value:function toRefer(){if(ViewTransConfirmGas.refer){BlackCat.Main.viewMgr.change(ViewTransConfirmGas.refer);ViewTransConfirmGas.refer=null;}}},{key:'getCnts',value:function getCnts(){return ViewTransConfirmGas.list.cnts!='0'?ViewTransConfirmGas.list.cnts:"";}},{key:'getWallet',value:function getWallet(){return ViewTransConfirmGas.list.wallet;}},{key:'getParams',value:function getParams(){var html="";var params=ViewTransConfirmGas.list.params;console.log("[BlaCat]",'[ViewTransConfirmGas]','getParams, params => ',params);if(params){try{params=JSON.parse(params);if(params.hasOwnProperty("toaddr")){params=[params];}if(params instanceof Array){for(var k in params){html+='<li class="pc_contractAddress">'+'<div><label>'+BlackCat.Main.langMgr.get("pay_transferGas_toaddr")+'</label><p>'+params[k].toaddr+'</p></div>'+'<div><label>'+BlackCat.Main.langMgr.get("pay_transferGas_count")+'</label><p>'+params[k].count+'</p></div>'+'</li>';}}}catch(e){console.log("[BlaCat]",'[ViewTransConfirmGas]','getParams error => ',e.toString());}}return html;}}]);return ViewTransConfirmGas;}(BlackCat.ViewBase);BlackCat.ViewTransConfirmGas=ViewTransConfirmGas;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ViewTransCount=function(_BlackCat$ViewBase34){_inherits(ViewTransCount,_BlackCat$ViewBase34);function ViewTransCount(){_classCallCheck(this,ViewTransCount);return _possibleConstructorReturn(this,(ViewTransCount.__proto__||Object.getPrototypeOf(ViewTransCount)).apply(this,arguments));}_createClass(ViewTransCount,[{key:'start',value:function start(){_get(ViewTransCount.prototype.__proto__||Object.getPrototypeOf(ViewTransCount.prototype),'start',this).call(this);if(ViewTransCount.transTypename1=="SGASOLD2OLD"){this.inputCount.focus();}}},{key:'create',value:function create(){var _this126=this;this.div=this.objCreate("div");this.div.classList.add("pc_popup");var popupbox=this.objCreate('div');popupbox.classList.add("pc_popupbox");this.ObjAppend(this.div,popupbox);var popupTitle=this.objCreate('div');popupTitle.classList.add("pc_popup_title");popupTitle.innerText=BlackCat.Main.langMgr.get("pay_transCount_count");this.ObjAppend(popupbox,popupTitle);var divtransfertype=this.objCreate("div");divtransfertype.classList.add("pc_transfertype","pc_token");this.ObjAppend(popupbox,divtransfertype);if(ViewTransCount.transTypename1=="SGASOLD2OLD"){this.divtransfername=this.objCreate("div");this.ObjAppend(divtransfertype,this.divtransfername);this.labeltransfername1=this.objCreate("label");this.labeltransfername1.textContent=BlackCat.Main.langMgr.get("pay_transCount"+ViewTransCount.transTypename1);this.ObjAppend(this.divtransfername,this.labeltransfername1);var itransfertype=this.objCreate("i");itransfertype.classList.add("iconfont","icon-jiantou2");this.ObjAppend(this.divtransfername,itransfertype);this.labeltransfername2=this.objCreate("label");this.labeltransfername2.textContent=BlackCat.Main.langMgr.get("pay_transCount"+ViewTransCount.transTypename2);this.ObjAppend(this.divtransfername,this.labeltransfername2);}else{this.selectTransfertype=this.objCreate("select");this.selectTransfertype.onchange=function(){_this126.dotransfertype();};this.ObjAppend(divtransfertype,this.selectTransfertype);var optionTips=this.objCreate("option");optionTips.innerHTML=BlackCat.Main.langMgr.get("pay_transCount_tips");optionTips.selected=true;optionTips.disabled=true;optionTips.style.display="none";this.ObjAppend(this.selectTransfertype,optionTips);var optionSgas=this.objCreate("option");optionSgas.value=BlackCat.Main.langMgr.get("pay_transCountGAS2SGAS");optionSgas.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+BlackCat.Main.langMgr.get("pay_transCountGAS2SGAS");this.ObjAppend(this.selectTransfertype,optionSgas);var optionGas=this.objCreate("option");optionGas.value=BlackCat.Main.langMgr.get("pay_transCountSGAS2GAS");optionGas.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+BlackCat.Main.langMgr.get("pay_transCountSGAS2GAS");this.ObjAppend(this.selectTransfertype,optionGas);}this.inputCount=this.objCreate("input");this.inputCount.type="text";this.inputCount.style.margin="0 auto 10px";this.inputCount.style.width="80%";this.inputCount.placeholder=BlackCat.Main.langMgr.get("pay_transCount_inputCount");this.inputCount.onkeyup=function(){_this126.doinputchange();};this.ObjAppend(popupbox,this.inputCount);this.divHaveAmounts=this.objCreate("div");this.divHaveAmounts.classList.add("pc_haveamounts");this.ObjAppend(popupbox,this.divHaveAmounts);this.divHaveSGasAmounts=this.objCreate("div");if(ViewTransCount.transTypename1=="SGASOLD2OLD"){this.divHaveSGasAmounts.textContent="SGAS(old)："+ViewTransCount.transBalances;}else{this.divHaveSGasAmounts.textContent="SGAS："+BlackCat.Main.getStringNumber(BlackCat.Main.viewMgr.payView.sgas);}this.ObjAppend(this.divHaveAmounts,this.divHaveSGasAmounts);this.spanHaveSGasAmounts=this.objCreate("span");this.ObjAppend(this.divHaveSGasAmounts,this.spanHaveSGasAmounts);this.divHaveGasAmounts=this.objCreate("div");this.divHaveGasAmounts.textContent="GAS："+BlackCat.Main.getStringNumber(BlackCat.Main.viewMgr.payView.gas);this.ObjAppend(this.divHaveAmounts,this.divHaveGasAmounts);this.spanHaveGasAmounts=this.objCreate("span");this.ObjAppend(this.divHaveGasAmounts,this.spanHaveGasAmounts);if(this.showNetFee()){this.netFeeCom=new BlackCat.NetFeeComponent(popupbox,function(net_fee){_this126.netFeeChange(net_fee);});this.netFeeCom.setFeeDefault();this.netFeeCom.createDiv();}else{this.net_fee="0";}var popupbutbox=this.objCreate('div');popupbutbox.classList.add("pc_popupbutbox");this.ObjAppend(popupbox,popupbutbox);var popupClose=this.objCreate('button');popupClose.classList.add("pc_cancel");popupClose.textContent=BlackCat.Main.langMgr.get("cancel");popupClose.onclick=function(){_this126.remove(300);};this.ObjAppend(popupbutbox,popupClose);var confirmObj=this.objCreate("button");confirmObj.textContent=BlackCat.Main.langMgr.get("ok");confirmObj.onclick=function(){_this126.doConfirm();};this.ObjAppend(popupbutbox,confirmObj);}},{key:'toRefer',value:function toRefer(){if(ViewTransCount.refer){BlackCat.Main.viewMgr.change(ViewTransCount.refer);ViewTransCount.refer=null;}}},{key:'dotransfertype',value:function dotransfertype(){if(this.selectTransfertype.value=="GAS"){this.divHaveGasAmounts.classList.remove("pc_income","pc_expenditure");this.divHaveSGasAmounts.classList.remove("pc_income","pc_expenditure");this.inputCount.value="";ViewTransCount.transTypename1="SGAS2GAS";if(this.showNetFeeSGAS2GAS()===false){this.netFeeCom.hidden();}}else if(this.selectTransfertype.value=="SGAS"){this.divHaveGasAmounts.classList.remove("pc_income","pc_expenditure");this.divHaveSGasAmounts.classList.remove("pc_income","pc_expenditure");this.inputCount.value="";ViewTransCount.transTypename1="GAS2SGAS";this.netFeeCom.show();}this.spanHaveSGasAmounts.textContent=this.spanHaveGasAmounts.textContent="";this.inputCount.focus();}},{key:'doinputchange',value:function doinputchange(){if(!BlackCat.Main.viewMgr.payView.checkTransCount(this.inputCount.value)){this.divHaveGasAmounts.classList.remove("pc_income","pc_expenditure");this.divHaveSGasAmounts.classList.remove("pc_income","pc_expenditure");this.spanHaveSGasAmounts.textContent=this.spanHaveGasAmounts.textContent="";return;}if(ViewTransCount.transTypename1=="SGAS2GAS"||ViewTransCount.transTypename1=="SGASOLD2OLD"){this.divHaveGasAmounts.classList.add("pc_income");this.divHaveSGasAmounts.classList.add("pc_expenditure");this.spanHaveSGasAmounts.textContent=this.inputCount.value;this.spanHaveGasAmounts.textContent=BlackCat.Main.getStringNumber(BlackCat.floatNum.minus(Number(this.inputCount.value),Number(this.net_fee)));}else if(ViewTransCount.transTypename1=="GAS2SGAS"){this.divHaveGasAmounts.classList.add("pc_expenditure");this.divHaveSGasAmounts.classList.add("pc_income");this.spanHaveSGasAmounts.textContent=this.inputCount.value;this.spanHaveGasAmounts.textContent=BlackCat.Main.getStringNumber(BlackCat.floatNum.plus(Number(this.inputCount.value),Number(this.net_fee)));}}},{key:'doConfirm',value:function doConfirm(){var _this127=this;if(ViewTransCount.transTypename1!="SGASOLD2OLD"){if(this.selectTransfertype.value!="GAS"&&this.selectTransfertype.value!="SGAS"){BlackCat.Main.showErrMsg('pay_transCount_tips_err',function(){_this127.inputCount.focus();});return;}}if(!this.inputCount.value){this.inputCount.focus();return;}if(!BlackCat.Main.viewMgr.payView.checkTransCount(this.inputCount.value)){BlackCat.Main.showErrMsg('pay_transCount_err',function(){_this127.inputCount.focus();});return;}switch(ViewTransCount.transTypename1){case'SGAS2GAS':if(BlackCat.Main.viewMgr.payView.sgas<Number(this.inputCount.value)){BlackCat.Main.showErrMsg('pay_makeRefundSgasNotEnough',function(){_this127.inputCount.focus();});return;}if(Number(this.net_fee)>0){if(BlackCat.Main.viewMgr.payView.gas<Number(this.net_fee)){BlackCat.Main.showErrMsg("pay_makeRefundGasFeeNotEnough",function(){_this127.inputCount.focus();});}return;}break;case'GAS2SGAS':if(BlackCat.Main.viewMgr.payView.gas<Number(this.inputCount.value)+Number(this.net_fee)){BlackCat.Main.showErrMsg('pay_makeMintGasNotEnough',function(){_this127.inputCount.focus();});return;}break;case'SGASOLD2OLD':if(Number(ViewTransCount.transBalances)<Number(this.inputCount.value)){BlackCat.Main.showErrMsg('pay_makeRefundSgasOldNotEnough',function(){_this127.inputCount.focus();});return;}if(Number(this.net_fee)>0){if(BlackCat.Main.viewMgr.payView.gas<Number(this.net_fee)){BlackCat.Main.showErrMsg("pay_makeRefundGasFeeNotEnough",function(){_this127.inputCount.focus();});}return;}break;}this.remove(300);ViewTransCount.callback();ViewTransCount.callback=null;}},{key:'showNetFee',value:function showNetFee(){if(ViewTransCount.transTypename1=="SGASOLD2OLD"){if(BlackCat.tools.CoinTool.id_SGAS_OLD[0]=="0x961e628cc93d61bf636dc0443cf0548947a50dbe"){return false;}}return true;}},{key:'showNetFeeSGAS2GAS',value:function showNetFeeSGAS2GAS(){if(BlackCat.tools.CoinTool.id_SGAS=="0x961e628cc93d61bf636dc0443cf0548947a50dbe"){return false;}return true;}},{key:'netFeeChange',value:function netFeeChange(net_fee){this.net_fee=net_fee;var v=this.inputCount.value;if(v.length==0||v.replace(/(^s*)|(s*$)/g,"").length==0){return;}if(ViewTransCount.transTypename1=="SGAS2GAS"||ViewTransCount.transTypename1=="SGASOLD2OLD"){this.spanHaveGasAmounts.textContent=BlackCat.Main.getStringNumber(BlackCat.floatNum.minus(Number(v),Number(this.net_fee)));}else{this.spanHaveGasAmounts.textContent=BlackCat.Main.getStringNumber(BlackCat.floatNum.plus(Number(v),Number(this.net_fee)));}}},{key:'updateBalance',value:function updateBalance(){this.divHaveGasAmounts.textContent="GAS："+BlackCat.Main.getStringNumber(BlackCat.Main.viewMgr.payView.gas);if(ViewTransCount.transTypename1=="SGASOLD2OLD"){this.divHaveSGasAmounts.textContent="SGAS(old)："+ViewTransCount.transBalances;}else{this.divHaveSGasAmounts.textContent="SGAS："+BlackCat.Main.getStringNumber(BlackCat.Main.viewMgr.payView.sgas);}}}]);return ViewTransCount;}(BlackCat.ViewBase);BlackCat.ViewTransCount=ViewTransCount;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ViewWalletOpen=function(_BlackCat$ViewBase35){_inherits(ViewWalletOpen,_BlackCat$ViewBase35);function ViewWalletOpen(){_classCallCheck(this,ViewWalletOpen);return _possibleConstructorReturn(this,(ViewWalletOpen.__proto__||Object.getPrototypeOf(ViewWalletOpen)).apply(this,arguments));}_createClass(ViewWalletOpen,[{key:'start',value:function start(){_get(ViewWalletOpen.prototype.__proto__||Object.getPrototypeOf(ViewWalletOpen.prototype),'start',this).call(this);this.inputPassword.focus();}},{key:'create',value:function create(){var _this129=this;this.doReadWalletFile();this.div=this.objCreate("div");this.div.classList.add("pc_popup");var popupbox=this.objCreate('div');popupbox.classList.add("pc_popupbox");this.ObjAppend(this.div,popupbox);var popupTitle=this.objCreate('div');popupTitle.classList.add("pc_popup_title");popupTitle.innerText=BlackCat.Main.langMgr.get("pay_walletOpen_password");this.ObjAppend(popupbox,popupTitle);this.inputPassword=this.objCreate("input");this.inputPassword.type="password";this.inputPassword.style.marginTop="40px";this.inputPassword.style.width="60%";this.inputPassword.placeholder=BlackCat.Main.langMgr.get("pay_walletOpen_inputPassword");this.ObjAppend(popupbox,this.inputPassword);var popupbutbox=this.objCreate('div');popupbutbox.classList.add("pc_popupbutbox");this.ObjAppend(popupbox,popupbutbox);var popupClose=this.objCreate('button');popupClose.classList.add("pc_cancel");popupClose.textContent=BlackCat.Main.langMgr.get("cancel");popupClose.onclick=function(){_this129.remove(300);if(ViewWalletOpen.callback_cancel){if(ViewWalletOpen.callback_callback){ViewWalletOpen.callback_cancel(ViewWalletOpen.callback_params,ViewWalletOpen.callback_callback);}else{ViewWalletOpen.callback_cancel(ViewWalletOpen.callback_params);}}ViewWalletOpen.callback_cancel=null;ViewWalletOpen.callback_params=null;ViewWalletOpen.callback_callback=null;};this.ObjAppend(popupbutbox,popupClose);var confirmObj=this.objCreate("button");confirmObj.textContent=BlackCat.Main.langMgr.get("ok");confirmObj.onclick=function(){_this129.doConfirm();};this.ObjAppend(popupbutbox,confirmObj);}},{key:'toRefer',value:function toRefer(){if(ViewWalletOpen.refer){BlackCat.Main.viewMgr.change(ViewWalletOpen.refer);ViewWalletOpen.refer=null;}}},{key:'doConfirm',value:function doConfirm(){var _this130=this;if(!this.inputPassword.value){BlackCat.Main.showErrMsg('pay_walletOpen_inputPassword_err',function(){_this130.inputPassword.focus();});return;}this.doOpenWallet();}},{key:'doReadWalletFile',value:function doReadWalletFile(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee94(){var readfile;return regeneratorRuntime.wrap(function _callee94$(_context94){while(1){switch(_context94.prev=_context94.next){case 0:_context94.next=2;return BlackCat.Main.wallet.readWalletFile(1);case 2:readfile=_context94.sent;if(readfile){_context94.next=6;break;}BlackCat.Main.showErrMsg("pay_walletOpen_file_error");return _context94.abrupt('return');case 6:case'end':return _context94.stop();}}},_callee94,this);}));}},{key:'doOpenWallet',value:function doOpenWallet(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee95(){var open;return regeneratorRuntime.wrap(function _callee95$(_context95){while(1){switch(_context95.prev=_context95.next){case 0:BlackCat.Main.viewMgr.change("ViewLoading");_context95.next=3;return BlackCat.Main.wallet.open(this.inputPassword.value);case 3:open=_context95.sent;BlackCat.Main.viewMgr.viewLoading.remove();if(open){_context95.next=8;break;}BlackCat.Main.showErrMsg("pay_walletOpen_openFail");return _context95.abrupt('return');case 8:this.remove();if(ViewWalletOpen.callback){if(ViewWalletOpen.callback_callback){ViewWalletOpen.callback(ViewWalletOpen.callback_params,ViewWalletOpen.callback_callback);}else{ViewWalletOpen.callback(ViewWalletOpen.callback_params);}}ViewWalletOpen.callback=null;ViewWalletOpen.callback_params=null;ViewWalletOpen.callback_callback=null;if(ViewWalletOpen.tasks){this.doOpenTasks();}case 14:case'end':return _context95.stop();}}},_callee95,this);}));}},{key:'doOpenTasks',value:function doOpenTasks(){console.log("[BlaCat]",'[ViewWalletOpen]','doOpenTasks, tasks => ',ViewWalletOpen.tasks);for(var k in ViewWalletOpen.tasks){if(ViewWalletOpen.tasks[k]){switch(k){case"getPlatNotifys":for(var i in ViewWalletOpen.tasks[k]){var params=ViewWalletOpen.tasks[k][i];delete BlackCat.Main.platNotifyTxids[params.txid];}BlackCat.Main.needGetPlatNotifys=true;break;}}}}}],[{key:'addTask',value:function addTask(type,params){if(!ViewWalletOpen.tasks){ViewWalletOpen.tasks={};}if(ViewWalletOpen.tasks[type]){for(var k in params){ViewWalletOpen.tasks[type].push(params[k]);}}else{ViewWalletOpen.tasks[type]=params;}console.log("[BlaCat]",'[ViewWalletOpen]','addTask, tasks => ',ViewWalletOpen.tasks);}},{key:'removeTask',value:function removeTask(type){delete ViewWalletOpen.tasks[type];}}]);return ViewWalletOpen;}(BlackCat.ViewBase);BlackCat.ViewWalletOpen=ViewWalletOpen;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var WalletCreateView=function(_BlackCat$ViewBase36){_inherits(WalletCreateView,_BlackCat$ViewBase36);function WalletCreateView(){_classCallCheck(this,WalletCreateView);var _this131=_possibleConstructorReturn(this,(WalletCreateView.__proto__||Object.getPrototypeOf(WalletCreateView)).call(this));_this131.wallet=new ThinNeo.nep6wallet();return _this131;}_createClass(WalletCreateView,[{key:'create',value:function create(){var _this132=this;this.div=this.objCreate('div');this.div.classList.add("pc_popup");var popupbox=this.objCreate('div');popupbox.classList.add("pc_popupbox");this.ObjAppend(this.div,popupbox);var popupTitle=this.objCreate('div');popupTitle.classList.add("pc_popup_title");popupTitle.innerText=BlackCat.Main.langMgr.get("walletCreate_create");this.ObjAppend(popupbox,popupTitle);this.inputPwd=this.objCreate("input");this.inputPwd.type="password";this.inputPwd.placeholder=BlackCat.Main.langMgr.get("walletCreate_password");this.ObjAppend(popupbox,this.inputPwd);this.inputVwd=this.objCreate("input");this.inputVwd.type="password";this.inputVwd.placeholder=BlackCat.Main.langMgr.get("walletCreate_vpass");this.ObjAppend(popupbox,this.inputVwd);var createPrompt=this.objCreate("div");createPrompt.classList.add("pc_prompt");createPrompt.textContent=BlackCat.Main.langMgr.get("walletCreate_password_notice");this.ObjAppend(popupbox,createPrompt);var popupbutbox=this.objCreate('div');popupbutbox.classList.add("pc_popupbutbox");this.ObjAppend(popupbox,popupbutbox);var popupClose=this.objCreate('button');popupClose.classList.add("pc_cancel");popupClose.textContent=BlackCat.Main.langMgr.get("cancel");popupClose.onclick=function(){_this132.remove(300);};this.ObjAppend(popupbutbox,popupClose);var doCreate=this.objCreate("button");doCreate.textContent=BlackCat.Main.langMgr.get("walletCreate_doCreate");doCreate.onclick=function(){_this132.doCreate();};this.ObjAppend(popupbutbox,doCreate);}},{key:'show',value:function show(){_get(WalletCreateView.prototype.__proto__||Object.getPrototypeOf(WalletCreateView.prototype),'show',this).call(this);this.inputPwd.focus();}},{key:'createVerifyPwd',value:function createVerifyPwd(){var pwd=this.inputPwd.value;if(!pwd||pwd.toString().length==0){return false;}return true;}},{key:'createVerifyVwd',value:function createVerifyVwd(){var pwd=this.inputPwd.value;var vwd=this.inputVwd.value;if(!vwd||vwd.toString().length==0||pwd!=vwd){return false;}return true;}},{key:'doCreate',value:function doCreate(){var _this133=this;if(!this.createVerifyPwd()){BlackCat.Main.showErrMsg("walletCreate_check_pass",function(){_this133.inputPwd.focus();});return;}if(!this.createVerifyVwd()){BlackCat.Main.showErrMsg("walletCreate_check_vpass",function(){_this133.inputVwd.focus();});return;}if(this.inputPwd.value.length>32){BlackCat.Main.showErrMsg("walletCreate_check_exceed",function(){_this133.inputPwd.focus();});return;}BlackCat.Main.viewMgr.change("ViewLoading");setTimeout(function(){var array=new Uint8Array(32);var key=Neo.Cryptography.RandomNumberGenerator.getRandomValues(array);var pubkey=ThinNeo.Helper.GetPublicKeyFromPrivateKey(key);var addr=ThinNeo.Helper.GetAddressFromPublicKey(pubkey);_this133.wallet.scrypt=new ThinNeo.nep6ScryptParameters();_this133.wallet.scrypt.N=16384;_this133.wallet.scrypt.r=8;_this133.wallet.scrypt.p=1;_this133.wallet.accounts=[];_this133.wallet.accounts[0]=new ThinNeo.nep6account();_this133.wallet.accounts[0].address=addr;try{ThinNeo.Helper.GetNep2FromPrivateKey(key,_this133.inputPwd.value,_this133.wallet.scrypt.N,_this133.wallet.scrypt.r,_this133.wallet.scrypt.p,function(info,result){return __awaiter(_this133,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee96(){var pubkey,jsonstr;return regeneratorRuntime.wrap(function _callee96$(_context96){while(1){switch(_context96.prev=_context96.next){case 0:if(!(info=="finish")){_context96.next=8;break;}this.wallet.accounts[0].nep2key=result;this.wallet.accounts[0].contract=new ThinNeo.contract();pubkey=ThinNeo.Helper.GetPublicKeyFromPrivateKey(key);this.wallet.accounts[0].contract.script=ThinNeo.Helper.GetAddressCheckScriptFromPublicKey(pubkey).toHexString();jsonstr=JSON.stringify(this.wallet.toJson());_context96.next=8;return this.doBindWallet();case 8:BlackCat.Main.viewMgr.viewLoading.remove();case 9:case'end':return _context96.stop();}}},_callee96,this);}));});}catch(e){BlackCat.Main.viewMgr.viewLoading.remove();console.log("[BlaCat]",'[WalletCreateView]','doCreate, ThinNeo.Helper.GetNep2FromPrivateKey error => ',e.toString());}},300);}},{key:'doBindWallet',value:function doBindWallet(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee97(){var wallet_bind_res;return regeneratorRuntime.wrap(function _callee97$(_context97){while(1){switch(_context97.prev=_context97.next){case 0:_context97.next=2;return BlackCat.ApiTool.bindWallet(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,JSON.stringify(this.wallet.toJson()));case 2:wallet_bind_res=_context97.sent;if(wallet_bind_res.r){BlackCat.Main.validateLogin();this.remove();BlackCat.Main.viewMgr.walletView.remove();}else{BlackCat.Main.showErrCode(wallet_bind_res.errCode);}case 4:case'end':return _context97.stop();}}},_callee97,this);}));}}]);return WalletCreateView;}(BlackCat.ViewBase);BlackCat.WalletCreateView=WalletCreateView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var tools;(function(tools){var LoginInfo=function(){function LoginInfo(){_classCallCheck(this,LoginInfo);}_createClass(LoginInfo,null,[{key:'ArrayToString',value:function ArrayToString(array){var obj=[];for(var i=0;i<array.length;i++){obj.push({});obj[i].pubkey=array[i].pubkey.toHexString();obj[i].prikey=array[i].prikey.toHexString();obj[i].address=array[i].address;}return JSON.stringify(obj);}},{key:'StringToArray',value:function StringToArray(str){var obj=JSON.parse(str);var arr=[];for(var i=0;i<obj.length;i++){arr.push(new LoginInfo());var str=obj[i].prikey;var str2=obj[i].pubkey;arr[i].prikey=str.hexToBytes();arr[i].pubkey=str2.hexToBytes();arr[i].address=obj[i].address;}return arr;}},{key:'getCurrentLogin',value:function getCurrentLogin(){var address=LoginInfo.getCurrentAddress();var arr=tools.StorageTool.getLoginArr();try{var n=arr.findIndex(function(info){return info.address==address;});}catch(e){var n;for(var i=0;i<arr.length;i++){if(address==arr[i].address){n=i;break;}}}return arr[n];}},{key:'getCurrentAddress',value:function getCurrentAddress(){return tools.StorageTool.getStorage("current-address");}},{key:'setCurrentAddress',value:function setCurrentAddress(str){tools.StorageTool.setStorage("current-address",str);}}]);return LoginInfo;}();tools.LoginInfo=LoginInfo;var BalanceInfo=function(){function BalanceInfo(){_classCallCheck(this,BalanceInfo);}_createClass(BalanceInfo,null,[{key:'jsonToArray',value:function jsonToArray(json){var arr=new Array();for(var i in json){if(json.hasOwnProperty(i)){var element=json[i];var balance=new BalanceInfo();balance.asset=element["asset"];balance.balance=element["balance"];balance.name=element["balance"];balance.names=element["names"];balance.type=element["type"];arr.push(balance);}}return arr;}},{key:'getBalancesByArr',value:function getBalancesByArr(balances,nep5balances,height){var balancearr=[];if(balances){balances.map(function(item){item.names=tools.CoinTool.assetID2name[item.asset];var a=tools.StorageTool.getStorage(item.asset);if(a){var obj=JSON.parse(a);var h=obj["height"];height-h>1?tools.StorageTool.delStorage(item.asset):item.balance=obj["balance"]["balance"];}});balancearr=balances;}if(nep5balances){for(var index=0;index<nep5balances.length;index++){var nep5=nep5balances[index];var nep5b=new BalanceInfo();var id=nep5.assetid.replace("0x","");id=id.substring(0,4)+'...'+id.substring(id.length-4);nep5b.asset=nep5.assetid;nep5b.balance=nep5.balance;nep5b.names=nep5.symbol+"("+id+")";nep5b.type="nep5";balancearr.push(nep5b);}}return balancearr;}},{key:'setBalanceSotre',value:function setBalanceSotre(balance,height){tools.StorageTool.setStorage(balance.asset,JSON.stringify({height:height,balance:balance}));console.log(tools.StorageTool.getStorage(balance.asset));}}]);return BalanceInfo;}();tools.BalanceInfo=BalanceInfo;var Nep5Balance=function Nep5Balance(){_classCallCheck(this,Nep5Balance);};tools.Nep5Balance=Nep5Balance;var Result=function Result(){_classCallCheck(this,Result);};tools.Result=Result;var AssetEnum=void 0;(function(AssetEnum){AssetEnum["NEO"]="0xc56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b";AssetEnum["GAS"]="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";})(AssetEnum=tools.AssetEnum||(tools.AssetEnum={}));var NeoAsset=function NeoAsset(){_classCallCheck(this,NeoAsset);};tools.NeoAsset=NeoAsset;var OldUTXO=function(){function OldUTXO(txid,n){_classCallCheck(this,OldUTXO);this.n=n;this.txid=txid;}_createClass(OldUTXO,[{key:'compareUtxo',value:function compareUtxo(utxo){return this.txid==utxo.txid&&this.n==utxo.n;}}],[{key:'oldutxosPush',value:function oldutxosPush(olds){var arr=this.getOldutxos();tools.StorageTool.setStorage("old-utxos",JSON.stringify(arr.concat(olds)));}},{key:'setOldutxos',value:function setOldutxos(olds){tools.StorageTool.setStorage("old-utxos",JSON.stringify(olds));}},{key:'getOldutxos',value:function getOldutxos(){var arr=new Array();var str=tools.StorageTool.getStorage("old-utxos");if(str)arr=JSON.parse(str);return arr;}}]);return OldUTXO;}();tools.OldUTXO=OldUTXO;var UTXO=function(){function UTXO(){_classCallCheck(this,UTXO);}_createClass(UTXO,null,[{key:'ArrayToString',value:function ArrayToString(utxos){var str="";var obj=[];for(var i=0;i<utxos.length;i++){obj.push({});obj[i].n=utxos[i].n;obj[i].addr=utxos[i].addr;obj[i].txid=utxos[i].txid;obj[i].asset=utxos[i].asset;obj[i].count=utxos[i].count.toString();}return obj;}},{key:'StringToArray',value:function StringToArray(obj){var utxos=new Array();for(var i=0;i<obj.length;i++){utxos.push(new UTXO());var str=obj[i].count;utxos[i].n=obj[i].n;utxos[i].addr=obj[i].addr;utxos[i].txid=obj[i].txid;utxos[i].asset=obj[i].asset;utxos[i].count=Neo.Fixed8.parse(str);}return utxos;}},{key:'setAssets',value:function setAssets(assets){var obj={};for(var asset in assets){var arr=UTXO.ArrayToString(assets[asset]);obj[asset]=arr;}sessionStorage.setItem("current-assets-utxos",JSON.stringify(obj));}},{key:'getAssets',value:function getAssets(){var assets=null;var str=sessionStorage.getItem("current-assets-utxos");if(str!==null&&str!=undefined&&str!=''){assets=JSON.parse(str);for(var asset in assets){assets[asset]=UTXO.StringToArray(assets[asset]);}}return assets;}}]);return UTXO;}();tools.UTXO=UTXO;var Consts=function Consts(){_classCallCheck(this,Consts);};Consts.baseContract="954f285a93eed7b4aed9396a7806a5812f1a5950";Consts.registerContract="d6a5e965f67b0c3e5bec1f04f028edb9cb9e3f7c";tools.Consts=Consts;var DomainInfo=function DomainInfo(){_classCallCheck(this,DomainInfo);};tools.DomainInfo=DomainInfo;var RootDomainInfo=function(_DomainInfo){_inherits(RootDomainInfo,_DomainInfo);function RootDomainInfo(){_classCallCheck(this,RootDomainInfo);return _possibleConstructorReturn(this,(RootDomainInfo.__proto__||Object.getPrototypeOf(RootDomainInfo)).call(this));}return RootDomainInfo;}(DomainInfo);tools.RootDomainInfo=RootDomainInfo;var Transactionforaddr=function Transactionforaddr(){_classCallCheck(this,Transactionforaddr);};tools.Transactionforaddr=Transactionforaddr;var History=function(){function History(){_classCallCheck(this,History);}_createClass(History,null,[{key:'setHistoryStore',value:function setHistoryStore(history,height){var arr=this.getHistoryStore();arr.push({height:height,history:history});tools.StorageTool.setStorage("history-txs",JSON.stringify(arr));}},{key:'getHistoryStore',value:function getHistoryStore(){var str=tools.StorageTool.getStorage("history-txs");var arr=!!str?JSON.parse(str):[];return arr;}},{key:'delHistoryStoreByHeight',value:function delHistoryStoreByHeight(height){var arr=this.getHistoryStore();if(arr.length>0){var newarr=[];arr.map(function(his){var h=parseInt(his.height);if(height-h<2){newarr.push(his);}});tools.StorageTool.setStorage("history-txs",JSON.stringify(newarr));}}}]);return History;}();tools.History=History;var Claim=function(){function Claim(json){_classCallCheck(this,Claim);this.addr=json['addr'];this.asset=json['asset'];this.claimed=json['claimed'];this.createHeight=json['createHeight'];this.n=json['n'];this.txid=json['txid'];this.useHeight=json['useHeight'];this.used=json['used'];this.value=json['value'];}_createClass(Claim,null,[{key:'strToClaimArray',value:function strToClaimArray(arr){var claimarr=new Array();for(var i in arr){if(arr.hasOwnProperty(i)){claimarr.push(new Claim(arr[i]));}}return claimarr;}}]);return Claim;}();tools.Claim=Claim;var Domainmsg=function Domainmsg(){_classCallCheck(this,Domainmsg);};tools.Domainmsg=Domainmsg;var DomainStatus=function(){function DomainStatus(){_classCallCheck(this,DomainStatus);}_createClass(DomainStatus,null,[{key:'setStatus',value:function setStatus(domain){var str=sessionStorage.getItem("domain-status");var arr={};if(str){arr=JSON.parse(str);var msg=arr[domain.domainname];msg?msg:msg=new DomainStatus();domain.await_mapping?msg["await_mapping"]=domain.await_mapping:"";domain.await_register?msg["await_register"]=domain.await_register:"";domain.await_resolver?msg["await_resolver"]=domain.await_resolver:"";domain.mapping?msg["mapping"]=domain.mapping:"";domain.resolver?msg["resolver"]=domain.resolver.replace("0x",""):"";arr[domain.domainname]=msg;}else{arr[domain.domainname]=domain;}sessionStorage.setItem("domain-status",JSON.stringify(arr));}},{key:'getStatus',value:function getStatus(){var str=sessionStorage.getItem("domain-status");var obj={};str?obj=JSON.parse(sessionStorage.getItem("domain-status")):{};return obj;}}]);return DomainStatus;}();tools.DomainStatus=DomainStatus;var WalletOtcgo=function(){function WalletOtcgo(){_classCallCheck(this,WalletOtcgo);}_createClass(WalletOtcgo,[{key:'fromJsonStr',value:function fromJsonStr(str){var json=JSON.parse(str);var otcgo=new WalletOtcgo();this.address=json["address"];this.publicKey=json["publicKey"];this.publicKeyCompressed=json["publicKeyCompressed"];this.privateKeyEncrypted=json["privateKeyEncrypted"];}},{key:'otcgoDecrypt',value:function otcgoDecrypt(pwd){try{this.privatekey=CryptoJS.AES.decrypt(this.privateKeyEncrypted,pwd).toString(CryptoJS.enc.Utf8);this.prikey=this.privatekey.hexToBytes();this.pubkey=ThinNeo.Helper.GetPublicKeyFromPrivateKey(this.prikey);}catch(error){console.log(error);}}},{key:'doSign',value:function doSign(prvkey,msg){var sig=new KJUR.crypto.Signature({'alg':'SHA256withECDSA'});sig.initSign({'ecprvhex':prvkey,'eccurvename':'secp256r1'});sig.updateString(msg);return sig.sign();}},{key:'doVerify',value:function doVerify(pubkey,msg,sigval){var sig=new KJUR.crypto.Signature({'alg':'SHA256withECDSA','prov':'cryptojs/jsrsa'});sig.initVerifyByPublicKey({'ecpubhex':pubkey,'eccurvename':'secp256r1'});sig.updateString(msg);return sig.verify(sigval);}},{key:'doValidatePwd',value:function doValidatePwd(){if(this.prikey.length===0)return false;var msg='aaa';var sigval=this.doSign(this.privatekey,msg);return this.doVerify(this.publicKey,msg,sigval);}}]);return WalletOtcgo;}();tools.WalletOtcgo=WalletOtcgo;var MyAuction=function MyAuction(){_classCallCheck(this,MyAuction);};tools.MyAuction=MyAuction;})(tools=BlackCat.tools||(BlackCat.tools={}));})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var WalletImportView=function(_BlackCat$ViewBase37){_inherits(WalletImportView,_BlackCat$ViewBase37);function WalletImportView(){_classCallCheck(this,WalletImportView);var _this135=_possibleConstructorReturn(this,(WalletImportView.__proto__||Object.getPrototypeOf(WalletImportView)).call(this));_this135.filename="";_this135.reader=new FileReader();_this135.reader.onload=function(){return __awaiter(_this135,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee98(){var res;return regeneratorRuntime.wrap(function _callee98$(_context98){while(1){switch(_context98.prev=_context98.next){case 0:_context98.next=2;return BlackCat.Main.wallet.setWalletStr(this.reader.result);case 2:res=_context98.sent;if(!res){BlackCat.Main.showErrMsg("walletImport_invalid_file");this.filename="";this.inputFileText.placeholder=BlackCat.Main.langMgr.get("walletImport_select_file");}else{this.inputFileText.placeholder=this.filename;}case 4:case'end':return _context98.stop();}}},_callee98,this);}));};_this135.filepass="";return _this135;}_createClass(WalletImportView,[{key:'create',value:function create(){var _this136=this;this.div=this.objCreate("div");this.div.classList.add("pc_popup");var popupbox=this.objCreate('div');popupbox.classList.add("pc_popupbox");this.ObjAppend(this.div,popupbox);var popupTitle=this.objCreate('div');popupTitle.classList.add("pc_popup_title");popupTitle.innerText=BlackCat.Main.langMgr.get("walletImport_import");this.ObjAppend(popupbox,popupTitle);this.inputFileText=this.objCreate("input");this.inputFileText.classList.add("pc_filetitle");this.inputFileText.type="text";this.inputFileText.placeholder=BlackCat.Main.langMgr.get("walletImport_select_file");this.ObjAppend(popupbox,this.inputFileText);var inputFileI=this.objCreate("i");inputFileI.classList.add("pc_upload","iconfont","icon-wenjianjia");this.ObjAppend(popupbox,inputFileI);this.inputFile=this.objCreate("input");this.inputFile.type="file";this.inputFile.onchange=function(){if(_this136.inputFile.files&&_this136.inputFile.files.length>0){_this136.filename=_this136.inputFile.files[0].name;_this136.reader.readAsText(_this136.inputFile.files[0]);}else{_this136.inputFileText.placeholder=BlackCat.Main.langMgr.get("walletImport_select_file");_this136.filename="";}};this.ObjAppend(popupbox,this.inputFile);this.inputPwd=this.objCreate("input");this.inputPwd.placeholder=BlackCat.Main.langMgr.get("walletImport_password");this.inputPwd.type="password";this.ObjAppend(popupbox,this.inputPwd);var popupbutbox=this.objCreate('div');popupbutbox.classList.add("pc_popupbutbox");this.ObjAppend(popupbox,popupbutbox);var popupClose=this.objCreate('button');popupClose.classList.add("pc_cancel");popupClose.textContent=BlackCat.Main.langMgr.get("cancel");popupClose.onclick=function(){_this136.remove(300);};this.ObjAppend(popupbutbox,popupClose);var bindobj=this.objCreate("button");bindobj.textContent=BlackCat.Main.langMgr.get("walletImport_doImport");bindobj.onclick=function(){_this136.doBindWallet();};this.ObjAppend(popupbutbox,bindobj);}},{key:'doBindWallet',value:function doBindWallet(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee99(){var _this137=this;var res;return regeneratorRuntime.wrap(function _callee99$(_context99){while(1){switch(_context99.prev=_context99.next){case 0:if(this.filename){_context99.next=3;break;}BlackCat.Main.showErrMsg("walletImport_select_file");return _context99.abrupt('return');case 3:this.filepass=this.inputPwd.value;if(!(!this.filepass||this.filepass.toString().length==0)){_context99.next=7;break;}BlackCat.Main.showErrMsg("walletImport_password",function(){_this137.inputPwd.focus();});return _context99.abrupt('return');case 7:BlackCat.Main.viewMgr.change("ViewLoading");_context99.next=10;return BlackCat.Main.wallet.open(this.filepass);case 10:res=_context99.sent;if(res){this.bindWallet(BlackCat.Main.wallet.filestr);}BlackCat.Main.viewMgr.viewLoading.remove();case 13:case'end':return _context99.stop();}}},_callee99,this);}));}},{key:'bindWallet',value:function bindWallet(walletStr){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee100(){var wallet_bind_res;return regeneratorRuntime.wrap(function _callee100$(_context100){while(1){switch(_context100.prev=_context100.next){case 0:_context100.next=2;return BlackCat.ApiTool.bindWallet(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,walletStr);case 2:wallet_bind_res=_context100.sent;if(wallet_bind_res.r){BlackCat.Main.showToast("walletImport_bind_succ");BlackCat.Main.viewMgr.walletView.remove();this.remove();BlackCat.Main.validateLogin();}else{BlackCat.Main.showErrCode(wallet_bind_res.errCode);}case 4:case'end':return _context100.stop();}}},_callee100,this);}));}}]);return WalletImportView;}(BlackCat.ViewBase);BlackCat.WalletImportView=WalletImportView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var WalletView=function(_BlackCat$ViewBase38){_inherits(WalletView,_BlackCat$ViewBase38);function WalletView(){_classCallCheck(this,WalletView);return _possibleConstructorReturn(this,(WalletView.__proto__||Object.getPrototypeOf(WalletView)).apply(this,arguments));}_createClass(WalletView,[{key:'create',value:function create(){this.div=this.objCreate("div");this.div.classList.add("pc_bj","pc_wallet");var walletTitle=this.objCreate("div");walletTitle.classList.add("pc_wallet_title");this.ObjAppend(this.div,walletTitle);var walletTitleH1=this.objCreate("h1");walletTitleH1.classList.add("iconfont","icon-blacat");this.ObjAppend(walletTitle,walletTitleH1);var walletTitleP=this.objCreate("p");walletTitleP.innerText=BlackCat.Main.langMgr.get("walletView_info");this.ObjAppend(walletTitle,walletTitleP);var createWallet=this.objCreate("button");createWallet.textContent=BlackCat.Main.langMgr.get("walletView_create");createWallet.classList.add("pc_createWallet");createWallet.onclick=function(){BlackCat.Main.viewMgr.change("WalletCreateView");};this.ObjAppend(this.div,createWallet);var iCreateWallet=this.objCreate("i");iCreateWallet.classList.add("iconfont","icon-chuangjian1");this.ObjAppend(createWallet,iCreateWallet);var importWallet=this.objCreate("button");importWallet.textContent=BlackCat.Main.langMgr.get("walletView_import");importWallet.classList.add("pc_importWallet");importWallet.onclick=function(){BlackCat.Main.viewMgr.change("WalletImportView");};this.ObjAppend(this.div,importWallet);var iImportWallet=this.objCreate("i");iImportWallet.classList.add("iconfont","icon-daoru1");this.ObjAppend(importWallet,iImportWallet);}}]);return WalletView;}(BlackCat.ViewBase);BlackCat.WalletView=WalletView;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var ApiTool=function(){function ApiTool(){_classCallCheck(this,ApiTool);}_createClass(ApiTool,null,[{key:'makeUrl',value:function makeUrl(cmd){return this.base_url+'?cmd='+cmd;}},{key:'common',value:function common(cmd,post){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee101(){var formData,i,result,json;return regeneratorRuntime.wrap(function _callee101$(_context101){while(1){switch(_context101.prev=_context101.next){case 0:formData=new FormData();for(i in post){formData.append(i,post[i]);}formData.append("v",this.api_version);_context101.next=5;return fetch(this.makeUrl(cmd),{method:'post',body:formData});case 5:result=_context101.sent;_context101.next=8;return result.json();case 8:json=_context101.sent;return _context101.abrupt('return',json);case 10:case'end':return _context101.stop();}}},_callee101,this);}));}},{key:'isLogined',value:function isLogined(uid,token){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee102(){return regeneratorRuntime.wrap(function _callee102$(_context102){while(1){switch(_context102.prev=_context102.next){case 0:return _context102.abrupt('return',this.common('user.isLogined',{uid:uid,token:token}));case 1:case'end':return _context102.stop();}}},_callee102,this);}));}},{key:'getPhoneCode',value:function getPhoneCode(phone){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee103(){return regeneratorRuntime.wrap(function _callee103$(_context103){while(1){switch(_context103.prev=_context103.next){case 0:return _context103.abrupt('return',this.common('user_phone.get_code',{phone:phone}));case 1:case'end':return _context103.stop();}}},_callee103,this);}));}},{key:'getGameIndex',value:function getGameIndex(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee104(){return regeneratorRuntime.wrap(function _callee104$(_context104){while(1){switch(_context104.prev=_context104.next){case 0:return _context104.abrupt('return',this.common('nelapp_game.index',{}));case 1:case'end':return _context104.stop();}}},_callee104,this);}));}},{key:'phoneLogin',value:function phoneLogin(phone,code){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee105(){return regeneratorRuntime.wrap(function _callee105$(_context105){while(1){switch(_context105.prev=_context105.next){case 0:return _context105.abrupt('return',this.common('user_phone.login',{phone:phone,code:code}));case 1:case'end':return _context105.stop();}}},_callee105,this);}));}},{key:'bindWallet',value:function bindWallet(uid,token,wallet){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee106(){return regeneratorRuntime.wrap(function _callee106$(_context106){while(1){switch(_context106.prev=_context106.next){case 0:return _context106.abrupt('return',this.common('user.bind_wallet',{uid:uid,token:token,wallet:wallet}));case 1:case'end':return _context106.stop();}}},_callee106,this);}));}},{key:'getWalletFile',value:function getWalletFile(uid,token){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee107(){return regeneratorRuntime.wrap(function _callee107$(_context107){while(1){switch(_context107.prev=_context107.next){case 0:return _context107.abrupt('return',this.common('user.get_wallet_file',{uid:uid,token:token}));case 1:case'end':return _context107.stop();}}},_callee107,this);}));}},{key:'getEntergameParam',value:function getEntergameParam(uid,token,g_id){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee108(){return regeneratorRuntime.wrap(function _callee108$(_context108){while(1){switch(_context108.prev=_context108.next){case 0:return _context108.abrupt('return',this.common('user.get_entergame_param',{uid:uid,token:token,g_id:g_id}));case 1:case'end':return _context108.stop();}}},_callee108,this);}));}},{key:'addUserWalletLogs',value:function addUserWalletLogs(uid,token,txid,g_id,cnts,type,params,net_type){var trust=arguments.length>8&&arguments[8]!==undefined?arguments[8]:"0";var net_fee=arguments.length>9&&arguments[9]!==undefined?arguments[9]:"";return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee109(){return regeneratorRuntime.wrap(function _callee109$(_context109){while(1){switch(_context109.prev=_context109.next){case 0:return _context109.abrupt('return',this.common('user_wallet.logss',{uid:uid,token:token,txid:txid,g_id:g_id,cnts:cnts,type:type,params:params,net_type:net_type,trust:trust,net_fee:net_fee}));case 1:case'end':return _context109.stop();}}},_callee109,this);}));}},{key:'getWalletListss',value:function getWalletListss(uid,token,page,num,net_type){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee110(){return regeneratorRuntime.wrap(function _callee110$(_context110){while(1){switch(_context110.prev=_context110.next){case 0:return _context110.abrupt('return',this.common('user_wallet.listss',{uid:uid,token:token,page:page,num:num,net_type:net_type}));case 1:case'end':return _context110.stop();}}},_callee110,this);}));}},{key:'walletNotify',value:function walletNotify(uid,token,txid,net_type){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee111(){return regeneratorRuntime.wrap(function _callee111$(_context111){while(1){switch(_context111.prev=_context111.next){case 0:return _context111.abrupt('return',this.common('user_wallet.notify',{uid:uid,token:token,txid:txid,net_type:net_type}));case 1:case'end':return _context111.stop();}}},_callee111,this);}));}},{key:'getAppWalletNotifys',value:function getAppWalletNotifys(uid,token,g_id,net_type){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee112(){return regeneratorRuntime.wrap(function _callee112$(_context112){while(1){switch(_context112.prev=_context112.next){case 0:return _context112.abrupt('return',this.common('user_wallet.get_notify',{uid:uid,token:token,g_id:g_id,net_type:net_type}));case 1:case'end':return _context112.stop();}}},_callee112,this);}));}},{key:'getPlatWalletNotifys',value:function getPlatWalletNotifys(uid,token,net_type){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee113(){return regeneratorRuntime.wrap(function _callee113$(_context113){while(1){switch(_context113.prev=_context113.next){case 0:return _context113.abrupt('return',this.common('user_wallet.get_notify_plat',{uid:uid,token:token,net_type:net_type}));case 1:case'end':return _context113.stop();}}},_callee113,this);}));}},{key:'walletNotifyExt',value:function walletNotifyExt(uid,token,txid,ext,net_type){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee114(){return regeneratorRuntime.wrap(function _callee114$(_context114){while(1){switch(_context114.prev=_context114.next){case 0:return _context114.abrupt('return',this.common('user_wallet.notify_ext',{uid:uid,token:token,txid:txid,ext:ext,net_type:net_type}));case 1:case'end':return _context114.stop();}}},_callee114,this);}));}},{key:'getEnterParams',value:function getEnterParams(uid,token,g_id){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee115(){return regeneratorRuntime.wrap(function _callee115$(_context115){while(1){switch(_context115.prev=_context115.next){case 0:return _context115.abrupt('return',this.common('user.get_enter_params',{uid:uid,token:token,g_id:g_id}));case 1:case'end':return _context115.stop();}}},_callee115,this);}));}},{key:'registerByPhone',value:function registerByPhone(phone,code,pwd,region,uid){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee116(){return regeneratorRuntime.wrap(function _callee116$(_context116){while(1){switch(_context116.prev=_context116.next){case 0:return _context116.abrupt('return',this.common('user_phone.register_pass',{phone:phone,code:code,pwd:pwd,region:region,uid:uid}));case 1:case'end':return _context116.stop();}}},_callee116,this);}));}},{key:'validPhone',value:function validPhone(phone){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee117(){return regeneratorRuntime.wrap(function _callee117$(_context117){while(1){switch(_context117.prev=_context117.next){case 0:return _context117.abrupt('return',this.common('user_phone.valid_register',{phone:phone}));case 1:case'end':return _context117.stop();}}},_callee117,this);}));}},{key:'validUid',value:function validUid(uid){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee118(){return regeneratorRuntime.wrap(function _callee118$(_context118){while(1){switch(_context118.prev=_context118.next){case 0:return _context118.abrupt('return',this.common('user.valid_register',{uid:uid}));case 1:case'end':return _context118.stop();}}},_callee118,this);}));}},{key:'registerByEmail',value:function registerByEmail(email,code,pwd,region,uid){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee119(){return regeneratorRuntime.wrap(function _callee119$(_context119){while(1){switch(_context119.prev=_context119.next){case 0:return _context119.abrupt('return',this.common('user_email.register_pass',{email:email,code:code,pwd:pwd,region:region,uid:uid}));case 1:case'end':return _context119.stop();}}},_callee119,this);}));}},{key:'validEmail',value:function validEmail(email){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee120(){return regeneratorRuntime.wrap(function _callee120$(_context120){while(1){switch(_context120.prev=_context120.next){case 0:return _context120.abrupt('return',this.common('user_email.valid_register',{email:email}));case 1:case'end':return _context120.stop();}}},_callee120,this);}));}},{key:'phoneLoginPass',value:function phoneLoginPass(phone,pwd){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee121(){return regeneratorRuntime.wrap(function _callee121$(_context121){while(1){switch(_context121.prev=_context121.next){case 0:return _context121.abrupt('return',this.common('user_phone.login_pass',{phone:phone,pwd:pwd}));case 1:case'end':return _context121.stop();}}},_callee121,this);}));}},{key:'emailLoginPass',value:function emailLoginPass(email,pwd){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee122(){return regeneratorRuntime.wrap(function _callee122$(_context122){while(1){switch(_context122.prev=_context122.next){case 0:return _context122.abrupt('return',this.common('user_email.login_pass',{email:email,pwd:pwd}));case 1:case'end':return _context122.stop();}}},_callee122,this);}));}},{key:'getEmailCode',value:function getEmailCode(email,lang){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee123(){return regeneratorRuntime.wrap(function _callee123$(_context123){while(1){switch(_context123.prev=_context123.next){case 0:return _context123.abrupt('return',this.common('user_email.get_code',{email:email,lang:lang}));case 1:case'end':return _context123.stop();}}},_callee123,this);}));}},{key:'userLoginPass',value:function userLoginPass(uid,pwd){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee124(){return regeneratorRuntime.wrap(function _callee124$(_context124){while(1){switch(_context124.prev=_context124.next){case 0:return _context124.abrupt('return',this.common('user.login',{uid:uid,pwd:pwd}));case 1:case'end':return _context124.stop();}}},_callee124,this);}));}},{key:'modUserIcon',value:function modUserIcon(uid,token,file){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee125(){return regeneratorRuntime.wrap(function _callee125$(_context125){while(1){switch(_context125.prev=_context125.next){case 0:return _context125.abrupt('return',this.common('user_icon.upload',{uid:uid,token:token,file:file}));case 1:case'end':return _context125.stop();}}},_callee125,this);}));}},{key:'modUserName',value:function modUserName(uid,token,name){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee126(){return regeneratorRuntime.wrap(function _callee126$(_context126){while(1){switch(_context126.prev=_context126.next){case 0:return _context126.abrupt('return',this.common('user.mod_name',{uid:uid,token:token,name:name}));case 1:case'end':return _context126.stop();}}},_callee126,this);}));}},{key:'modUserSex',value:function modUserSex(uid,token,sex){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee127(){return regeneratorRuntime.wrap(function _callee127$(_context127){while(1){switch(_context127.prev=_context127.next){case 0:return _context127.abrupt('return',this.common('user.mod_sex',{uid:uid,token:token,sex:sex}));case 1:case'end':return _context127.stop();}}},_callee127,this);}));}},{key:'modUserArea',value:function modUserArea(uid,token,region){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee128(){return regeneratorRuntime.wrap(function _callee128$(_context128){while(1){switch(_context128.prev=_context128.next){case 0:return _context128.abrupt('return',this.common('user.mod_region',{uid:uid,token:token,region:region}));case 1:case'end':return _context128.stop();}}},_callee128,this);}));}},{key:'forgetPassByPhone',value:function forgetPassByPhone(phone,code,new_pwd){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee129(){return regeneratorRuntime.wrap(function _callee129$(_context129){while(1){switch(_context129.prev=_context129.next){case 0:return _context129.abrupt('return',this.common('user_phone.mod_pwd',{phone:phone,code:code,new_pwd:new_pwd}));case 1:case'end':return _context129.stop();}}},_callee129,this);}));}},{key:'forgetPassByEmail',value:function forgetPassByEmail(email,code,new_pwd){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee130(){return regeneratorRuntime.wrap(function _callee130$(_context130){while(1){switch(_context130.prev=_context130.next){case 0:return _context130.abrupt('return',this.common('user_email.mod_pwd',{email:email,code:code,new_pwd:new_pwd}));case 1:case'end':return _context130.stop();}}},_callee130,this);}));}},{key:'getTrustNncs',value:function getTrustNncs(uid,token,g_id){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee131(){return regeneratorRuntime.wrap(function _callee131$(_context131){while(1){switch(_context131.prev=_context131.next){case 0:return _context131.abrupt('return',this.common('user_nncs.get_nncs',{uid:uid,token:token,g_id:g_id}));case 1:case'end':return _context131.stop();}}},_callee131,this);}));}},{key:'getTrustLists',value:function getTrustLists(uid,token,offset,num){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee132(){return regeneratorRuntime.wrap(function _callee132$(_context132){while(1){switch(_context132.prev=_context132.next){case 0:return _context132.abrupt('return',this.common('user_nncs.listss',{uid:uid,token:token,offset:offset,num:num}));case 1:case'end':return _context132.stop();}}},_callee132,this);}));}},{key:'delTrustNncs',value:function delTrustNncs(uid,token,id){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee133(){return regeneratorRuntime.wrap(function _callee133$(_context133){while(1){switch(_context133.prev=_context133.next){case 0:return _context133.abrupt('return',this.common('user_nncs.del_nncs',{uid:uid,token:token,id:id}));case 1:case'end':return _context133.stop();}}},_callee133,this);}));}},{key:'addAddrbook',value:function addAddrbook(uid,token,address_name,address_wallet,address_desc){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee134(){return regeneratorRuntime.wrap(function _callee134$(_context134){while(1){switch(_context134.prev=_context134.next){case 0:return _context134.abrupt('return',this.common('user_addressbook.add_addr',{uid:uid,token:token,address_name:address_name,address_wallet:address_wallet,address_desc:address_desc}));case 1:case'end':return _context134.stop();}}},_callee134,this);}));}},{key:'delAddrbook',value:function delAddrbook(uid,token,id){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee135(){return regeneratorRuntime.wrap(function _callee135$(_context135){while(1){switch(_context135.prev=_context135.next){case 0:return _context135.abrupt('return',this.common('user_addressbook.del_addr',{uid:uid,token:token,id:id}));case 1:case'end':return _context135.stop();}}},_callee135,this);}));}},{key:'getAddrbook',value:function getAddrbook(uid,token){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee136(){return regeneratorRuntime.wrap(function _callee136$(_context136){while(1){switch(_context136.prev=_context136.next){case 0:return _context136.abrupt('return',this.common('user_addressbook.get_addr',{uid:uid,token:token}));case 1:case'end':return _context136.stop();}}},_callee136,this);}));}},{key:'updateAddrbook',value:function updateAddrbook(uid,token,address_name,address_wallet,address_desc,id){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee137(){return regeneratorRuntime.wrap(function _callee137$(_context137){while(1){switch(_context137.prev=_context137.next){case 0:return _context137.abrupt('return',this.common('user_addressbook.update_addr',{uid:uid,token:token,address_name:address_name,address_wallet:address_wallet,address_desc:address_desc,id:id}));case 1:case'end':return _context137.stop();}}},_callee137,this);}));}},{key:'getExchangeInfo',value:function getExchangeInfo(uid,token,src_coin){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee138(){return regeneratorRuntime.wrap(function _callee138$(_context138){while(1){switch(_context138.prev=_context138.next){case 0:return _context138.abrupt('return',this.common('user_gas.get_info',{uid:uid,token:token,src_coin:src_coin}));case 1:case'end':return _context138.stop();}}},_callee138,this);}));}}]);return ApiTool;}();ApiTool.api_version="1";ApiTool.base_url='';BlackCat.ApiTool=ApiTool;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var User=function(){function User(){_classCallCheck(this,User);this.info=new BlackCat.UserInfo();this.cacheKey='BC_userinfo';}_createClass(User,[{key:'getInfo',value:function getInfo(){var userinfo=localStorage.getItem(this.cacheKey);if(userinfo){this.info=JSON.parse(userinfo);}}},{key:'setInfo',value:function setInfo(key,value){this.info[key]=value;localStorage.setItem(this.cacheKey,JSON.stringify(this.info));}},{key:'isLogined',value:function isLogined(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee139(){var api_userinfo,new_wallet_file;return regeneratorRuntime.wrap(function _callee139$(_context139){while(1){switch(_context139.prev=_context139.next){case 0:_context139.next=2;return BlackCat.ApiTool.isLogined(this.info.uid,this.info.token);case 2:api_userinfo=_context139.sent;if(!api_userinfo.r){_context139.next=12;break;}if(!(api_userinfo.data.wallet!=this.info.wallet)){_context139.next=9;break;}_context139.next=7;return this.getWalletFile();case 7:new_wallet_file=_context139.sent;if(new_wallet_file!=null){localStorage.removeItem(this.info.wallet);this.info.wallet=api_userinfo.data.wallet;this.setInfo('wallet',this.info.wallet);localStorage.setItem(this.info.wallet,new_wallet_file);}case 9:return _context139.abrupt('return',true);case 12:localStorage.removeItem(this.cacheKey);localStorage.removeItem(this.info.wallet);this.info=new BlackCat.UserInfo();return _context139.abrupt('return',false);case 16:case'end':return _context139.stop();}}},_callee139,this);}));}},{key:'getWalletFile',value:function getWalletFile(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee140(){var api_wallet;return regeneratorRuntime.wrap(function _callee140$(_context140){while(1){switch(_context140.prev=_context140.next){case 0:_context140.next=2;return BlackCat.ApiTool.getWalletFile(this.info.uid,this.info.token);case 2:api_wallet=_context140.sent;if(!api_wallet.r){_context140.next=5;break;}return _context140.abrupt('return',api_wallet.data);case 5:return _context140.abrupt('return',null);case 6:case'end':return _context140.stop();}}},_callee140,this);}));}},{key:'logout',value:function logout(){localStorage.removeItem(this.cacheKey);if(this.info.wallet){localStorage.removeItem(this.info.wallet);}this.info=new BlackCat.UserInfo();BlackCat.Main.wallet.closeWallet();}},{key:'getWalletFileCache',value:function getWalletFileCache(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee141(){var walletFile;return regeneratorRuntime.wrap(function _callee141$(_context141){while(1){switch(_context141.prev=_context141.next){case 0:if(!this.info){this.getInfo();}walletFile=localStorage.getItem(this.info.wallet);if(!walletFile){_context141.next=4;break;}return _context141.abrupt('return',walletFile);case 4:return _context141.abrupt('return',null);case 5:case'end':return _context141.stop();}}},_callee141,this);}));}},{key:'validateLogin',value:function validateLogin(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee142(){var user_logined;return regeneratorRuntime.wrap(function _callee142$(_context142){while(1){switch(_context142.prev=_context142.next){case 0:this.getInfo();_context142.next=3;return this.isLogined();case 3:user_logined=_context142.sent;if(user_logined){_context142.next=8;break;}return _context142.abrupt('return',0);case 8:if(this.info.wallet){_context142.next=12;break;}return _context142.abrupt('return',-1);case 12:return _context142.abrupt('return',1);case 13:case'end':return _context142.stop();}}},_callee142,this);}));}}]);return User;}();BlackCat.User=User;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var tools;(function(tools){var CoinTool=function(){function CoinTool(){_classCallCheck(this,CoinTool);}_createClass(CoinTool,null,[{key:'initAllAsset',value:function initAllAsset(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee143(){var allassets,a,asset,names,id,name,i;return regeneratorRuntime.wrap(function _callee143$(_context143){while(1){switch(_context143.prev=_context143.next){case 0:_context143.next=2;return tools.WWW.api_getAllAssets();case 2:allassets=_context143.sent;_context143.t0=regeneratorRuntime.keys(allassets);case 4:if((_context143.t1=_context143.t0()).done){_context143.next=30;break;}a=_context143.t1.value;asset=allassets[a];names=asset.name;id=asset.id;name="";if(!(id==CoinTool.id_GAS)){_context143.next=14;break;}name="GAS";_context143.next=26;break;case 14:if(!(id==CoinTool.id_NEO)){_context143.next=18;break;}name="NEO";_context143.next=26;break;case 18:_context143.t2=regeneratorRuntime.keys(names);case 19:if((_context143.t3=_context143.t2()).done){_context143.next=26;break;}i=_context143.t3.value;name=names[i].name;if(!(names[i].lang=="en")){_context143.next=24;break;}return _context143.abrupt('break',26);case 24:_context143.next=19;break;case 26:CoinTool.assetID2name[id]=name;CoinTool.name2assetID[name]=id;_context143.next=4;break;case 30:case'end':return _context143.stop();}}},_callee143,this);}));}},{key:'getassets',value:function getassets(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee144(){var height,utxos,olds,olds2,n,old,findutxo,_i5,utxo,assets,i,item,asset,_utxo;return regeneratorRuntime.wrap(function _callee144$(_context144){while(1){switch(_context144.prev=_context144.next){case 0:_context144.next=2;return tools.WWW.api_getHeight_nodes();case 2:height=_context144.sent;_context144.next=5;return tools.WWW.api_getUTXO(tools.StorageTool.getStorage("current-address"));case 5:utxos=_context144.sent;olds=tools.OldUTXO.getOldutxos();olds2=new Array();for(n=0;n<olds.length;n++){old=olds[n];findutxo=false;for(_i5=0;_i5<utxos.length;_i5++){utxo=utxos[_i5];if(utxo.txid==old.txid&&old.n==utxo.n&&height-old.height<=2){findutxo=true;utxos.splice(_i5,1);}}if(findutxo){olds2.push(old);}}tools.OldUTXO.setOldutxos(olds2);assets={};for(i in utxos){item=utxos[i];asset=item.asset;if(assets[asset]==undefined||assets[asset]==null){assets[asset]=[];}_utxo=new tools.UTXO();_utxo.addr=item.addr;_utxo.asset=item.asset;_utxo.n=item.n;_utxo.txid=item.txid;_utxo.count=Neo.Fixed8.parse(item.value);assets[asset].push(_utxo);}return _context144.abrupt('return',assets);case 13:case'end':return _context144.stop();}}},_callee144,this);}));}},{key:'makeTran',value:function makeTran(utxos,targetaddr,assetid,sendcount){var net_fee=arguments.length>4&&arguments[4]!==undefined?arguments[4]:Neo.Fixed8.Zero;var res=new tools.Result();var us=utxos[assetid];if(us==undefined){throw new Error("pay_not_enough_utxo");}var tran=new ThinNeo.Transaction();tran.type=ThinNeo.TransactionType.ContractTransaction;tran.version=0;tran.extdata=null;tran.attributes=[];tran.inputs=[];var scraddr="";utxos[assetid].sort(function(a,b){return a.count.compareTo(b.count);});var count=Neo.Fixed8.Zero;var clonearr=[].concat(us);var old=[];var sendcounts=sendcount.add(net_fee);for(var i=0;i<us.length;i++){var input=new ThinNeo.TransactionInput();input.hash=us[i].txid.hexToBytes().reverse();input.index=us[i].n;input["_addr"]=us[i].addr;tran.inputs.push(input);count=count.add(us[i].count);scraddr=us[i].addr;clonearr.shift();old.push(new tools.OldUTXO(us[i].txid,us[i].n));if(count.compareTo(sendcounts)>0){break;}}if(count.compareTo(sendcounts)>=0){tran.outputs=[];if(sendcount.compareTo(Neo.Fixed8.Zero)>0){var output=new ThinNeo.TransactionOutput();output.assetId=assetid.hexToBytes().reverse();output.value=sendcount;output.toAddress=ThinNeo.Helper.GetPublicKeyScriptHash_FromAddress(targetaddr);tran.outputs.push(output);}var change=count.subtract(sendcounts);if(change.compareTo(Neo.Fixed8.Zero)>0){var outputchange=new ThinNeo.TransactionOutput();outputchange.toAddress=ThinNeo.Helper.GetPublicKeyScriptHash_FromAddress(scraddr);outputchange.value=change;outputchange.assetId=assetid.hexToBytes().reverse();tran.outputs.push(outputchange);}res.err=false;res.info={"tran":tran,"oldarr":old};}else{throw new Error("pay_not_enough_money");}return res;}},{key:'makeTranMulti',value:function makeTranMulti(utxos,targets,assetid){var net_fee=arguments.length>3&&arguments[3]!==undefined?arguments[3]:Neo.Fixed8.Zero;var _count=0;for(var _i6=0;_i6<targets.length;_i6++){_count+=Number(targets[_i6].count);}if(_count<=0){throw new Error("can_not_send_zero");}var sendcount=Neo.Fixed8.fromNumber(_count);var res=new tools.Result();var us=utxos[assetid];if(us==undefined){throw new Error("pay_not_enough_utxo");}var tran=new ThinNeo.Transaction();tran.type=ThinNeo.TransactionType.ContractTransaction;tran.version=0;tran.extdata=null;tran.attributes=[];tran.inputs=[];var scraddr="";utxos[assetid].sort(function(a,b){return a.count.compareTo(b.count);});var count=Neo.Fixed8.Zero;var clonearr=[].concat(us);var old=[];var sendcounts=sendcount.add(net_fee);for(var i=0;i<us.length;i++){var input=new ThinNeo.TransactionInput();input.hash=us[i].txid.hexToBytes().reverse();input.index=us[i].n;input["_addr"]=us[i].addr;tran.inputs.push(input);count=count.add(us[i].count);scraddr=us[i].addr;clonearr.shift();old.push(new tools.OldUTXO(us[i].txid,us[i].n));if(count.compareTo(sendcounts)>0){break;}}if(count.compareTo(sendcounts)>=0){tran.outputs=[];if(sendcount.compareTo(Neo.Fixed8.Zero)>0){for(var k=0;k<targets.length;k++){var output=new ThinNeo.TransactionOutput();output.assetId=assetid.hexToBytes().reverse();output.value=Neo.Fixed8.parse(targets[k].count+"");output.toAddress=ThinNeo.Helper.GetPublicKeyScriptHash_FromAddress(targets[k].toaddr);tran.outputs.push(output);}}var change=count.subtract(sendcounts);if(change.compareTo(Neo.Fixed8.Zero)>0){var outputchange=new ThinNeo.TransactionOutput();outputchange.toAddress=ThinNeo.Helper.GetPublicKeyScriptHash_FromAddress(scraddr);outputchange.value=change;outputchange.assetId=assetid.hexToBytes().reverse();tran.outputs.push(outputchange);}res.err=false;res.info={"tran":tran,"oldarr":old};}else{throw new Error("pay_not_enough_money");}return res;}},{key:'rawTransaction',value:function rawTransaction(targetaddr,asset,count){var net_fee=arguments.length>3&&arguments[3]!==undefined?arguments[3]:Neo.Fixed8.Zero;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee145(){var arr,add,n,i,_count,utxos,tranres,tran,txid,msg,pubkey,prekey,addr,signdata,data,res,height,result,olds;return regeneratorRuntime.wrap(function _callee145$(_context145){while(1){switch(_context145.prev=_context145.next){case 0:arr=tools.StorageTool.getLoginArr();add=tools.StorageTool.getStorage("current-address");_context145.prev=2;n=arr.findIndex(function(login){return login.address==add;});_context145.next=16;break;case 6:_context145.prev=6;_context145.t0=_context145['catch'](2);i=0;case 9:if(!(i<arr.length)){_context145.next=16;break;}if(!(add==arr[i].address)){_context145.next=13;break;}n=i;return _context145.abrupt('break',16);case 13:i++;_context145.next=9;break;case 16:_count=Neo.Fixed8.parse(count+"");_context145.next=19;return CoinTool.getassets();case 19:utxos=_context145.sent;_context145.prev=20;tranres=CoinTool.makeTran(utxos,targetaddr,asset,_count,net_fee);tran=tranres.info['tran'];if(tran.witnesses==null)tran.witnesses=[];txid=tran.GetHash().clone().reverse().toHexString();msg=tran.GetMessage().clone();pubkey=arr[n].pubkey.clone();prekey=arr[n].prikey.clone();addr=arr[n].address;signdata=ThinNeo.Helper.Sign(msg,prekey);tran.AddWitness(signdata,pubkey,addr);data=tran.GetRawData();res=new tools.Result();_context145.next=35;return tools.WWW.api_getHeight_nodes();case 35:height=_context145.sent;_context145.next=38;return tools.WWW.api_postRawTransaction(data);case 38:result=_context145.sent;if(result["sendrawtransactionresult"]){res.err=!result;res.info=txid;olds=tranres.info['oldarr'];olds.map(function(old){return old.height=height;});tools.OldUTXO.oldutxosPush(olds);}else{res.err=true;res.info="no txid";}return _context145.abrupt('return',res);case 43:_context145.prev=43;_context145.t1=_context145['catch'](20);throw _context145.t1;case 46:case'end':return _context145.stop();}}},_callee145,this,[[2,6],[20,43]]);}));}},{key:'rawTransactionMulti',value:function rawTransactionMulti(targets,asset){var net_fee=arguments.length>2&&arguments[2]!==undefined?arguments[2]:Neo.Fixed8.Zero;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee146(){var arr,add,n,i,utxos,tranres,tran,txid,msg,pubkey,prekey,addr,signdata,data,res,height,result,olds;return regeneratorRuntime.wrap(function _callee146$(_context146){while(1){switch(_context146.prev=_context146.next){case 0:arr=tools.StorageTool.getLoginArr();add=tools.StorageTool.getStorage("current-address");_context146.prev=2;n=arr.findIndex(function(login){return login.address==add;});_context146.next=16;break;case 6:_context146.prev=6;_context146.t0=_context146['catch'](2);i=0;case 9:if(!(i<arr.length)){_context146.next=16;break;}if(!(add==arr[i].address)){_context146.next=13;break;}n=i;return _context146.abrupt('break',16);case 13:i++;_context146.next=9;break;case 16:_context146.next=18;return CoinTool.getassets();case 18:utxos=_context146.sent;_context146.prev=19;tranres=CoinTool.makeTranMulti(utxos,targets,asset,net_fee);tran=tranres.info['tran'];if(tran.witnesses==null)tran.witnesses=[];txid=tran.GetHash().clone().reverse().toHexString();msg=tran.GetMessage().clone();pubkey=arr[n].pubkey.clone();prekey=arr[n].prikey.clone();addr=arr[n].address;signdata=ThinNeo.Helper.Sign(msg,prekey);tran.AddWitness(signdata,pubkey,addr);data=tran.GetRawData();res=new tools.Result();_context146.next=34;return tools.WWW.api_getHeight_nodes();case 34:height=_context146.sent;_context146.next=37;return tools.WWW.api_postRawTransaction(data);case 37:result=_context146.sent;if(result["sendrawtransactionresult"]){res.err=!result;res.info=txid;olds=tranres.info['oldarr'];olds.map(function(old){return old.height=height;});tools.OldUTXO.oldutxosPush(olds);}else{res.err=true;res.info="no txid";}return _context146.abrupt('return',res);case 42:_context146.prev=42;_context146.t1=_context146['catch'](19);throw _context146.t1;case 45:case'end':return _context146.stop();}}},_callee146,this,[[2,6],[19,42]]);}));}},{key:'contractInvokeTrans_attributes',value:function contractInvokeTrans_attributes(script){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee147(){var current,addr,tran,msg,pubkey,prekey,signdata,data,txid,res,result;return regeneratorRuntime.wrap(function _callee147$(_context147){while(1){switch(_context147.prev=_context147.next){case 0:current=tools.LoginInfo.getCurrentLogin();addr=current.address;tran=new ThinNeo.Transaction();tran.inputs=[];tran.outputs=[];tran.type=ThinNeo.TransactionType.InvocationTransaction;tran.extdata=new ThinNeo.InvokeTransData();tran.extdata.script=script;tran.attributes=new Array(1);tran.attributes[0]=new ThinNeo.Attribute();tran.attributes[0].usage=ThinNeo.TransactionAttributeUsage.Script;tran.attributes[0].data=ThinNeo.Helper.GetPublicKeyScriptHash_FromAddress(addr);if(tran.witnesses==null)tran.witnesses=[];msg=tran.GetMessage().clone();pubkey=current.pubkey.clone();prekey=current.prikey.clone();signdata=ThinNeo.Helper.Sign(msg,prekey);tran.AddWitness(signdata,pubkey,addr);data=tran.GetRawData();txid=tran.GetHash().clone().reverse().toHexString();res=new tools.Result();_context147.next=23;return tools.WWW.api_postRawTransaction(data);case 23:result=_context147.sent;if(result["sendrawtransactionresult"]){if(!result["txid"]){result["txid"]=txid;}}res.err=!result["sendrawtransactionresult"];res.info=result["txid"];return _context147.abrupt('return',res);case 28:case'end':return _context147.stop();}}},_callee147,this);}));}},{key:'contractInvokeTrans',value:function contractInvokeTrans(script){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee148(){var current,addr,assetid,utxos,tranmsg,tran,msg,pubkey,prekey,signdata,data,res,result;return regeneratorRuntime.wrap(function _callee148$(_context148){while(1){switch(_context148.prev=_context148.next){case 0:current=tools.LoginInfo.getCurrentLogin();addr=current.address;assetid=CoinTool.id_GAS;_context148.next=5;return CoinTool.getassets();case 5:utxos=_context148.sent;tranmsg=CoinTool.makeTran(utxos,current.address,assetid,Neo.Fixed8.Zero);tran=tranmsg.info['tran'];tran.type=ThinNeo.TransactionType.InvocationTransaction;tran.extdata=new ThinNeo.InvokeTransData();tran.extdata.script=script;if(tran.witnesses==null)tran.witnesses=[];msg=tran.GetMessage().clone();pubkey=current.pubkey.clone();prekey=current.prikey.clone();signdata=ThinNeo.Helper.Sign(msg,prekey);tran.AddWitness(signdata,pubkey,addr);data=tran.GetRawData();console.log(data);res=new tools.Result();_context148.next=22;return tools.WWW.api_postRawTransaction(data);case 22:result=_context148.sent;res.err=!result;res.info="成功";return _context148.abrupt('return',res);case 26:case'end':return _context148.stop();}}},_callee148,this);}));}},{key:'nep5Transaction',value:function nep5Transaction(address,tatgeraddr,asset,amount){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee149(){var res,decimals,numarr,v,i,bnum,intv,sb,scriptaddress,random_int,random_uint8,math_rand,result;return regeneratorRuntime.wrap(function _callee149$(_context149){while(1){switch(_context149.prev=_context149.next){case 0:_context149.next=2;return tools.WWW.getNep5Asset(asset);case 2:res=_context149.sent;decimals=res["decimals"];numarr=amount.split(".");decimals-=numarr.length==1?0:numarr[1].length;v=1;for(i=0;i<decimals;i++){v*=10;}bnum=new Neo.BigInteger(amount.replace(".",""));intv=bnum.multiply(v).toString();sb=new ThinNeo.ScriptBuilder();scriptaddress=asset.hexToBytes().reverse();try{random_uint8=Neo.Cryptography.RandomNumberGenerator.getRandomValues(new Uint8Array(32));random_int=Neo.BigInteger.fromUint8Array(random_uint8);}catch(e){math_rand=parseInt((Math.random()*10000000).toString());console.log("[BlaCat]",'[cointool]','[nep5Transaction] random_int from js random => ',math_rand);random_int=new Neo.BigInteger(math_rand);}sb.EmitPushNumber(random_int);sb.Emit(ThinNeo.OpCode.DROP);sb.EmitParamJson(["(address)"+address,"(address)"+tatgeraddr,"(integer)"+intv]);sb.EmitPushString("transfer");sb.EmitAppCall(scriptaddress);_context149.next=20;return CoinTool.contractInvokeTrans_attributes(sb.ToArray());case 20:result=_context149.sent;return _context149.abrupt('return',result);case 22:case'end':return _context149.stop();}}},_callee149,this);}));}},{key:'getsgasAssets',value:function getsgasAssets(){var id_SGAS=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.id_SGAS;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee150(){var height,scriptHash,utxos,olds,olds2,n,old,findutxo,_i7,utxo,assets,i,item,asset,_utxo2;return regeneratorRuntime.wrap(function _callee150$(_context150){while(1){switch(_context150.prev=_context150.next){case 0:_context150.next=2;return tools.WWW.api_getHeight_nodes();case 2:height=_context150.sent;scriptHash=ThinNeo.Helper.GetAddressFromScriptHash(id_SGAS.hexToBytes().reverse());_context150.next=6;return tools.WWW.api_getUTXO(scriptHash);case 6:utxos=_context150.sent;olds=tools.OldUTXO.getOldutxos();olds2=new Array();for(n=0;n<olds.length;n++){old=olds[n];findutxo=false;for(_i7=0;_i7<utxos.length;_i7++){utxo=utxos[_i7];if(utxo.txid==old.txid&&old.n==utxo.n&&height-old.height<=2){findutxo=true;utxos.splice(_i7,1);}}if(findutxo){olds2.push(old);}}tools.OldUTXO.setOldutxos(olds2);assets={};for(i in utxos){item=utxos[i];asset=item.asset;if(assets[asset]==undefined||assets[asset]==null){assets[asset]=[];}_utxo2=new tools.UTXO();_utxo2.addr=item.addr;_utxo2.asset=item.asset;_utxo2.n=item.n;_utxo2.txid=item.txid;_utxo2.count=Neo.Fixed8.parse(item.value);assets[asset].push(_utxo2);}return _context150.abrupt('return',assets);case 14:case'end':return _context150.stop();}}},_callee150,this);}));}}]);return CoinTool;}();CoinTool.id_GAS="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";CoinTool.id_NEO="0xc56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b";CoinTool.id_SGAS="";CoinTool.id_SGAS_OLD=[];CoinTool.assetID2name={};CoinTool.name2assetID={};tools.CoinTool=CoinTool;})(tools=BlackCat.tools||(BlackCat.tools={}));})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var floatNum=function(){function floatNum(){_classCallCheck(this,floatNum);}_createClass(floatNum,null,[{key:'strip',value:function strip(num){var precision=arguments.length>1&&arguments[1]!==undefined?arguments[1]:12;return+parseFloat(num.toPrecision(precision));}},{key:'digitLength',value:function digitLength(num){var eSplit=num.toString().split(/[eE]/);var len=(eSplit[0].split('.')[1]||'').length-+(eSplit[1]||0);return len>0?len:0;}},{key:'float2Fixed',value:function float2Fixed(num){if(num.toString().indexOf('e')===-1){return Number(num.toString().replace('.',''));}var dLen=floatNum.digitLength(num);return dLen>0?num*Math.pow(10,dLen):num;}},{key:'checkBoundary',value:function checkBoundary(num){if(num>Number.MAX_SAFE_INTEGER||num<Number.MIN_SAFE_INTEGER){console.warn(num+' is beyond boundary when transfer to integer, the results may not be accurate');}}},{key:'times',value:function times(num1,num2){for(var _len=arguments.length,others=Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){others[_key-2]=arguments[_key];}if(others.length>0){return floatNum.times.apply(floatNum,[floatNum.times(num1,num2),others[0]].concat(_toConsumableArray(others.slice(1))));}var num1Changed=floatNum.float2Fixed(num1);var num2Changed=floatNum.float2Fixed(num2);var baseNum=floatNum.digitLength(num1)+floatNum.digitLength(num2);var leftValue=num1Changed*num2Changed;floatNum.checkBoundary(leftValue);return leftValue/Math.pow(10,baseNum);}},{key:'plus',value:function plus(num1,num2){for(var _len2=arguments.length,others=Array(_len2>2?_len2-2:0),_key2=2;_key2<_len2;_key2++){others[_key2-2]=arguments[_key2];}if(others.length>0){return floatNum.plus.apply(floatNum,[floatNum.plus(num1,num2),others[0]].concat(_toConsumableArray(others.slice(1))));}var baseNum=Math.pow(10,Math.max(floatNum.digitLength(num1),floatNum.digitLength(num2)));return(floatNum.times(num1,baseNum)+floatNum.times(num2,baseNum))/baseNum;}},{key:'minus',value:function minus(num1,num2){for(var _len3=arguments.length,others=Array(_len3>2?_len3-2:0),_key3=2;_key3<_len3;_key3++){others[_key3-2]=arguments[_key3];}if(others.length>0){return floatNum.minus.apply(floatNum,[floatNum.minus(num1,num2),others[0]].concat(_toConsumableArray(others.slice(1))));}var baseNum=Math.pow(10,Math.max(floatNum.digitLength(num1),floatNum.digitLength(num2)));return(floatNum.times(num1,baseNum)-floatNum.times(num2,baseNum))/baseNum;}},{key:'divide',value:function divide(num1,num2){for(var _len4=arguments.length,others=Array(_len4>2?_len4-2:0),_key4=2;_key4<_len4;_key4++){others[_key4-2]=arguments[_key4];}if(others.length>0){return floatNum.divide.apply(floatNum,[floatNum.divide(num1,num2),others[0]].concat(_toConsumableArray(others.slice(1))));}var num1Changed=floatNum.float2Fixed(num1);var num2Changed=floatNum.float2Fixed(num2);floatNum.checkBoundary(num1Changed);floatNum.checkBoundary(num2Changed);return floatNum.times(num1Changed/num2Changed,Math.pow(10,floatNum.digitLength(num2)-floatNum.digitLength(num1)));}},{key:'round',value:function round(num,ratio){var base=Math.pow(10,ratio);return floatNum.divide(Math.round(floatNum.times(num,base)),base);}},{key:'addZero',value:function addZero(num,ratio){var s_x=num.toString();var pos_decimal=s_x.indexOf('.');if(pos_decimal<0){pos_decimal=s_x.length;s_x+='.';}while(s_x.length<=pos_decimal+ratio){s_x+='0';}return s_x;}}]);return floatNum;}();BlackCat.floatNum=floatNum;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var tools;(function(tools){var neotools=function(){function neotools(){_classCallCheck(this,neotools);}_createClass(neotools,null,[{key:'verifyAddress',value:function verifyAddress(addr){var verify=/^[a-zA-Z0-9]{34,34}$/;var res=verify.test(addr)?neotools.verifyPublicKey(addr):verify.test(addr);return res;}},{key:'verifyPublicKey',value:function verifyPublicKey(publicKey){var array=Neo.Cryptography.Base58.decode(publicKey);var check=array.subarray(21,21+4);var checkdata=array.subarray(0,21);var hashd=Neo.Cryptography.Sha256.computeHash(checkdata);hashd=Neo.Cryptography.Sha256.computeHash(hashd);var hashd=hashd.slice(0,4);var checked=new Uint8Array(hashd);var error=false;for(var i=0;i<4;i++){if(checked[i]!=check[i]){error=true;break;}}return!error;}},{key:'wifDecode',value:function wifDecode(wif){var result=new tools.Result();var login=new tools.LoginInfo();try{login.prikey=ThinNeo.Helper.GetPrivateKeyFromWIF(wif);}catch(e){result.err=true;result.info=e.message;return result;}try{login.pubkey=ThinNeo.Helper.GetPublicKeyFromPrivateKey(login.prikey);}catch(e){result.err=true;result.info=e.message;return result;}try{login.address=ThinNeo.Helper.GetAddressFromPublicKey(login.pubkey);}catch(e){result.err=true;result.info=e.message;return result;}result.info=login;return result;}},{key:'nep2FromWif',value:function nep2FromWif(wif,password){var prikey;var pubkey;var address;var res=new tools.Result();try{prikey=ThinNeo.Helper.GetPrivateKeyFromWIF(wif);var n=16384;var r=8;var p=8;ThinNeo.Helper.GetNep2FromPrivateKey(prikey,password,n,r,p,function(info,result){res.err=false;res.info.nep2=result;pubkey=ThinNeo.Helper.GetPublicKeyFromPrivateKey(prikey);var hexstr=pubkey.toHexString();address=ThinNeo.Helper.GetAddressFromPublicKey(pubkey);res.info.address=address;return res;});}catch(e){res.err=true;res.info=e.message;return res;}}},{key:'nep2ToWif',value:function nep2ToWif(nep2,password){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee151(){var res,login,promise;return regeneratorRuntime.wrap(function _callee151$(_context151){while(1){switch(_context151.prev=_context151.next){case 0:res=new tools.Result();login=new tools.LoginInfo();promise=new Promise(function(resolve,reject){var n=16384;var r=8;var p=8;ThinNeo.Helper.GetPrivateKeyFromNep2(nep2,password,n,r,p,function(info,result){login.prikey=result;if(login.prikey!=null){login.pubkey=ThinNeo.Helper.GetPublicKeyFromPrivateKey(login.prikey);login.address=ThinNeo.Helper.GetAddressFromPublicKey(login.pubkey);res.err=false;res.info=login;resolve(res);}else{res.err=true;reject(res);}});});return _context151.abrupt('return',promise);case 4:case'end':return _context151.stop();}}},_callee151,this);}));}},{key:'nep6Load',value:function nep6Load(wallet,password){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee152(){var istart,res,arr,keyindex,account,result;return regeneratorRuntime.wrap(function _callee152$(_context152){while(1){switch(_context152.prev=_context152.next){case 0:_context152.prev=0;istart=0;res=new tools.Result();arr=new Array();if(!wallet.accounts){_context152.next=26;break;}keyindex=0;case 6:if(!(keyindex<wallet.accounts.length)){_context152.next=24;break;}account=wallet.accounts[keyindex];if(!(account.nep2key==null)){_context152.next=10;break;}return _context152.abrupt('continue',21);case 10:_context152.prev=10;_context152.next=13;return neotools.getPriKeyfromAccount(wallet.scrypt,password,account);case 13:result=_context152.sent;arr.push(result.info);return _context152.abrupt('return',arr);case 18:_context152.prev=18;_context152.t0=_context152['catch'](10);throw _context152.t0;case 21:keyindex++;_context152.next=6;break;case 24:_context152.next=27;break;case 26:throw console.error("The account cannot be empty");case 27:_context152.next=32;break;case 29:_context152.prev=29;_context152.t1=_context152['catch'](0);throw _context152.t1.result;case 32:case'end':return _context152.stop();}}},_callee152,this,[[0,29],[10,18]]);}));}},{key:'getPriKeyfromAccount',value:function getPriKeyfromAccount(scrypt,password,account){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee153(){var res,promise;return regeneratorRuntime.wrap(function _callee153$(_context153){while(1){switch(_context153.prev=_context153.next){case 0:res=new tools.Result();promise=new Promise(function(resolve,reject){account.getPrivateKey(scrypt,password,function(info,result){if(info=="finish"){var pubkey=ThinNeo.Helper.GetPublicKeyFromPrivateKey(result);var address=ThinNeo.Helper.GetAddressFromPublicKey(pubkey);var wif=ThinNeo.Helper.GetWifFromPrivateKey(result);var hexkey=result.toHexString();res.err=false;res.info={pubkey:pubkey,address:address,prikey:result};resolve(res);}else{reject({err:true,result:result});}});});return _context153.abrupt('return',promise);case 3:case'end':return _context153.stop();}}},_callee153,this);}));}}]);return neotools;}();tools.neotools=neotools;})(tools=BlackCat.tools||(BlackCat.tools={}));})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var tools;(function(tools){var NNSTool=function(){function NNSTool(){_classCallCheck(this,NNSTool);}_createClass(NNSTool,null,[{key:'initRootDomain',value:function initRootDomain(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee154(){var test,scriptaddress,domain;return regeneratorRuntime.wrap(function _callee154$(_context154){while(1){switch(_context154.prev=_context154.next){case 0:test=new tools.RootDomainInfo();test.roothash=NNSTool.nameHash("test");test.rootname="test";scriptaddress=tools.Consts.baseContract.hexToBytes().reverse();_context154.next=6;return NNSTool.getOwnerInfo(test.roothash,scriptaddress);case 6:domain=_context154.sent;test.owner=domain.owner;test.register=domain.register;test.resolver=domain.resolver;test.ttl=domain.ttl;NNSTool.root_test=test;case 12:case'end':return _context154.stop();}}},_callee154,this);}));}},{key:'queryDomainInfo',value:function queryDomainInfo(doamin){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee155(){var domainarr,subdomain,nnshash,doamininfo,owner;return regeneratorRuntime.wrap(function _callee155$(_context155){while(1){switch(_context155.prev=_context155.next){case 0:domainarr=doamin.split('.');subdomain=domainarr[0];nnshash=NNSTool.nameHashArray(domainarr);_context155.next=5;return NNSTool.getOwnerInfo(nnshash,tools.Consts.baseContract.hexToBytes().reverse());case 5:doamininfo=_context155.sent;owner=doamininfo.owner.toHexString();return _context155.abrupt('return',doamininfo);case 8:case'end':return _context155.stop();}}},_callee155,this);}));}},{key:'registerDomain',value:function registerDomain(doamin){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee156(){var nnshash,address,sb,scriptaddress,random_uint8,random_int,data,res;return regeneratorRuntime.wrap(function _callee156$(_context156){while(1){switch(_context156.prev=_context156.next){case 0:nnshash=NNSTool.nameHash(NNSTool.root_test.rootname);address=tools.LoginInfo.getCurrentAddress();sb=new ThinNeo.ScriptBuilder();scriptaddress=NNSTool.root_test.register;random_uint8=Neo.Cryptography.RandomNumberGenerator.getRandomValues(new Uint8Array(32));random_int=Neo.BigInteger.fromUint8Array(random_uint8);sb.EmitPushNumber(random_int);sb.Emit(ThinNeo.OpCode.DROP);sb.EmitParamJson(["(addr)"+address,"(bytes)"+nnshash.toHexString(),"(str)"+doamin]);sb.EmitPushString("requestSubDomain");sb.EmitAppCall(scriptaddress);data=sb.ToArray();_context156.next=14;return tools.CoinTool.contractInvokeTrans_attributes(data);case 14:res=_context156.sent;if(!res.err){}return _context156.abrupt('return',res);case 17:case'end':return _context156.stop();}}},_callee156,this);}));}},{key:'getRootName',value:function getRootName(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee157(){var name,sb,scriptaddress,data,result,state,stack,bs;return regeneratorRuntime.wrap(function _callee157$(_context157){while(1){switch(_context157.prev=_context157.next){case 0:name="";sb=new ThinNeo.ScriptBuilder();sb.EmitParamJson(JSON.parse("[]"));sb.EmitPushString("rootName");scriptaddress=tools.Consts.baseContract.hexToBytes().reverse();sb.EmitAppCall(scriptaddress);data=sb.ToArray();_context157.next=9;return tools.WWW.rpc_getInvokescript(data);case 9:result=_context157.sent;_context157.prev=10;state=result.state;if(state.includes("HALT, BREAK")){}stack=result.stack;if(stack[0].type=="Array"){length=stack[0].lenght;}else if(stack[0].type=="ByteArray"){bs=stack[0].value.hexToBytes();name=ThinNeo.Helper.Bytes2String(bs);}return _context157.abrupt('return',name);case 18:_context157.prev=18;_context157.t0=_context157['catch'](10);return _context157.abrupt('return',_context157.t0.message);case 21:case'end':return _context157.stop();}}},_callee157,this,[[10,18]]);}));}},{key:'getRootNameHash',value:function getRootNameHash(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee158(){var nameHash,sb,scriptaddress,data,result,state,stack;return regeneratorRuntime.wrap(function _callee158$(_context158){while(1){switch(_context158.prev=_context158.next){case 0:nameHash=void 0;sb=new ThinNeo.ScriptBuilder();sb.EmitParamJson(JSON.parse("[]"));sb.EmitPushString("rootNameHash");scriptaddress=tools.Consts.baseContract.hexToBytes().reverse();sb.EmitAppCall(scriptaddress);data=sb.ToArray();_context158.next=9;return tools.WWW.rpc_getInvokescript(data);case 9:result=_context158.sent;_context158.prev=10;state=result["state"];if(state.includes("HALT, BREAK")){}stack=result["stack"];if(stack[0].type=="ByteArray"){nameHash=stack[0]["value"].hexToBytes();}return _context158.abrupt('return',nameHash);case 18:_context158.prev=18;_context158.t0=_context158['catch'](10);return _context158.abrupt('return',_context158.t0.message);case 21:case'end':return _context158.stop();}}},_callee158,this,[[10,18]]);}));}},{key:'getOwnerInfo',value:function getOwnerInfo(domain,scriptaddress){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee159(){var info,sb,data,result,state,stackarr,stack,bt,parentOwner,domainstr,parentHash,_bt,root,a;return regeneratorRuntime.wrap(function _callee159$(_context159){while(1){switch(_context159.prev=_context159.next){case 0:info=new tools.DomainInfo();sb=new ThinNeo.ScriptBuilder();sb.EmitParamJson(["(bytes)"+domain.toHexString()]);sb.EmitPushString("getOwnerInfo");sb.EmitAppCall(scriptaddress);data=sb.ToArray();_context159.next=8;return tools.WWW.rpc_getInvokescript(data);case 8:result=_context159.sent;try{state=result.state;if(state.includes("HALT, BREAK")){}stackarr=result["stack"];if(stackarr[0].type=="Array"){stack=stackarr[0].value;if(stack[0].type=="ByteArray"){info.owner=stack[0].value.hexToBytes();}if(stack[1].type=="ByteArray"){info.register=stack[1].value.hexToBytes();}if(stack[2].type=="ByteArray"){info.resolver=stack[2].value.hexToBytes();}if(stack[3].type=="Integer"){info.ttl=new Neo.BigInteger(stack[3].value).toString();}if(stack[3].type="ByteArray"){bt=stack[3].value.hexToBytes();info.ttl=Neo.BigInteger.fromUint8ArrayAutoSign(bt.clone()).toString();}if(stack[4].type="ByteArray"){parentOwner=stack[5].value.hexToBytes();}if(stack[5].type="String"){domainstr=stack[5].value;}if(stack[6].type="ByteArray"){parentHash=stack[6].value.hexToBytes();}if(stack[7].type="ByteArray"){_bt=stack[7].value.hexToBytes();root=Neo.BigInteger.fromUint8ArrayAutoSign(_bt);}if(stack[7].type="Integer"){a=new Neo.BigInteger(stack[7].value);}}}catch(e){}return _context159.abrupt('return',info);case 11:case'end':return _context159.stop();}}},_callee159,this);}));}},{key:'getNameHash',value:function getNameHash(domain){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee160(){var namehash,domainarr,subdomain,root,nnshash;return regeneratorRuntime.wrap(function _callee160$(_context160){while(1){switch(_context160.prev=_context160.next){case 0:namehash=void 0;domainarr=domain.split('.');subdomain=domainarr[0];_context160.next=5;return NNSTool.getRootName();case 5:root=_context160.sent;domainarr.shift();domainarr.push(root);nnshash=NNSTool.nameHashArray(domainarr);return _context160.abrupt('return',nnshash);case 10:case'end':return _context160.stop();}}},_callee160,this);}));}},{key:'setResolve',value:function setResolve(nnshash,resolverhash){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee161(){var current,hash,hashstr,nnshashstr,resolvestr,scriptaddress,sb,random_uint8,random_int,data,res;return regeneratorRuntime.wrap(function _callee161$(_context161){while(1){switch(_context161.prev=_context161.next){case 0:current=tools.LoginInfo.getCurrentLogin();hash=ThinNeo.Helper.GetPublicKeyScriptHashFromPublicKey(current.pubkey);hashstr=hash.reverse().toHexString();nnshashstr=nnshash.reverse().toHexString();resolvestr=resolverhash.reverse().toHexString();scriptaddress=tools.Consts.baseContract.hexToBytes().reverse();sb=new ThinNeo.ScriptBuilder();random_uint8=Neo.Cryptography.RandomNumberGenerator.getRandomValues(new Uint8Array(32));random_int=Neo.BigInteger.fromUint8Array(random_uint8);sb.EmitPushNumber(random_int);sb.Emit(ThinNeo.OpCode.DROP);sb.EmitParamJson(["(hex160)0x"+hashstr,"(hex256)0x"+nnshashstr,"(hex160)0x"+resolvestr]);sb.EmitPushString("owner_SetResolver");sb.EmitAppCall(scriptaddress);data=sb.ToArray();console.log(data.toHexString());_context161.next=18;return tools.CoinTool.contractInvokeTrans_attributes(data);case 18:res=_context161.sent;return _context161.abrupt('return',res);case 20:case'end':return _context161.stop();}}},_callee161,this);}));}},{key:'setResolveData',value:function setResolveData(nnshash,str,resolve){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee162(){var namehash,current,hash,hashstr,nnshashstr,scriptaddress,sb,random_uint8,random_int,data,res;return regeneratorRuntime.wrap(function _callee162$(_context162){while(1){switch(_context162.prev=_context162.next){case 0:namehash=void 0;current=tools.LoginInfo.getCurrentLogin();hash=ThinNeo.Helper.GetPublicKeyScriptHashFromPublicKey(current.pubkey);hashstr=hash.reverse().toHexString();nnshashstr=nnshash.reverse().toHexString();scriptaddress=resolve.hexToBytes();sb=new ThinNeo.ScriptBuilder();random_uint8=Neo.Cryptography.RandomNumberGenerator.getRandomValues(new Uint8Array(32));random_int=Neo.BigInteger.fromUint8Array(random_uint8);sb.EmitPushNumber(random_int);sb.Emit(ThinNeo.OpCode.DROP);sb.EmitParamJson(["(hex160)0x"+hashstr,"(hex256)0x"+nnshashstr,"(str)1","(str)addr","(str)"+str]);sb.EmitPushString("setResolveData");sb.EmitAppCall(scriptaddress);data=sb.ToArray();_context162.next=17;return tools.CoinTool.contractInvokeTrans_attributes(data);case 17:res=_context162.sent;return _context162.abrupt('return');case 19:case'end':return _context162.stop();}}},_callee162,this);}));}},{key:'resolveData',value:function resolveData(domain){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee163(){var scriptaddress,arr,nnshash,nnshashstr,sb,data,res,addr,state,stack,value;return regeneratorRuntime.wrap(function _callee163$(_context163){while(1){switch(_context163.prev=_context163.next){case 0:scriptaddress=tools.Consts.baseContract.hexToBytes().reverse();arr=domain.split(".");nnshash=NNSTool.nameHashArray(arr);nnshashstr=nnshash.reverse().toHexString();sb=new ThinNeo.ScriptBuilder();sb.EmitParamJson(["(str)addr","(hex256)0x"+nnshashstr,"(str)1"]);sb.EmitPushString("resolve");sb.EmitAppCall(scriptaddress);data=sb.ToArray();_context163.next=11;return tools.WWW.rpc_getInvokescript(data);case 11:res=_context163.sent;addr="";try{state=res.state;if(state.includes("HALT, BREAK")){stack=res.stack;if(stack[0].type=="ByteArray"){if(stack[0].value!="00"){value=stack[0].value.hexToBytes();addr=ThinNeo.Helper.Bytes2String(value);}}}}catch(e){console.log(e);}return _context163.abrupt('return',addr);case 15:case'end':return _context163.stop();}}},_callee163,this);}));}},{key:'resolveFull',value:function resolveFull(protocol,nameArray){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee164(){return regeneratorRuntime.wrap(function _callee164$(_context164){while(1){switch(_context164.prev=_context164.next){case 0:case'end':return _context164.stop();}}},_callee164,this);}));}},{key:'getSubOwner',value:function getSubOwner(nnshash,subdomain,scriptaddress){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee165(){var owner,sb,data,result,state,stack;return regeneratorRuntime.wrap(function _callee165$(_context165){while(1){switch(_context165.prev=_context165.next){case 0:owner="";sb=new ThinNeo.ScriptBuilder();sb.EmitParamJson(["(bytes)"+nnshash.toHexString(),"(str)"+subdomain]);sb.EmitPushString("getSubOwner");sb.EmitAppCall(scriptaddress);data=sb.ToArray();_context165.next=8;return tools.WWW.rpc_getInvokescript(data);case 8:result=_context165.sent;try{state=result.state;if(state.includes("HALT, BREAK")){stack=result.stack;if(stack[0].type=="ByteArray"){if(stack[0].value!="00"){owner=ThinNeo.Helper.GetAddressFromScriptHash(stack[0].value.hexToBytes());}}}}catch(e){console.log(e);}return _context165.abrupt('return',owner);case 11:case'end':return _context165.stop();}}},_callee165,this);}));}},{key:'nameHash',value:function nameHash(domain){var domain_bytes=ThinNeo.Helper.String2Bytes(domain);var hashd=Neo.Cryptography.Sha256.computeHash(domain_bytes);var namehash=new Uint8Array(hashd);return namehash.clone();}},{key:'nameHashSub',value:function nameHashSub(roothash,subdomain){var bs=ThinNeo.Helper.String2Bytes(subdomain);if(bs.length==0)return roothash;var domain=Neo.Cryptography.Sha256.computeHash(bs);var domain_bytes=new Uint8Array(domain);var domainUint8arry=domain_bytes.concat(roothash);var sub=Neo.Cryptography.Sha256.computeHash(domainUint8arry);var sub_bytes=new Uint8Array(sub);return sub_bytes.clone();}},{key:'nameHashArray',value:function nameHashArray(domainarray){domainarray.reverse();var hash=NNSTool.nameHash(domainarray[0]);for(var i=1;i<domainarray.length;i++){hash=NNSTool.nameHashSub(hash,domainarray[i]);}return hash;}},{key:'verifyDomain',value:function verifyDomain(domain){var reg=/^(.+\.)(test|TEST|[a-z][a-z])$/;if(!reg.test(domain)){return false;}else{return true;}}},{key:'verifyAddr',value:function verifyAddr(addr){var reg=/^[a-zA-Z0-9]{34,34}$/;if(!reg.test(addr)){return false;}else{return true;}}},{key:'setDomainStatus',value:function setDomainStatus(){}},{key:'initStatus',value:function initStatus(){NNSTool.domainStatus=tools.DomainStatus.getStatus();}}]);return NNSTool;}();tools.NNSTool=NNSTool;})(tools=BlackCat.tools||(BlackCat.tools={}));})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var UserInfo=function UserInfo(){_classCallCheck(this,UserInfo);this.uid='';this.name='';this.phone='';this.token='';this.wallet='';this.area='';this.region="";this.email='';this.qq='';this.icon='';this.sex="";};BlackCat.UserInfo=UserInfo;var TransInfo=function TransInfo(){_classCallCheck(this,TransInfo);this.assetid="";this.targetaddr="";this.amount="";};BlackCat.TransInfo=TransInfo;var RawTransInfo=function RawTransInfo(){_classCallCheck(this,RawTransInfo);};BlackCat.RawTransInfo=RawTransInfo;var RefundTransInfo=function RefundTransInfo(){_classCallCheck(this,RefundTransInfo);};BlackCat.RefundTransInfo=RefundTransInfo;var MintTokenTransInfo=function MintTokenTransInfo(){_classCallCheck(this,MintTokenTransInfo);};BlackCat.MintTokenTransInfo=MintTokenTransInfo;var getMintTokenTransInfo=function getMintTokenTransInfo(){_classCallCheck(this,getMintTokenTransInfo);};BlackCat.getMintTokenTransInfo=getMintTokenTransInfo;var invokescriptInfo=function invokescriptInfo(){_classCallCheck(this,invokescriptInfo);};BlackCat.invokescriptInfo=invokescriptInfo;var walletLists=function walletLists(){_classCallCheck(this,walletLists);this.id="";this.ctm="";this.g_id="";this.type="";this.type_detail="";this.state="";this.state_gameplay="";this.state_gameplay_detail="";this.txid="";this.wallet="";this.cnts="0";this.vdata="";this.params="";this.nnc="";this.icon="";this.name="";this.ext="";this.client_notify="";};BlackCat.walletLists=walletLists;var contact=function contact(){_classCallCheck(this,contact);this.id="";this.ctm="";this.uid="";this.address_name="";this.address_wallet="";this.address_desc="";};BlackCat.contact=contact;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var SDK=function(){function SDK(){_classCallCheck(this,SDK);}_createClass(SDK,null,[{key:'init',value:function init(appid,appkey,listener){var lang=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"cn";console.log("[BlaCat]",'[SDK]','init ...');if(SDK.is_init===false){SDK.main=new BlackCat.Main();SDK.main.init(appid,appkey,listener,lang);}SDK.is_init=true;}},{key:'setLang',value:function setLang(type){console.log("[BlaCat]",'[SDK]','setLang ...');if(SDK.is_init===false){console.log("[BlaCat]",'[SDK]','请先初始化init');return;}this.main.setLang(type);}},{key:'showMain',value:function showMain(){if(SDK.is_init===false){console.log("[BlaCat]",'[SDK]','请先初始化init');return;}this.main.showMain();}},{key:'showIcon',value:function showIcon(){if(SDK.is_init===false){console.log("[BlaCat]",'[SDK]','请先初始化init');return;}this.main.showIcon();}},{key:'login',value:function login(){var callback=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(SDK.is_init===false){console.log("[BlaCat]",'[SDK]','请先初始化init');return;}SDK.main.start(callback);}},{key:'invokescript',value:function invokescript(params){var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee166(){var res;return regeneratorRuntime.wrap(function _callee166$(_context166){while(1){switch(_context166.prev=_context166.next){case 0:if(!(SDK.is_init===false)){_context166.next=3;break;}console.log("[BlaCat]",'[SDK]','请先初始化init');return _context166.abrupt('return');case 3:if(SDK.main.isLogined()){_context166.next=7;break;}console.log("[BlaCat]",'[SDK]','请先登录');this.showMain();return _context166.abrupt('return');case 7:_context166.next=9;return SDK.main.invokescript(params);case 9:res=_context166.sent;if(callback)callback(res);case 11:case'end':return _context166.stop();}}},_callee166,this);}));}},{key:'makeRawTransaction',value:function makeRawTransaction(params){var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee167(){return regeneratorRuntime.wrap(function _callee167$(_context167){while(1){switch(_context167.prev=_context167.next){case 0:if(!(SDK.is_init===false)){_context167.next=3;break;}console.log("[BlaCat]",'[SDK]','请先初始化init');return _context167.abrupt('return');case 3:if(SDK.main.isLogined()){_context167.next=7;break;}console.log("[BlaCat]",'[SDK]','请先登录');this.showMain();return _context167.abrupt('return');case 7:SDK.main.makeRawTransaction(params,callback);case 8:case'end':return _context167.stop();}}},_callee167,this);}));}},{key:'makeRecharge',value:function makeRecharge(params){var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee168(){var res;return regeneratorRuntime.wrap(function _callee168$(_context168){while(1){switch(_context168.prev=_context168.next){case 0:if(!(SDK.is_init===false)){_context168.next=3;break;}console.log("[BlaCat]",'[SDK]','请先初始化init');return _context168.abrupt('return');case 3:if(SDK.main.isLogined()){_context168.next=7;break;}console.log("[BlaCat]",'[SDK]','请先登录');this.showMain();return _context168.abrupt('return');case 7:_context168.next=9;return SDK.main.makeRecharge(params,callback);case 9:res=_context168.sent;case 10:case'end':return _context168.stop();}}},_callee168,this);}));}},{key:'confirmAppNotify',value:function confirmAppNotify(params){var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee169(){var res;return regeneratorRuntime.wrap(function _callee169$(_context169){while(1){switch(_context169.prev=_context169.next){case 0:if(!(SDK.is_init===false)){_context169.next=3;break;}console.log("[BlaCat]",'[SDK]','请先初始化init');return _context169.abrupt('return');case 3:if(SDK.main.isLogined()){_context169.next=6;break;}console.log("[BlaCat]",'[SDK]','请先登录');return _context169.abrupt('return');case 6:_context169.next=8;return SDK.main.confirmAppNotify(params);case 8:res=_context169.sent;if(callback)callback(res);case 10:case'end':return _context169.stop();}}},_callee169,this);}));}},{key:'getBalance',value:function getBalance(){var callback=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee170(){var res;return regeneratorRuntime.wrap(function _callee170$(_context170){while(1){switch(_context170.prev=_context170.next){case 0:if(!(SDK.is_init===false)){_context170.next=3;break;}console.log("[BlaCat]",'[SDK]','请先初始化init');return _context170.abrupt('return');case 3:if(SDK.main.isLogined()){_context170.next=6;break;}console.log("[BlaCat]",'[SDK]','请先登录');return _context170.abrupt('return');case 6:_context170.next=8;return SDK.main.getBalance();case 8:res=_context170.sent;if(callback)callback(res);case 10:case'end':return _context170.stop();}}},_callee170,this);}));}},{key:'getUserInfo',value:function getUserInfo(){var callback=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee171(){var res;return regeneratorRuntime.wrap(function _callee171$(_context171){while(1){switch(_context171.prev=_context171.next){case 0:if(SDK.is_init===false){console.log("[BlaCat]",'[SDK]','请先初始化init');}if(!SDK.main.isLogined()){console.log("[BlaCat]",'[SDK]','请先登录');}_context171.next=4;return SDK.main.getUserInfo();case 4:res=_context171.sent;if(callback)callback(res);case 6:case'end':return _context171.stop();}}},_callee171,this);}));}},{key:'makeGasTransfer',value:function makeGasTransfer(params){var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee172(){var res;return regeneratorRuntime.wrap(function _callee172$(_context172){while(1){switch(_context172.prev=_context172.next){case 0:if(!(SDK.is_init===false)){_context172.next=3;break;}console.log("[BlaCat]",'[SDK]','请先初始化init');return _context172.abrupt('return');case 3:if(SDK.main.isLogined()){_context172.next=7;break;}console.log("[BlaCat]",'[SDK]','请先登录');this.showMain();return _context172.abrupt('return');case 7:_context172.next=9;return SDK.main.makeGasTransfer(params,callback);case 9:res=_context172.sent;case 10:case'end':return _context172.stop();}}},_callee172,this);}));}},{key:'makeGasTransferMulti',value:function makeGasTransferMulti(params){var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee173(){var res;return regeneratorRuntime.wrap(function _callee173$(_context173){while(1){switch(_context173.prev=_context173.next){case 0:if(!(SDK.is_init===false)){_context173.next=3;break;}console.log("[BlaCat]",'[SDK]','请先初始化init');return _context173.abrupt('return');case 3:if(SDK.main.isLogined()){_context173.next=7;break;}console.log("[BlaCat]",'[SDK]','请先登录');this.showMain();return _context173.abrupt('return');case 7:_context173.next=9;return SDK.main.makeGasTransferMulti(params,callback);case 9:res=_context173.sent;case 10:case'end':return _context173.stop();}}},_callee173,this);}));}},{key:'getNetType',value:function getNetType(){var callback=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee174(){var res;return regeneratorRuntime.wrap(function _callee174$(_context174){while(1){switch(_context174.prev=_context174.next){case 0:if(!(SDK.is_init===false)){_context174.next=3;break;}console.log("[BlaCat]",'[SDK]','请先初始化init');return _context174.abrupt('return');case 3:_context174.next=5;return SDK.main.getNetType();case 5:res=_context174.sent;if(callback)callback(res);case 7:case'end':return _context174.stop();}}},_callee174,this);}));}},{key:'setDefaultNetType',value:function setDefaultNetType(type){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee175(){return regeneratorRuntime.wrap(function _callee175$(_context175){while(1){switch(_context175.prev=_context175.next){case 0:if(!(SDK.is_init===false)){_context175.next=3;break;}console.log("[BlaCat]",'[SDK]','请先初始化init');return _context175.abrupt('return');case 3:SDK.main.setDefaultNetType(type);case 4:case'end':return _context175.stop();}}},_callee175,this);}));}}]);return SDK;}();SDK.is_init=false;BlackCat.SDK=SDK;var Result=function Result(){_classCallCheck(this,Result);};BlackCat.Result=Result;})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var tools;(function(tools){var StorageTool=function(){function StorageTool(){_classCallCheck(this,StorageTool);}_createClass(StorageTool,null,[{key:'getLoginArr',value:function getLoginArr(){var message=sessionStorage.getItem("login-info-arr");var arr=message?tools.LoginInfo.StringToArray(message):[];return arr;}},{key:'setLoginArr',value:function setLoginArr(value){sessionStorage.setItem('login-info-arr',tools.LoginInfo.ArrayToString(value));}},{key:'setStorage',value:function setStorage(key,value){sessionStorage.setItem(key,value);}},{key:'getStorage',value:function getStorage(key){return sessionStorage.getItem(key);}},{key:'delStorage',value:function delStorage(key){sessionStorage.removeItem(key);}},{key:'heightRefresh',value:function heightRefresh(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee176(){var oldheight,height;return regeneratorRuntime.wrap(function _callee176$(_context176){while(1){switch(_context176.prev=_context176.next){case 0:oldheight=StorageTool.getStorage("block-height");_context176.next=3;return tools.WWW.api_getHeight_nodes();case 3:height=_context176.sent;if(oldheight==undefined||oldheight==null||oldheight==""){StorageTool.setStorage("block-height",height.toString());}if(height-parseInt(oldheight)>=2){StorageTool.utxosRefresh();StorageTool.setStorage('block-height',height.toString());}case 6:case'end':return _context176.stop();}}},_callee176,this);}));}},{key:'utxosRefresh',value:function utxosRefresh(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee177(){var assets;return regeneratorRuntime.wrap(function _callee177$(_context177){while(1){switch(_context177.prev=_context177.next){case 0:_context177.next=2;return tools.CoinTool.getassets();case 2:assets=_context177.sent;tools.UTXO.setAssets(assets);case 4:case'end':return _context177.stop();}}},_callee177,this);}));}}]);return StorageTool;}();tools.StorageTool=StorageTool;var StaticStore=function(){function StaticStore(){_classCallCheck(this,StaticStore);}_createClass(StaticStore,null,[{key:'setAsset',value:function setAsset(asset){StaticStore.choiceAsset=asset;}}]);return StaticStore;}();StaticStore.choiceAsset="";tools.StaticStore=StaticStore;})(tools=BlackCat.tools||(BlackCat.tools={}));})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var tools;(function(tools){var DateTool=function(){function DateTool(){_classCallCheck(this,DateTool);}_createClass(DateTool,null,[{key:'dateFtt',value:function dateFtt(fmt,date){var o={"M+":date.getMonth()+1,"d+":date.getDate(),"h+":date.getHours(),"m+":date.getMinutes(),"s+":date.getSeconds(),"q+":Math.floor((date.getMonth()+3)/3),"S":date.getMilliseconds()};if(/(y+)/.test(fmt))fmt=fmt.replace(RegExp.$1,(date.getFullYear()+"").substr(4-RegExp.$1.length));for(var k in o){if(new RegExp("("+k+")").test(fmt))fmt=fmt.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length));}return fmt;}}]);return DateTool;}();tools.DateTool=DateTool;})(tools=BlackCat.tools||(BlackCat.tools={}));})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var tools;(function(tools){var wallet=function(){function wallet(){_classCallCheck(this,wallet);this.wallet=new ThinNeo.nep6wallet();this.otcgo=new tools.WalletOtcgo();this.filestr="";this.isotc=false;this.wallet_addr=tools.LoginInfo.getCurrentAddress();}_createClass(wallet,[{key:'setWalletStr',value:function setWalletStr(filestr){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee178(){return regeneratorRuntime.wrap(function _callee178$(_context178){while(1){switch(_context178.prev=_context178.next){case 0:this.filestr=filestr;_context178.next=3;return this.readWalletFile(0);case 3:return _context178.abrupt('return',_context178.sent);case 4:case'end':return _context178.stop();}}},_callee178,this);}));}},{key:'readWalletFile',value:function readWalletFile(){var type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee179(){return regeneratorRuntime.wrap(function _callee179$(_context179){while(1){switch(_context179.prev=_context179.next){case 0:if(!(type==1)){_context179.next=4;break;}_context179.next=3;return BlackCat.Main.user.getWalletFileCache();case 3:this.filestr=_context179.sent;case 4:if(!this.filestr){_context179.next=22;break;}_context179.prev=5;this.isotc=!this.filestr.includes("accounts");if(!this.isotc){_context179.next=13;break;}this.wallet.accounts=undefined;this.otcgo.fromJsonStr(this.filestr);return _context179.abrupt('return',true);case 13:this.otcgo.address=undefined;this.wallet.fromJsonStr(this.filestr);return _context179.abrupt('return',true);case 16:_context179.next=22;break;case 18:_context179.prev=18;_context179.t0=_context179['catch'](5);console.log("[BlaCat]",'[wallet]','readWalletFile, 钱包文件解析异常',this.filestr);return _context179.abrupt('return',false);case 22:return _context179.abrupt('return',false);case 23:case'end':return _context179.stop();}}},_callee179,this,[[5,18]]);}));}},{key:'open',value:function open(filepass){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee180(){var _loginarray,result,loginarray;return regeneratorRuntime.wrap(function _callee180$(_context180){while(1){switch(_context180.prev=_context180.next){case 0:if(!this.wallet.accounts){_context180.next=17;break;}_context180.prev=1;_context180.next=4;return tools.neotools.nep6Load(this.wallet,filepass);case 4:_loginarray=_context180.sent;_context180.next=7;return tools.StorageTool.setLoginArr(_loginarray);case 7:_context180.next=9;return tools.LoginInfo.setCurrentAddress(_loginarray[0].address);case 9:this.wallet_addr=_loginarray[0].address;return _context180.abrupt('return',true);case 13:_context180.prev=13;_context180.t0=_context180['catch'](1);BlackCat.Main.showErrMsg("wallet_open_check");return _context180.abrupt('return',false);case 17:if(!this.otcgo.address){_context180.next=42;break;}console.log("[BlaCat]",'[wallet]','打开蓝鲸淘钱包文件');_context180.prev=19;this.otcgo.otcgoDecrypt(filepass);result=this.otcgo.doValidatePwd();if(!result){_context180.next=34;break;}loginarray=new Array();loginarray.push(new tools.LoginInfo());loginarray[0].address=this.otcgo.address;loginarray[0].prikey=this.otcgo.prikey;loginarray[0].pubkey=this.otcgo.pubkey;tools.StorageTool.setLoginArr(loginarray);tools.LoginInfo.setCurrentAddress(loginarray[0].address);this.wallet_addr=this.otcgo.address;return _context180.abrupt('return',true);case 34:BlackCat.Main.showErrMsg("wallet_open_check_otcgo_pwd");return _context180.abrupt('return',false);case 36:_context180.next=42;break;case 38:_context180.prev=38;_context180.t1=_context180['catch'](19);BlackCat.Main.showErrMsg("wallet_open_check_otcgo");return _context180.abrupt('return',false);case 42:console.log("[BlaCat]",'[wallet]','无有效的钱包文件');return _context180.abrupt('return',false);case 44:case'end':return _context180.stop();}}},_callee180,this,[[1,13],[19,38]]);}));}},{key:'isOpen',value:function isOpen(){var logined_addr=tools.LoginInfo.getCurrentAddress();this.wallet_addr=logined_addr;if(!logined_addr){return false;}return true;}},{key:'invokescript',value:function invokescript(params){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee181(){var res,sb,scriptaddress,data,r;return regeneratorRuntime.wrap(function _callee181$(_context181){while(1){switch(_context181.prev=_context181.next){case 0:res=new tools.Result();sb=new ThinNeo.ScriptBuilder();scriptaddress=params.nnc.hexToBytes().reverse();sb.EmitParamJson(params.sbParamJson);if(params.hasOwnProperty('sbPushString'))sb.EmitPushString(params.sbPushString);sb.EmitAppCall(scriptaddress);data=sb.ToArray();_context181.next=9;return tools.WWW.cli_getInvokescript(data);case 9:r=_context181.sent;if(r){res.err=false;res.info=r;}else{res.err=true;res.info={error:"rpc getInvokescript error"};}return _context181.abrupt('return',res);case 12:case'end':return _context181.stop();}}},_callee181,this);}));}},{key:'makeRawTransaction',value:function makeRawTransaction(params){var trust=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"0";var net_fee=arguments[2];return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee182(){var res,login,addr,tran,user_utxos_assets,user_makeTranRes,user_tran,oldarr,sb,random_int,array,random_uint8,math_rand,scriptaddress,scriptaddress_next,script,msg,pubkey,prekey,signdata,txid,data,r,logRes,height;return regeneratorRuntime.wrap(function _callee182$(_context182){while(1){switch(_context182.prev=_context182.next){case 0:res=new tools.Result();login=tools.LoginInfo.getCurrentLogin();addr=login.address;tran=new ThinNeo.Transaction();tran.inputs=[];tran.outputs=[];tran.type=ThinNeo.TransactionType.InvocationTransaction;tran.extdata=new ThinNeo.InvokeTransData();if(!(Number(net_fee)>0)){_context182.next=28;break;}tran.extdata.gas=Neo.Fixed8.fromNumber(Number(net_fee));_context182.prev=10;_context182.next=13;return tools.CoinTool.getassets();case 13:user_utxos_assets=_context182.sent;console.log("[BlaCat]",'[wallet]','makeRawTransaction, user_utxos_assets => ',user_utxos_assets);user_makeTranRes=tools.CoinTool.makeTran(user_utxos_assets,addr,tools.CoinTool.id_GAS,Neo.Fixed8.Zero,Neo.Fixed8.fromNumber(Number(net_fee)));user_tran=user_makeTranRes.info.tran;oldarr=user_makeTranRes.info.oldarr;tran.inputs=user_tran.inputs;tran.outputs=user_tran.outputs;console.log("[BlaCat]",'[wallet]','makeRawTransaction, user_makeTranRes => ',user_makeTranRes);_context182.next=28;break;case 23:_context182.prev=23;_context182.t0=_context182['catch'](10);res.err=true;res.info={error:"get_net_fee error"};return _context182.abrupt('return',res);case 28:sb=new ThinNeo.ScriptBuilder();try{array=new Uint8Array(2333);random_uint8=Neo.Cryptography.RandomNumberGenerator.getRandomValues(array);random_int=Neo.BigInteger.fromUint8Array(random_uint8);}catch(e){math_rand=parseInt((Math.random()*10000000).toString());console.log("[BlaCat]",'[wallet]','makerawtransaction, math_rand => ',math_rand);random_int=new Neo.BigInteger(math_rand);}sb.EmitPushNumber(random_int);sb.Emit(ThinNeo.OpCode.DROP);if(!(params instanceof Array)){_context182.next=53;break;}if(!(params.length>2)){_context182.next=39;break;}res.err=true;res.info={error:"post raw transaction error, too many data params, only 2 "};return _context182.abrupt('return',res);case 39:scriptaddress=params[0].nnc.hexToBytes().reverse();sb.EmitParamJson(params[0].sbParamJson);sb.EmitPushString(params[0].sbPushString);sb.EmitAppCall(scriptaddress);sb.EmitSysCall("System.ExecutionEngine.GetScriptContainer");sb.EmitSysCall("Neo.Transaction.GetHash");sb.EmitPushBytes(ThinNeo.Helper.GetPublicKeyScriptHash_FromAddress(addr));sb.EmitPushNumber(new Neo.BigInteger(2));sb.Emit(ThinNeo.OpCode.PACK);scriptaddress_next=params[1].nnc.hexToBytes().reverse();sb.EmitPushString(params[1].sbPushString);sb.EmitAppCall(scriptaddress_next);case 51:_context182.next=57;break;case 53:scriptaddress=params.nnc.hexToBytes().reverse();sb.EmitParamJson(params.sbParamJson);sb.EmitPushString(params.sbPushString);sb.EmitAppCall(scriptaddress);case 57:script=sb.ToArray();tran.extdata.script=script;tran.attributes=new Array(1);tran.attributes[0]=new ThinNeo.Attribute();tran.attributes[0].usage=ThinNeo.TransactionAttributeUsage.Script;tran.attributes[0].data=ThinNeo.Helper.GetPublicKeyScriptHash_FromAddress(addr);if(tran.witnesses==null)tran.witnesses=[];msg=tran.GetMessage().clone();pubkey=login.pubkey.clone();prekey=login.prikey.clone();signdata=ThinNeo.Helper.Sign(msg,prekey);tran.AddWitness(signdata,pubkey,addr);txid=tran.GetHash().clone().reverse().toHexString();data=tran.GetRawData();_context182.next=73;return tools.WWW.cli_postRawTransaction(data);case 73:r=_context182.sent;if(!r){_context182.next=96;break;}if(!(r["txid"]||r["sendrawtransactionresult"])){_context182.next=92;break;}if(!r["txid"]||r["txid"]==""){r["txid"]=txid;}res.err=false;res.info={txid:r["txid"]};_context182.next=81;return BlackCat.ApiTool.addUserWalletLogs(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,r["txid"],BlackCat.Main.appid,"","5",JSON.stringify(params),BlackCat.Main.netMgr.type,trust,net_fee);case 81:logRes=_context182.sent;if(!(Number(net_fee)>0)){_context182.next=88;break;}_context182.next=85;return tools.WWW.api_getHeight_nodes();case 85:height=_context182.sent;oldarr.map(function(old){return old.height=height;});tools.OldUTXO.oldutxosPush(oldarr);case 88:BlackCat.Main.appWalletLogId=logRes.data;if(trust=="1"){BlackCat.Main.updateTrustNnc();}_context182.next=94;break;case 92:res.err=true;res.info={error:"post raw transaction error, no txid"};case 94:_context182.next=98;break;case 96:res.err=true;res.info={error:"post raw transaction error, maybe network err"};case 98:return _context182.abrupt('return',res);case 99:case'end':return _context182.stop();}}},_callee182,this,[[10,23]]);}));}},{key:'makeRecharge',value:function makeRecharge(params){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee183(){var res,t_addr,t_taaddr,t_asset,t_amount,tranRes,logRes;return regeneratorRuntime.wrap(function _callee183$(_context183){while(1){switch(_context183.prev=_context183.next){case 0:res=new tools.Result();_context183.prev=1;t_addr=tools.LoginInfo.getCurrentAddress();t_taaddr=BlackCat.Main.app_recharge_addr;t_asset=tools.CoinTool.id_SGAS;t_amount=params.count.toString();_context183.next=8;return tools.CoinTool.nep5Transaction(t_addr,t_taaddr,t_asset,t_amount);case 8:tranRes=_context183.sent;_context183.next=17;break;case 11:_context183.prev=11;_context183.t0=_context183['catch'](1);console.log("[BlaCat]","[wallet]","makeRecharge error => ",_context183.t0.toString());res.err=true;res.info={error:"post makeRecharge error"};return _context183.abrupt('return',res);case 17:if(tranRes["err"]){_context183.next=32;break;}if(!tranRes.info){_context183.next=27;break;}res.err=false;res.info={txid:tranRes.info};_context183.next=23;return BlackCat.ApiTool.addUserWalletLogs(BlackCat.Main.user.info.uid,BlackCat.Main.user.info.token,tranRes.info,BlackCat.Main.appid,params.count.toString(),"3",JSON.stringify(params),BlackCat.Main.netMgr.type);case 23:logRes=_context183.sent;BlackCat.Main.appWalletLogId=logRes.data;_context183.next=30;break;case 27:res.err=true;res.info={error:"post makeRecharge error, no txid"};return _context183.abrupt('return',res);case 30:_context183.next=34;break;case 32:res.err=true;res.info={error:"post makeRecharge error, may be network error"};case 34:console.log("[BlaCat]","[wallet]","makeRechargeRes => ",res);return _context183.abrupt('return',res);case 36:case'end':return _context183.stop();}}},_callee183,this,[[1,11]]);}));}},{key:'closeWallet',value:function closeWallet(){tools.StorageTool.delStorage("current-address");tools.StorageTool.delStorage("login-info-arr");console.log("[BlaCat]",'[wallet]','closeWallet ...');if(BlackCat.Main.viewMgr.payWalletDetailView&&BlackCat.Main.viewMgr.payWalletDetailView.isCreated&&BlackCat.Main.viewMgr.payWalletDetailView.isHidden()==false){BlackCat.Main.viewMgr.payWalletDetailView.return();}}}]);return wallet;}();tools.wallet=wallet;})(tools=BlackCat.tools||(BlackCat.tools={}));})(BlackCat||(BlackCat={}));var BlackCat;(function(BlackCat){var tools;(function(tools){var WWW=function(){function WWW(){_classCallCheck(this,WWW);}_createClass(WWW,null,[{key:'makeRpcUrl',value:function makeRpcUrl(url,method){var urlout=url+"?jsonrpc=2.0&id=1&method="+method+"&params=[";for(var _len5=arguments.length,_params=Array(_len5>2?_len5-2:0),_key5=2;_key5<_len5;_key5++){_params[_key5-2]=arguments[_key5];}for(var i=0;i<_params.length;i++){urlout+=JSON.stringify(_params[i]);if(i!=_params.length-1)urlout+=",";}urlout+="]";return urlout;}},{key:'makeRpcPostBody',value:function makeRpcPostBody(method){var body={};body["jsonrpc"]="2.0";body["id"]=1;body["method"]=method;var params=[];for(var _len6=arguments.length,_params=Array(_len6>1?_len6-1:0),_key6=1;_key6<_len6;_key6++){_params[_key6-1]=arguments[_key6];}for(var i=0;i<_params.length;i++){params.push(_params[i]);}body["params"]=params;return body;}},{key:'api_getHeight_nodes',value:function api_getHeight_nodes(){var nodes_url=arguments.length>0&&arguments[0]!==undefined?arguments[0]:WWW.api_nodes;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee184(){var str,result,json,r,height;return regeneratorRuntime.wrap(function _callee184$(_context184){while(1){switch(_context184.prev=_context184.next){case 0:str=WWW.makeRpcUrl(nodes_url,"getblockcount");_context184.next=3;return fetch(str,{"method":"get"});case 3:result=_context184.sent;_context184.next=6;return result.json();case 6:json=_context184.sent;r=json["result"];height=parseInt(r[0]["blockcount"])-1;return _context184.abrupt('return',height);case 10:case'end':return _context184.stop();}}},_callee184,this);}));}},{key:'api_getHeight_clis',value:function api_getHeight_clis(){var clis_url=arguments.length>0&&arguments[0]!==undefined?arguments[0]:WWW.api_clis;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee185(){var str,result,json,r,height;return regeneratorRuntime.wrap(function _callee185$(_context185){while(1){switch(_context185.prev=_context185.next){case 0:str=WWW.makeRpcUrl(clis_url,"getblockcount");str+="&uid="+BlackCat.Main.randNumber;_context185.next=4;return fetch(str,{"method":"get"});case 4:result=_context185.sent;_context185.next=7;return result.json();case 7:json=_context185.sent;r=json["result"];height=parseInt(r[0]["blockcount"])-1;return _context185.abrupt('return',height);case 11:case'end':return _context185.stop();}}},_callee185,this);}));}},{key:'api_getAllAssets',value:function api_getAllAssets(){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee186(){var str,result,json,r;return regeneratorRuntime.wrap(function _callee186$(_context186){while(1){switch(_context186.prev=_context186.next){case 0:str=WWW.makeRpcUrl(WWW.api_nodes,"getallasset");_context186.next=3;return fetch(str,{"method":"get"});case 3:result=_context186.sent;_context186.next=6;return result.json();case 6:json=_context186.sent;r=json["result"];return _context186.abrupt('return',r);case 9:case'end':return _context186.stop();}}},_callee186,this);}));}},{key:'api_getUTXO',value:function api_getUTXO(address){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee187(){var str,result,json,r;return regeneratorRuntime.wrap(function _callee187$(_context187){while(1){switch(_context187.prev=_context187.next){case 0:str=WWW.makeRpcUrl(WWW.api_nodes,"getutxo",address);_context187.next=3;return fetch(str,{"method":"get"});case 3:result=_context187.sent;_context187.next=6;return result.json();case 6:json=_context187.sent;r=json["result"];return _context187.abrupt('return',r);case 9:case'end':return _context187.stop();}}},_callee187,this);}));}},{key:'api_getUTXOsToPay',value:function api_getUTXOsToPay(address,asset,value){var fromMax=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee188(){var postdata,result,json,r;return regeneratorRuntime.wrap(function _callee188$(_context188){while(1){switch(_context188.prev=_context188.next){case 0:postdata=WWW.makeRpcPostBody("getutxostopay",address,asset,value,fromMax);_context188.next=3;return fetch(WWW.api_nodes,{"method":"post","body":JSON.stringify(postdata)});case 3:result=_context188.sent;_context188.next=6;return result.json();case 6:json=_context188.sent;r=json["result"];return _context188.abrupt('return',r);case 9:case'end':return _context188.stop();}}},_callee188,this);}));}},{key:'api_getBalance',value:function api_getBalance(address){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee189(){var str,value,json,r;return regeneratorRuntime.wrap(function _callee189$(_context189){while(1){switch(_context189.prev=_context189.next){case 0:str=WWW.makeRpcUrl(WWW.api_nodes,"getbalance",address);_context189.next=3;return fetch(str,{"method":"get"});case 3:value=_context189.sent;_context189.next=6;return value.json();case 6:json=_context189.sent;r=json["result"];return _context189.abrupt('return',r);case 9:case'end':return _context189.stop();}}},_callee189,this);}));}},{key:'getNep5Asset',value:function getNep5Asset(asset){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee190(){var postdata,result,json,r;return regeneratorRuntime.wrap(function _callee190$(_context190){while(1){switch(_context190.prev=_context190.next){case 0:postdata=WWW.makeRpcPostBody("getnep5asset",asset);_context190.next=3;return fetch(WWW.api_nodes,{"method":"post","body":JSON.stringify(postdata)});case 3:result=_context190.sent;_context190.next=6;return result.json();case 6:json=_context190.sent;r=json["result"][0];return _context190.abrupt('return',r);case 9:case'end':return _context190.stop();}}},_callee190,this);}));}},{key:'cli_postRawTransaction',value:function cli_postRawTransaction(data){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee191(){var cli,api_url,postdata,result,json,r;return regeneratorRuntime.wrap(function _callee191$(_context191){while(1){switch(_context191.prev=_context191.next){case 0:cli=0;if(WWW.api_clis&&WWW.api_clis!=""){cli=1;}api_url=WWW.api_nodes;if(cli==1){api_url=WWW.api_clis;}postdata=WWW.makeRpcPostBody("sendrawtransaction",data.toHexString());if(cli==1)postdata["uid"]=BlackCat.Main.randNumber;_context191.next=8;return fetch(api_url,{"method":"post","body":JSON.stringify(postdata)});case 8:result=_context191.sent;_context191.next=11;return result.json();case 11:json=_context191.sent;r=json["result"][0];return _context191.abrupt('return',r);case 14:case'end':return _context191.stop();}}},_callee191,this);}));}},{key:'api_postRawTransaction',value:function api_postRawTransaction(data){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee192(){var postdata,result,json,r;return regeneratorRuntime.wrap(function _callee192$(_context192){while(1){switch(_context192.prev=_context192.next){case 0:postdata=WWW.makeRpcPostBody("sendrawtransaction",data.toHexString());_context192.next=3;return fetch(WWW.api_nodes,{"method":"post","body":JSON.stringify(postdata)});case 3:result=_context192.sent;_context192.next=6;return result.json();case 6:json=_context192.sent;r=json["result"][0];return _context192.abrupt('return',r);case 9:case'end':return _context192.stop();}}},_callee192,this);}));}},{key:'cli_getInvokescript',value:function cli_getInvokescript(scripthash){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee193(){var cli,api_url,str,result,json,r;return regeneratorRuntime.wrap(function _callee193$(_context193){while(1){switch(_context193.prev=_context193.next){case 0:cli=0;if(WWW.api_clis&&WWW.api_clis!=""){cli=1;}api_url=WWW.api_nodes;if(cli==1){api_url=WWW.api_clis;}str=WWW.makeRpcUrl(api_url,"invokescript",scripthash.toHexString());if(cli==1){str+="&uid="+BlackCat.Main.randNumber;}_context193.next=8;return fetch(str,{"method":"get"});case 8:result=_context193.sent;_context193.next=11;return result.json();case 11:json=_context193.sent;if(!(json["result"]==null)){_context193.next=14;break;}return _context193.abrupt('return',null);case 14:r=json["result"][0];return _context193.abrupt('return',r);case 16:case'end':return _context193.stop();}}},_callee193,this);}));}},{key:'rpc_getInvokescript',value:function rpc_getInvokescript(scripthash){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee194(){var str,result,json,r;return regeneratorRuntime.wrap(function _callee194$(_context194){while(1){switch(_context194.prev=_context194.next){case 0:str=WWW.makeRpcUrl(WWW.api_nodes,"invokescript",scripthash.toHexString());_context194.next=3;return fetch(str,{"method":"get"});case 3:result=_context194.sent;_context194.next=6;return result.json();case 6:json=_context194.sent;if(!(json["result"]==null)){_context194.next=9;break;}return _context194.abrupt('return',null);case 9:r=json["result"][0];return _context194.abrupt('return',r);case 11:case'end':return _context194.stop();}}},_callee194,this);}));}},{key:'getrawtransaction',value:function getrawtransaction(txid){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee195(){var str,result,json,r;return regeneratorRuntime.wrap(function _callee195$(_context195){while(1){switch(_context195.prev=_context195.next){case 0:str=WWW.makeRpcUrl(WWW.api_nodes,"getrawtransaction",txid);_context195.next=3;return fetch(str,{"method":"get"});case 3:result=_context195.sent;_context195.next=6;return result.json();case 6:json=_context195.sent;if(json["result"]){_context195.next=9;break;}return _context195.abrupt('return',null);case 9:r=json["result"][0];return _context195.abrupt('return',r);case 11:case'end':return _context195.stop();}}},_callee195,this);}));}},{key:'api_getcontractstate',value:function api_getcontractstate(scriptaddr){return __awaiter(this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee196(){var str,value,json,r;return regeneratorRuntime.wrap(function _callee196$(_context196){while(1){switch(_context196.prev=_context196.next){case 0:str=WWW.makeRpcUrl(WWW.api_nodes,"getcontractstate",scriptaddr);_context196.next=3;return fetch(str,{"method":"get"});case 3:value=_context196.sent;_context196.next=6;return value.json();case 6:json=_context196.sent;r=json["result"][0];return _context196.abrupt('return',r);case 9:case'end':return _context196.stop();}}},_callee196,this);}));}}]);return WWW;}();tools.WWW=WWW;})(tools=BlackCat.tools||(BlackCat.tools={}));})(BlackCat||(BlackCat={}));//# sourceMappingURL=code.js.map
